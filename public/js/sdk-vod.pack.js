var MT=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=118)}([function(t,e,i){var n;void 0===(n=function(t){var e=i(58),n=i(59),r=i(60);return{getTime:function(){var t=new Date,e=function(t){t=new String(t);for(var e=0,i="";e<2-t.length;e++)i+="0";return i+t};return e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())},timestamp:function(t){var e=(new Date).getTime();return t||(e=Math.round(e/1e3)),e},second2HMS:function(t){t=parseInt(t);var e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%3600%60);function r(t){return val=t>0?t>=10?t:"0"+t:"00",val}return r(e)+":"+r(i)+":"+r(n)},detectProtocol:function(t){return t.replace(/http:\/\//gi,window.location.protocol+"//")},deepClone:function(t){var e=Array.isArray(t)?[]:{};if(t&&"object"==typeof t)for(key in t)t.hasOwnProperty(key)&&(t[key]&&"object"==typeof t[key]?e[key]=this.deepClone(t[key]):e[key]=t[key]);return e},setRoom:function(t){this.room=t},getRoom:function(){return this.room?this.room:null},_typeof:function(t){return Object.prototype.toString.call(t).replace(/object /,"").replace(/^\[|\]$/g,"").toLowerCase()},getStaticHost:function(t){return window.TF_getStaticHost?window.TF_getStaticHost(t):t},assignObject:function(t,e){var i={};for(var n in t)i[n]=t[n];for(var n in e)i[n]=e[n];return i},sortObjByKey:function(t,e){return t.sort((function(t,i){return t=t[e],i=i[e],"string"===("string"==typeof t||"string"==typeof i?"string":"number")?t.localeCompare(i):t-i}))},getSDKMode:function(){var t=window.location.href.match(/sdkmode=[0-9]/gi),e=0;if(t&&t.length>0){var i=t.length-1;e=parseInt(t[i].replace("sdkmode=",""),10)}return e},isInNative:function(){return!(!this.isMobileSDK()||2!==this.getSDKMode())},qtWebEngine:function(t){var e=this;if(!this.isCloudLiveBrowser())return!1;try{new n.QWebChannel(qt.webChannelTransport,(function(i){e.debug("QtWebEngine start success!");var n=i.objects.interactObj;t&&t(n)}))}catch(t){this.debug("qtweb on error => ",t)}},htmlLog:function(t){if(!t)return!1;var e=document.createElement("p");if(!document.querySelector("#talkfun_frontend_ht_logs")){var i=document.createElement("div");i.id="talkfun_frontend_ht_logs",i.style.height="auto",i.style.overflow="auto",i.style.position="fixed",i.style["-webkit-overflow-scrolling"]="touch",i.style.left="0",i.style.top="20%",i.style.bottom="0",i.style.zIndex="99999999",i.innerHTML="<p>start...</p>",document.querySelector("body").appendChild(i)}try{var n=JSON.stringify(Array.prototype.slice.call(t));n=n.replace(/^\[/,"").replace(/\]$/,""),e.innerHTML=n}catch(t){e.innerHTML="LOG_ERROR ==> "+t.message}e.style.backgroundColor="#000000",e.style.color="#58FF19",e.style.marginTop="5px",e.style.padding="2%",e.style.width="96%",e.style.wordBreak="break-all";window.document.body;document.getElementById("talkfun_frontend_ht_logs").insertBefore(e,document.querySelector("#talkfun_frontend_ht_logs p"))},isShowDebug:function(){return window.location.href.indexOf("debug=list")>-1},flashDebugPath:function(t){if(window.location.href.indexOf("swf=v1")>-1){return/static\/swf\/debug\//.test(t)?t.replace(/static\/swf\/debug\//,"static/swf/debug/small_v1/").replace(/level[\d]\//,""):t.replace(/static\/swf\//,"static/swf/debug/small_v1/").replace(/level[\d]\//,"")}return t},isShowHtmlLog:function(){return window.location.href.indexOf("htmllog=true")>-1},debugTimeStart:function(t){console&&console.time&&console.time(t)},debugTimeEnd:function(t){console&&console.timeEnd&&console.timeEnd(t)},disableConsole:function(t){},argumentToArray:function(t){return Array.prototype.slice.call(t)},warn:function(){if(console&&console.warn){var t=Array.prototype.slice.call(arguments);t.unshift("[TalkFun WARN message]"),console.warn.apply(console,t)}},error:function(){if(console&&console.error){var t=Array.prototype.slice.call(arguments);t.unshift("[TalkFun ERROR message]"),console.error.apply(console,t)}},debug:function(){var t=this.isShowDebug();if("undefined"!=typeof console&&t){var e=Array.prototype.slice.call(arguments);e.unshift("[TalkFun LOG message]"),console.log.apply(console,e),this.isShowHtmlLog()&&this.htmlLog(e)}},getFlash:function(t){if(-1==navigator.appName.indexOf("Microsoft"))return document[t];try{return document[t]}catch(e){return window[t]}},flashChecker:function(){var t=!1,e={},i=-1;if(document.all){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(t){}n&&(t=!0,e=n.GetVariable("$version"),i=parseInt(e.split(" ")[1].split(",")[0]))}else{if(navigator.plugins&&navigator.plugins.length>0)if(n=navigator.plugins["Shockwave Flash"]){t=!0;for(var r=n.description.split(" "),o=0;o<r.length;++o)isNaN(parseInt(r[o]))||(i=parseInt(r[o]))}}return{flash:t,version:i}},in_array:function(t,e,i){for(var n=0;n<e.length;n++)if(t==e[n])return!i||{key:n,item:e[n]};return!1},find:function(t,e){return!!this.in_array(t,e)&&this.in_array(t,e,!0)},without:function(t,e){for(var i=t.length,n=0;n<i;n++)t[n]===e&&t.splice(n,1);return t},getPlatformInfo:function(){var t=navigator.userAgent.toLowerCase(),e=null,i=-1,n=t.match(/iphone|ipad|ipod/gi)||!1,r=t.match(/android/gi)||!1;return n?(e="ios",i=t.match(/os\s([0-9_0-9]*)/)[1].replace("_",".")):r&&(e="android",i=t.match(/android\s([0-9\.]*)/)[1]),{partform:e,version:parseFloat(i)}},closeSet:function(t,e){if(t&&0===t.length)return null;e=Math.abs(e);var i=t,n=i.length;if(void 0!==i[0].st){for(var r=[],o=0;o<n;o++)r.push(i[o].st);i=r}for(o=0;o<n;o++){if(i[o]===e)return t[o];if(i[o]>e)return t[o-1];if(e>i[i.length-1])return t[i.length-1]}},isCompatible:function(){return window.location.href.indexOf("compatible=true")>-1},isIE:function(){var t=navigator.userAgent.toLowerCase(),e=!1;return(t.indexOf("msie")>-1||t.indexOf(".net")>-1)&&(e=!0),e},platform:function(){var t=navigator.userAgent.toLowerCase();return t.indexOf("macintosh")>-1?"MacOS":t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("ios-sdk")>-1?"IOS":t.indexOf("android")>-1||t.indexOf("android-sdk")>-1?"Android":t.indexOf("linux")>-1?"Linux":t.indexOf("windows")>-1?"Windows":"Unknow"},isQQMobile:function(){var t=navigator.userAgent.toLowerCase();return t.indexOf("qqbrowser")>-1||t.indexOf("qq")>-1},isUCMobile:function(){return navigator.userAgent.toLowerCase().indexOf("ucbrowser")>-1},isSafari:function(){return navigator.userAgent.toLowerCase().indexOf("safari")>-1},touchSupport:function(){return"ontouchstart"in window},isWechat:function(){return navigator.userAgent.indexOf("MicroMessenger")>-1},isMobile:function(){this.platform();return!0},isMobileSDK:function(){var t=navigator.userAgent.toLowerCase();return t.indexOf("ios-sdk")>-1||t.indexOf("android-sdk")>-1},isTalkFunBrowser:function(){return navigator.userAgent.toLowerCase().indexOf("talkfun-browser")>-1},isCloudLiveBrowser:function(){return this.userAgent("TALK_FUN_2.0")>-1},userAgent:function(t){var e=navigator.userAgent.toLowerCase();return t=t.toLowerCase(),e.indexOf(t)>-1},isIphone:function(){return navigator.userAgent.toLowerCase().indexOf("iphone")>-1},isIpad:function(){return navigator.userAgent.toLowerCase().indexOf("ipad")>-1},isAndroid:function(){return"android"===this.getPlatformInfo().partform},isIos:function(){return"ios"===this.getPlatformInfo().partform},insertPosition:function(t,e){var i=t,n=e;if(i.focus(),document.selection)i.focus(),sel=document.selection.createRange(),sel.text=n,sel.select();else if(i.selectionStart||"0"==i.selectionStart){var r=i.selectionStart,o=i.selectionEnd,s=i.scrollTop;i.value=i.value.substring(0,r)+n+i.value.substring(o,i.value.length),s>0&&(i.scrollTop=s),i.focus(),i.selectionStart=r+n.length,i.selectionEnd=r+n.length}else i.value+=n,i.focus()},ubb2img:function(t,e){var i=t,n=e;return n=n.replace(/\[.+?\]/g,(function(t){return void 0!==i[t]?'<img src="'+i[t]+'"/>':t}))},formatTime:function(t){var e=parseInt(t/60);return 0===e&&(e=1),e},urlHashMap:function(){var t=window.location.hash.substring(1),e=[];if(t){var i=t.split("&");for(var n in i){var r=i[n].split("=");e[r[0]]=r[1]?r[1]:""}}return e},callback:function(t,e){"function"==typeof t&&(void 0!==e?t(e):t())},bindEvent:function(t,e,i){var n=this,r=arguments.length;if(3===r)if(void 0!==window.addEventListener)for(var o=t||arguments[0],s=(e=e||arguments[1],i||arguments[2]),a=0;a<s.length;a++)for(var l in s[a]){var c=e[s[a][l][1]],u=s[a][l][0];"click"===l&&(l=n.isMobile()?"touchstart":"click"),o.on(l,u,c)}else n.debug("事件绑定参数出错.")},now:function(){return(new Date).getTime()/1e3},isWebpSupport:null,webpSupport:function(t){var e=this;if(null!==e.isWebpSupport)t(e.isWebpSupport);else{var i=new Image;i.onerror=function(){e.isWebpSupport=!1,t(e.isWebpSupport)},i.onload=function(){1==i.width?e.isWebpSupport=!0:e.isWebpSupport=!1,t(e.isWebpSupport)},i.src="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAAAUAgCdASoBAAEAL/3+/3+CAB/AAAFzrNsAAP5QAAAAAA=="}},ajax:function(t){return e(t)},detectiveWxJsBridge:function(t){return r(t)},guid:"",getGuid:function(){return this.guid||(window.localStorage?(this.guid=window.localStorage.getItem("tfsdk.guid"),this.guid||(this.guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),window.localStorage.setItem("tfsdk.guid",this.guid))):this.guid=navigator.userAgent.toLowerCase().substr(30,36).replace(/[^\w\-]/g,"-")),this.guid},timers:{},operationTimer:function(t,e,i){if(t[e]=!1,"number"!=typeof i)return!1;i>0?(this.timers[e]&&clearTimeout(this.timers[e]),this.timers[e]=setTimeout((function(){t[e]=!0}),1e3*i)):t[e]=!0}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n;void 0===(n=function(t){var e=i(0);return new function(){this.keys=new Array,this.data=new Object,this.put=function(t,i){window.location.href.indexOf("maplog")>-1&&e.debug("MAP--PUT ===> "+t),null==this.data[t]&&this.keys.push(t),this.data[t]=i},this.get=function(t,i){return e.debug("MAP--GET ===> "+t),window.location.href.indexOf("maplog")>-1&&console.warn(this.data[t]),i?this.data[t]:void 0===this.data[t]?(this.data[t]=function(){},this.data[t]):this.data[t]},this.remove=function(t){this.keys.remove(t),this.data[t]=null},this.each=function(t){if(alert(t),"function"==typeof t)for(var e=this.keys.length,i=0;i<e;i++){var n=this.keys[i];t(n,this.data[n],i)}},this.entrys=function(){for(var t=this.keys.length,e=new Array(t),i=0;i<t;i++)e[i]={key:this.keys[i],value:this.data[i]};return e},this.isEmpty=function(){return 0==this.keys.length},this.size=function(){return this.keys.length},this.toString=function(){for(var t="{",e=0;e<this.keys.length;e++,t+=","){var i=this.keys[e];t+=i+"="+this.data[i]}return t+="}"}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){"use strict";i.r(e),i.d(e,"UPDATE_TOKEN",(function(){return n})),i.d(e,"UPDATE_INIT_DATA",(function(){return r})),i.d(e,"UPDATE_LIVE_DATA",(function(){return o})),i.d(e,"UPDATE_LIVE_MODE",(function(){return s})),i.d(e,"UPDATE_LIVE_STATUS",(function(){return a})),i.d(e,"GET_CHAT_LIST",(function(){return l}));const n="UPDATE_TOKEN",r="UPDATE_INIT_DATA",o="UPDATE_LIVE_DATA",s="UPDATE_LIVE_MODE",a="UPDATE_LIVE_STATUS",l="GET_CHAT_LIST"},function(t,e,i){var n;void 0===(n=function(){var t={ROOM:{},player:{},camera:{},CODE:{},CMD:{}};t.CMD.MODE={WHITEBOARD:"WHITEBOARD",PPT:"PPT"},t.CMD.WHITEBOARD_WIDTH=800,t.CMD.WHITEBOARD_HEIGHT=600,t.CMD.PAGE="51",t.CMD.DRAW="25",t.CMD.LINE="18",t.CMD.DOTTEDLINE="21",t.CMD.CLEAR="1",t.CMD.DRAW_LIST="31",t.CMD.VIDEO_START="103",t.CMD.OPEN_CAMERA="101",t.CMD.LIVE_START="start",t.CMD.LIVE_STOP="stop",t.CMD.SCROLL_ON_DOWN="5",t.CMD.SCROLL_ON_UP="6",t.CODE.SUCCESS=0,t.CODE.MEMBER_FORBIDDEN=10034,t.CODE_SUCCESS=0,t.EC_SUCCESS=0,t.EC_GENERAL_ERROR=-1,t.PROTOCOL="https:"==document.location.protocol?"https://":"http://";var e=window.location.host.match(/open-[\d]+\.talk-fun\.com/);return t.APP_DOMAIN=e?e[0]:window.apiHost||"open.talk-fun.com",t.APP_HOST=t.PROTOCOL+t.APP_DOMAIN,t.STATIC_HOST=t.PROTOCOL+"static-1.talk-fun.com",t.MT_ADDMAPLIST_ERROR="绑定监听事件错误",t.SOCKET_CONNECT_NOTE="初始化未完成,请稍后重试",t.MT_CONNECTING="connecting",t.MT_CONNECT_SUCCESS="connect",t.MT_CONNECT_FAILED="connect_failed",t.MT_CONNECT_ERROR="error",t.MT_DISCONNECT="disconnect",t.MT_RECONNECTING="reconnecting",t.MT_RECONNECTING_FAILED="reconnecting_failed",t.CODE.LIVE_COURSE_UNEXIST=1260,t.CODE.LIVE_COURSE_CONFLICT=1261,t.CODE.LIVE_COURSE_END=1262,t.CODE.LIVE_COURSE_NOT_START=1263,t.PLAYER_CMD_START=1,t.PLAYER_CMD_PAUSE=2,t.PLAYER_CMD_STOP=3,t.PLAYER_CMD_RESUME=4,t.player.bufferlength=.5,t.player.bufferTimeMax=1,t.player.bufferTimeArr="[0.8,1.5,3]",t.player.cmdTimeDelay=0,t.camera.bufferlength=.5,t.camera.bufferTimeMax=1,t.camera.bufferTimeArr="[0.8,1.5,3]",t.VOICE_FLOW_DEFAULT=1,t.VOICE_FLOW_ADAPTER=2,t.VOICE_MODE_FREEDOM=0,t.VOICE_MODE_CHAIRMAN=1,t.VOICE_MODE_QUEUE=2,t.VOICE_MODE_HAND=3,t.HT_MAIN_PLAYER="HT_01",t.HT_CAMERA_PLAYER="HT_02",t.HT_LIVE_PLAYER="HT_03",t.ROOM.USER_CAMERA_MODE="5",t.CAMERA_URL_STREAM=null,t.player.PLAY_ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAJQElEQVR4Xu1bfaxcRRU/Z3b32fdqMFAIFBD7xFoSKSjyIUJAE2MaY4pFrIpoYpCgVlre696Z3VfQbW3f7sy+vOoTJERsVIJKsdJaxe/w1RJrK2AErfWjYsEKWL6U3bb77j3m6L7mvvvu3juzu32QtJPsPztnzvnNb87MnDkzF+EIL3iE9x+OEnDUA45wBo5OgelwgLVr184+ePDgIgCYh4izieh4RBRsm4j+AwD/5B8i7iWivUKIXZ7nPTYd2A6bB1QqlflCCO70ZQBwThud2UNEGwDgB/39/Q8sXrzYb0NHapOuE6C1PhcRbwKAC1KtWwoQ0fOIuG7GjBmrli5d+pJlMyuxrhHQdPMxRLzCynJ7Qi8Q0cr+/v6vdMsjOiaAiNAYIwHg84jY116/nFvtDILg2kKh8IBzy0iDjggYHh4+IZvNfhsA3mMDhIj+AAAPAcCDQognwm2IqIeIXg8AcxHxYgA4HwByrfQSUYCIq2u12spSqRTY2I+TaZuASqVymhBiCwAw6JaFiHYg4q3j4+ObhoaGnrUFWqlUXieEuBIAPgsAZyYQcW8QBB8sFovP2+oOy7VFgDFmLhHdh4gntzB6AABuF0Kszefzv28H2EQbnmIjIyMfC4JgDSKeFqeLiP4GAAuUUn90teVMQLVa7Q+CYBsintDC2GYhxHX5fH6Si7sCi8qXSqUZvb29BUQcipsaHD/4vn+2i5exDScChoeHZ2UymYdbjESDiKRS6kuddjapfblcfpsQYmMLDNtrtdolpVJpvy0GawKaq/0vEfHdUeVEdBARL5NS/sTWcCdy5XL5WCHEDxHxnTF6bpFS8rphVawJ0ForRKzEdH682fl7rCx2SahUKmX7+vq+14w0J2lFxMs9z7vbxpQVAc0g588x+zwBwIeklByyTnsplUo9vb297JW8bR4qRLTP9/15Q0ND+9JAWRFgjLkdAK6KGf2VSqlSmpHDWc+D02g0dgLAMRESvquU+mia7VQCeMsDAN5eorI/8zxvASKyF7yiRWv9cUT8VhQEIs5PO1XaEPBNAPhERPmBTCYzd/ny5Xte0Z6HjBtjOCi7KOIF65VSH07CmEjAyMjI8b7vPz1xdg8pWi2lvNG28yMjI2/3ff9eAOAF88ZarXZLJ+FrnN1qtXomEf0uUkeNRmP2ihUrnm6FNZEAY0weAKoRVl8kojcUCoUXbQkwxtwAAF+ckCeixxHxWinlVlsdNnLGmPW8KEfwLlNKjbVLwCMA8NaIwjGl1DIbQBMyWutVPPIxbTYQ0fVKqSdd9LWSrVQqFwshHozgfUgpNWlqhOtbesDo6Ohx4+PjU7YRIcT5+Xx+uwvgBAI4JcZRW7Verw+7RHCt7Gut9yDiqaF6mjlz5jFLlizh1NuU0pKAarW6iIi+H2nxjJTyRJfOs2wSAaFp8SQiSinld1z1h+WNMezu14X/C4LgfYVC4cdOBBhjeM7y3D1UiOgOpdSUeCANsA0BIR1bm8mOx9P0xtVrrRci4qYI7pbxSksP0FrfFU1vBUGwvFAojLoCcySApwUnO27LZrPFwcHB51zsaa1PRsSnIm3ulFJ+xMkDtNbbEfHcSQsG4kLP8za7ALKdAi10tpUD1Fr/GxFfG5pejyilYjPTSR6wExHnhYH5vn9OsVjkncGpuHpAjHKnHKAxhlNvZ4T07JZSvtHVA6KrKfi+f3qxWPyrU+8tF8E0nXzkBoCzbLI+Md77LyllbAInyQOeiqa8stnsqYODg9H5lYbdahdIVfJ/gXdJKe9PkzXGcOL1wpDcc1LKWa4eMGUKAMCbpZR/SgMQre/CFDiAiOV8Ps8BVerhyxjDIXE4kfqElHKOEwHGmF8DwHmR7eQCpRT/71Q6IYCINmYymetdcozGmL0AcFII5GNSyvmuBMTF1Vcppe5w6n37awCf8T9t4/JhPGNjY6/Zv39/NCe4WUq50JWAlXzbE/EArZQqHGYCXgCA0pw5c25q5/rLGMPb3W9scSctgpcj4qRUFxH9SikVXlysuLCZAs3g52vZbHbINfgJgzDGDADApGCNiFp6ruthiHzfn+V6C2NBQEfhb4QAjvkXhP9DxBM9z3vGaQqwsNb6UUQ8O9LwGinlbVZD3xRKIIAzSp6U8k4Xfa1kOV2eyWT4+i0zIUNEu5RSkwK6SeQkGTbG8BrAa0G4bJNSvsMFcIyeOh+Ba7VauRtH4AksWuuliPjlCLYvSClXtcKbmBEql8tvymQyU/Z9vhzxPO8+WxKq1eqFQRBs4dQaEXEuf6BbSZAJDJwi7+vr4+u48PZHuVzulIGBAd4WY0tqUlRrfT8iXhJZVXcopSbFCGlkNC9UhU0om6Yrrl5rvRwRRyJ1G6SUiQ82UgkwxrwXAH4aY/RqKeW6dsB2u40xhkedzyi9Yd1CiLek3U6nEsAKY2Jr/vulXC53RpJ7dbujcfrWr1+f2b17N1/VT7odAoDU0Wd9VgTwWiCE4ExuT2Qq/Lxery/odorbhThjzFcB4DORNtb3FlYEsHKtdRERh6PgiOjrSqlPuYDulqwxht8KrInBZH1lZ01A0vU4ANxcq9WWTqcnGGN41Hn0o2Vr842A1bshawLYCj+QyGazvwWAU2IM3xMEwZUuFybtekLzVZqOGfm9uVzuPJechRMBbLBarZ7FZ4Loist1RPR3RFwkpXy43c4ltWs+jPgGIk452RHRs4h4kWu+wpmA5q7wfiLirPGMmFHgjO66RqNxQ9KdnAtBfMSt1+tXA8BqRDw2xuY+Irq0UCg4p9LbIoABNN/q/IgfP7fozMtEVO7p6bl5YGCAj7jORWvNj6uvAYBPAsBxcQqI6B+IyKky50yV9TbYCrnNQ8lmMvMuIQQ/oflFq1MZ2xgdHe1tNBq8n1+KiPz4MvG9MRFtGR8fv6ITT2vbAyZICT2VLcVNiRh35QeNf0HElyN1nMfni9hDJ7kElzlARGvq9fqaTneejgmYAKm15gvJtYf5sTSb2ySEWOaSI0yae10jIERE15/LN3eYHUKIz3met815MUlo0HUCJmw1t8sPdPDBBKt6lD+Y8H1/Yzs3UjZEHTYCwsZjPpnhnYNPcCchImP43ycz/Ny1+dnMrlwud7dLQGPT2TiZaSGgXXDT0e4oAdPB8qvZxlEPeDWPznRgO+I94L+7uQh9LgqjswAAAABJRU5ErkJggg==",t}.apply(e,[]))||(t.exports=n)},function(t,e,i){"use strict";var n=i(28),r=i(63),o=Object.prototype.toString;function s(t){return"[object Array]"===o.call(t)}function a(t){return null!==t&&"object"==typeof t}function l(t){return"[object Function]"===o.call(t)}function c(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),s(t))for(var i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}t.exports={isArray:s,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:r,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:l,isStream:function(t){return a(t)&&l(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function t(){var e={};function i(i,n){"object"==typeof e[n]&&"object"==typeof i?e[n]=t(e[n],i):e[n]=i}for(var n=0,r=arguments.length;n<r;n++)c(arguments[n],i);return e},deepMerge:function t(){var e={};function i(i,n){"object"==typeof e[n]&&"object"==typeof i?e[n]=t(e[n],i):e[n]="object"==typeof i?t({},i):i}for(var n=0,r=arguments.length;n<r;n++)c(arguments[n],i);return e},extend:function(t,e,i){return c(e,(function(e,r){t[r]=i&&"function"==typeof e?n(e,i):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,i){(function(t){
/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */
var n,r,o,s,a,l,c,u,h,f,d,p,g,m,v,y,_,b,w,x,C,T=T||{version:"3.4.0"};if(e.fabric=T,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?T.document=document:T.document=document.implementation.createHTMLDocument(""),T.window=window;else{var S=new(i(115).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;T.document=S.document,T.jsdomImplForWrapper=i(116).implForWrapper,T.nodeCanvas=i(117).Canvas,T.window=S,DOMParser=T.window.DOMParser}function k(t,e){var i=t.canvas,n=e.targetCanvas,r=n.getContext("2d");r.translate(0,n.height),r.scale(1,-1);var o=i.height-n.height;r.drawImage(i,0,o,n.width,n.height,0,0,n.width,n.height)}function O(t,e){var i=e.targetCanvas.getContext("2d"),n=e.destinationWidth,r=e.destinationHeight,o=n*r*4,s=new Uint8Array(this.imageBuffer,0,o),a=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,r,t.RGBA,t.UNSIGNED_BYTE,s);var l=new ImageData(a,n,r);i.putImageData(l,0,0)}T.isTouchSupported="ontouchstart"in T.window||"ontouchstart"in T.document||T.window&&T.window.navigator&&T.window.navigator.maxTouchPoints>0,T.isLikelyNode=void 0!==t&&"undefined"==typeof window,T.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],T.DPI=96,T.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",T.fontPaths={},T.iMatrix=[1,0,0,1,0,0],T.perfLimitSizeTotal=2097152,T.maxCacheSideLimit=4096,T.minCacheSideLimit=256,T.charWidthsCache={},T.textureSize=2048,T.disableStyleCopyPaste=!1,T.enableGLFiltering=!0,T.devicePixelRatio=T.window.devicePixelRatio||T.window.webkitDevicePixelRatio||T.window.mozDevicePixelRatio||1,T.browserShadowBlurConstant=1,T.arcToSegmentsCache={},T.boundsOfCurveCache={},T.cachesBoundsOfCurve=!0,T.forceGLPutImageData=!1,T.initFilterBackend=function(){return T.enableGLFiltering&&T.isWebglSupported&&T.isWebglSupported(T.textureSize)?(console.log("max texture size: "+T.maxTextureSize),new T.WebglFilterBackend({tileSize:T.textureSize})):T.Canvas2dFilterBackend?new T.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=T),function(){function t(t,e){if(this.__eventListeners[t]){var i=this.__eventListeners[t];e?i[i.indexOf(e)]=!1:T.util.array.fill(i,!1)}}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof arguments[0])for(var n in e)t.call(this,n,e[n]);else t.call(this,e,i);return this}function n(t,e){if(!this.__eventListeners)return this;var i=this.__eventListeners[t];if(!i)return this;for(var n=0,r=i.length;n<r;n++)i[n]&&i[n].call(this,e||{});return this.__eventListeners[t]=i.filter((function(t){return!1!==t})),this}T.Observable={observe:e,stopObserving:i,fire:n,on:e,off:i,trigger:n}}(),T.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,i){var n=this._objects;return i?n[e]=t:n.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,i=!1,n=0,r=arguments.length;n<r;n++)-1!==(t=e.indexOf(arguments[n]))&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[n]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),n=0,r=i.length;n<r;n++)t.call(e,i[n],n,i);return this},getObjects:function(t){return void 0===t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t){return this._objects.indexOf(t)>-1},complexity:function(){return this._objects.reduce((function(t,e){return t+=e.complexity?e.complexity():0}),0)}},T.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof T.Gradient||this.set(e,new T.Gradient(t))},_initPattern:function(t,e,i){!t||!t.source||t instanceof T.Pattern?i&&i():this.set(e,new T.Pattern(t,i))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var e=T.util.getFunctionBody(t.clipTo);void 0!==e&&(this.clipTo=new Function("ctx",e))}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},n=e,r=Math.sqrt,o=Math.atan2,s=Math.pow,a=Math.PI/180,l=Math.PI/2,T.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/l){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/l){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*a},radiansToDegrees:function(t){return t/a},rotatePoint:function(t,e,i){t.subtractEquals(e);var n=T.util.rotateVector(t,i);return new T.Point(n.x,n.y).addEquals(e)},rotateVector:function(t,e){var i=T.util.sin(e),n=T.util.cos(e);return{x:t.x*n-t.y*i,y:t.x*i+t.y*n}},transformPoint:function(t,e,i){return i?new T.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new T.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var i=0;i<t.length;i++)t[i]=T.util.transformPoint(t[i],e);var n=[t[0].x,t[1].x,t[2].x,t[3].x],r=T.util.array.min(n),o=T.util.array.max(n)-r,s=[t[0].y,t[1].y,t[2].y,t[3].y],a=T.util.array.min(s);return{left:r,top:a,width:o,height:T.util.array.max(s)-a}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),i=[e*t[3],-e*t[1],-e*t[2],e*t[0]],n=T.util.transformPoint({x:t[4],y:t[5]},i,!0);return i[4]=-n.x,i[5]=-n.y,i},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),n=parseFloat(t);switch(e||(e=T.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return n*T.DPI/25.4;case"cm":return n*T.DPI/2.54;case"in":return n*T.DPI;case"pt":return n*T.DPI/72;case"pc":return n*T.DPI/72*12;case"em":return n*e;default:return n}},falseFunction:function(){return!1},getKlass:function(t,e){return t=T.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),T.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return T;var e,i=t.split("."),r=i.length,o=n||T.window;for(e=0;e<r;++e)o=o[i[e]];return o},loadImage:function(t,e,i,n){if(t){var r=T.util.createImage(),o=function(){e&&e.call(i,r),r=r.onload=r.onerror=null};r.onload=o,r.onerror=function(){T.log("Error loading "+r.src),e&&e.call(i,null,!0),r=r.onload=r.onerror=null},0!==t.indexOf("data")&&n&&(r.crossOrigin=n),"data:image/svg"===t.substring(0,14)&&(r.onload=null,T.util.loadImageInDom(r,o)),r.src=t}else e&&e.call(i,t)},loadImageInDom:function(t,e){var i=T.document.createElement("div");i.style.width=i.style.height="1px",i.style.left=i.style.top="-100%",i.style.position="absolute",i.appendChild(t),T.document.querySelector("body").appendChild(i),t.onload=function(){e(),i.parentNode.removeChild(i),i=null}},enlivenObjects:function(t,e,i,n){var r=[],o=0,s=(t=t||[]).length;function a(){++o===s&&e&&e(r.filter((function(t){return t})))}s?t.forEach((function(t,e){t&&t.type?T.util.getKlass(t.type,i).fromObject(t,(function(i,o){o||(r[e]=i),n&&n(t,i,o),a()})):a()})):e&&e(r)},enlivenPatterns:function(t,e){function i(){++r===o&&e&&e(n)}var n=[],r=0,o=(t=t||[]).length;o?t.forEach((function(t,e){t&&t.source?new T.Pattern(t,(function(t){n[e]=t,i()})):(n[e]=t,i())})):e&&e(n)},groupSVGElements:function(t,e,i){var n;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),n=new T.Group(t,e),void 0!==i&&(n.sourcePath=i),n)},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var n=0,r=i.length;n<r;n++)i[n]in t&&(e[i[n]]=t[i[n]])},drawDashedLine:function(t,e,i,n,s,a){var l=n-e,c=s-i,u=r(l*l+c*c),h=o(c,l),f=a.length,d=0,p=!0;for(t.save(),t.translate(e,i),t.moveTo(0,0),t.rotate(h),e=0;u>e;)(e+=a[d++%f])>u&&(e=u),t[p?"lineTo":"moveTo"](e,0),p=!p;t.restore()},createCanvasElement:function(){return T.document.createElement("canvas")},copyCanvasElement:function(t){var e=T.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,i){return t.toDataURL("image/"+e,i)},createImage:function(){return T.document.createElement("img")},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=o(t[1],t[0]),i=s(t[0],2)+s(t[1],2),n=r(i),l=(t[0]*t[3]-t[2]*t[1])/n,c=o(t[0]*t[2]+t[1]*t[3],i);return{angle:e/a,scaleX:n,scaleY:l,skewX:c/a,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return T.iMatrix.concat();var e=T.util.degreesToRadians(t.angle),i=T.util.cos(e),n=T.util.sin(e);return[i,n,-n,i,0,0]},calcDimensionsMatrix:function(t){var e=void 0===t.scaleX?1:t.scaleX,i=void 0===t.scaleY?1:t.scaleY,n=[t.flipX?-e:e,0,0,t.flipY?-i:i,0,0],r=T.util.multiplyTransformMatrices,o=T.util.degreesToRadians;return t.skewX&&(n=r(n,[1,0,Math.tan(o(t.skewX)),1],!0)),t.skewY&&(n=r(n,[1,Math.tan(o(t.skewY)),0,1],!0)),n},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],i=T.util.multiplyTransformMatrices;return t.angle&&(e=i(e,T.util.calcRotateMatrix(t))),(t.scaleX||t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=i(e,T.util.calcDimensionsMatrix(t))),e},customTransformMatrix:function(t,e,i){return T.util.composeMatrix({scaleX:t,scaleY:e,skewX:i})},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,n){n>0&&(e>n?e-=n:e=0,i>n?i-=n:i=0);var r,o=!0,s=t.getImageData(e,i,2*n||1,2*n||1),a=s.data.length;for(r=3;r<a&&!1!=(o=s.data[r]<=0);r+=4);return s=null,o},parsePreserveAspectRatioAttribute:function(t){var e,i="meet",n=t.split(" ");return n&&n.length&&("meet"!==(i=n.pop())&&"slice"!==i?(e=i,i="meet"):n.length&&(e=n.pop())),{meetOrSlice:i,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?T.charWidthsCache[t]&&delete T.charWidthsCache[t]:T.charWidthsCache={}},limitDimsByArea:function(t,e){var i=Math.sqrt(e*t),n=Math.floor(e/i);return{x:Math.floor(i),y:n}},capValue:function(t,e,i){return Math.max(t,Math.min(e,i))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return T.util.toFixed(t,T.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"}},function(){var t=Array.prototype.join;function e(e,r,o,s,a,l,c){var u=t.call(arguments);if(T.arcToSegmentsCache[u])return T.arcToSegmentsCache[u];var h=Math.PI,f=c*h/180,d=T.util.sin(f),p=T.util.cos(f),g=0,m=0,v=-p*e*.5-d*r*.5,y=-p*r*.5+d*e*.5,_=(o=Math.abs(o))*o,b=(s=Math.abs(s))*s,w=y*y,x=v*v,C=_*b-_*w-b*x,S=0;if(C<0){var k=Math.sqrt(1-C/(_*b));o*=k,s*=k}else S=(a===l?-1:1)*Math.sqrt(C/(_*w+b*x));var O=S*o*y/s,j=-S*s*v/o,E=p*O-d*j+.5*e,A=d*O+p*j+.5*r,P=n(1,0,(v-O)/o,(y-j)/s),D=n((v-O)/o,(y-j)/s,(-v-O)/o,(-y-j)/s);0===l&&D>0?D-=2*h:1===l&&D<0&&(D+=2*h);for(var M=Math.ceil(Math.abs(D/h*2)),I=[],R=D/M,F=8/3*Math.sin(R/4)*Math.sin(R/4)/Math.sin(R/2),L=P+R,B=0;B<M;B++)I[B]=i(P,L,p,d,o,s,E,A,F,g,m),g=I[B][4],m=I[B][5],P=L,L+=R;return T.arcToSegmentsCache[u]=I,I}function i(t,e,i,n,r,o,s,a,l,c,u){var h=T.util.cos(t),f=T.util.sin(t),d=T.util.cos(e),p=T.util.sin(e),g=i*r*d-n*o*p+s,m=n*r*d+i*o*p+a;return[c+l*(-i*r*f-n*o*h),u+l*(-n*r*f+i*o*h),g+l*(i*r*p+n*o*d),m+l*(n*r*p-i*o*d),g,m]}function n(t,e,i,n){var r=Math.atan2(e,t),o=Math.atan2(n,i);return o>=r?o-r:2*Math.PI-(r-o)}function r(e,i,n,r,o,s,a,l){var c;if(T.cachesBoundsOfCurve&&(c=t.call(arguments),T.boundsOfCurveCache[c]))return T.boundsOfCurveCache[c];var u,h,f,d,p,g,m,v,y=Math.sqrt,_=Math.min,b=Math.max,w=Math.abs,x=[],C=[[],[]];h=6*e-12*n+6*o,u=-3*e+9*n-9*o+3*a,f=3*n-3*e;for(var S=0;S<2;++S)if(S>0&&(h=6*i-12*r+6*s,u=-3*i+9*r-9*s+3*l,f=3*r-3*i),w(u)<1e-12){if(w(h)<1e-12)continue;0<(d=-f/h)&&d<1&&x.push(d)}else(m=h*h-4*f*u)<0||(0<(p=(-h+(v=y(m)))/(2*u))&&p<1&&x.push(p),0<(g=(-h-v)/(2*u))&&g<1&&x.push(g));for(var k,O,j,E=x.length,A=E;E--;)k=(j=1-(d=x[E]))*j*j*e+3*j*j*d*n+3*j*d*d*o+d*d*d*a,C[0][E]=k,O=j*j*j*i+3*j*j*d*r+3*j*d*d*s+d*d*d*l,C[1][E]=O;C[0][A]=e,C[1][A]=i,C[0][A+1]=a,C[1][A+1]=l;var P=[{x:_.apply(null,C[0]),y:_.apply(null,C[1])},{x:b.apply(null,C[0]),y:b.apply(null,C[1])}];return T.cachesBoundsOfCurve&&(T.boundsOfCurveCache[c]=P),P}T.util.drawArc=function(t,i,n,r){for(var o=r[0],s=r[1],a=r[2],l=r[3],c=r[4],u=[[],[],[],[]],h=e(r[5]-i,r[6]-n,o,s,l,c,a),f=0,d=h.length;f<d;f++)u[f][0]=h[f][0]+i,u[f][1]=h[f][1]+n,u[f][2]=h[f][2]+i,u[f][3]=h[f][3]+n,u[f][4]=h[f][4]+i,u[f][5]=h[f][5]+n,t.bezierCurveTo.apply(t,u[f])},T.util.getBoundsOfArc=function(t,i,n,o,s,a,l,c,u){for(var h,f=0,d=0,p=[],g=e(c-t,u-i,n,o,a,l,s),m=0,v=g.length;m<v;m++)h=r(f,d,g[m][0],g[m][1],g[m][2],g[m][3],g[m][4],g[m][5]),p.push({x:h[0].x+t,y:h[0].y+i}),p.push({x:h[1].x+t,y:h[1].y+i}),f=g[m][4],d=g[m][5];return p},T.util.getBoundsOfCurve=r}(),function(){var t=Array.prototype.slice;function e(t,e,i){if(t&&0!==t.length){var n=t.length-1,r=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],r)&&(r=t[n][e]);else for(;n--;)i(t[n],r)&&(r=t[n]);return r}}T.util.array={fill:function(t,e){for(var i=t.length;i--;)t[i]=e;return t},invoke:function(e,i){for(var n=t.call(arguments,2),r=[],o=0,s=e.length;o<s;o++)r[o]=n.length?e[o][i].apply(e[o],n):e[o][i].call(e[o]);return r},min:function(t,i){return e(t,i,(function(t,e){return t<e}))},max:function(t,i){return e(t,i,(function(t,e){return t>=e}))}}}(),function(){function t(e,i,n){if(n)if(!T.isLikelyNode&&i instanceof Element)e=i;else if(i instanceof Array){e=[];for(var r=0,o=i.length;r<o;r++)e[r]=t({},i[r],n)}else if(i&&"object"==typeof i)for(var s in i)"canvas"===s?e[s]=t({},i[s]):i.hasOwnProperty(s)&&(e[s]=t({},i[s],n));else e=i;else for(var s in i)e[s]=i[s];return e}T.util.object={extend:t,clone:function(e,i){return t({},e,i)}},T.util.object.extend(T.util,T.Observable)}(),function(){function t(t,e){var i=t.charCodeAt(e);if(isNaN(i))return"";if(i<55296||i>57343)return t.charAt(e);if(55296<=i&&i<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var n=t.charCodeAt(e+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var r=t.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}T.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var i,n=0,r=[];for(n=0;n<e.length;n++)!1!==(i=t(e,n))&&r.push(i);return r}}}(),function(){var t=Array.prototype.slice,e=function(){},i=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),n=function(t,e,n){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var i=this.constructor.superclass;this.constructor.superclass=n;var r=e[t].apply(this,arguments);if(this.constructor.superclass=i,"initialize"!==t)return r}}(r):t.prototype[r]=e[r],i&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function r(){}function o(e){for(var i=null,n=this;n.constructor.superclass;){var r=n.constructor.superclass.prototype[e];if(n[e]!==r){i=r;break}n=n.constructor.superclass.prototype}return i?arguments.length>1?i.apply(this,t.call(arguments,1)):i.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}T.util.createClass=function(){var i=null,s=t.call(arguments,0);function a(){this.initialize.apply(this,arguments)}"function"==typeof s[0]&&(i=s.shift()),a.superclass=i,a.subclasses=[],i&&(r.prototype=i.prototype,a.prototype=new r,i.subclasses.push(a));for(var l=0,c=s.length;l<c;l++)n(a,s[l],i);return a.prototype.initialize||(a.prototype.initialize=e),a.prototype.constructor=a,a.prototype.callSuper=o,a}}(),c=!!T.document.createElement("div").attachEvent,T.util.addListener=function(t,e,i,n){t&&t.addEventListener(e,i,!c&&n)},T.util.removeListener=function(t,e,i,n){t&&t.removeEventListener(e,i,!c&&n)},T.util.getPointer=function(t){var e=t.target,i=T.util.getScrollLeftTop(e),n=function(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}(t);return{x:n.clientX+i.left,y:n.clientY+i.top}},u=T.document.createElement("div"),h="string"==typeof u.style.opacity,f="string"==typeof u.style.filter,d=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,p=function(t){return t},h?p=function(t,e){return t.style.opacity=e,t}:f&&(p=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),d.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(d,e)):i.filter+=" alpha(opacity="+100*e+")",t}),T.util.setStyle=function(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?p(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var n in e)"opacity"===n?p(t,e[n]):i["float"===n||"cssFloat"===n?void 0===i.styleFloat?"cssFloat":"styleFloat":n]=e[n];return t},function(){var t=Array.prototype.slice;var e,i,n,r,o=function(e){return t.call(e,0)};try{e=o(T.document.childNodes)instanceof Array}catch(t){}function s(t,e){var i=T.document.createElement(t);for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:i.setAttribute(n,e[n]);return i}function a(t){for(var e=0,i=0,n=T.document.documentElement,r=T.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===T.document?(e=r.scrollLeft||n.scrollLeft||0,i=r.scrollTop||n.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:i}}e||(o=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e}),i=T.document.defaultView&&T.document.defaultView.getComputedStyle?function(t,e){var i=T.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},n=T.document.documentElement.style,r="userSelect"in n?"userSelect":"MozUserSelect"in n?"MozUserSelect":"WebkitUserSelect"in n?"WebkitUserSelect":"KhtmlUserSelect"in n?"KhtmlUserSelect":"",T.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=T.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},T.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},T.util.getScript=function(t,e){var i=T.document.getElementsByTagName("head")[0],n=T.document.createElement("script"),r=!0;n.onload=n.onreadystatechange=function(t){if(r){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;r=!1,e(t||T.window.event),n=n.onload=n.onreadystatechange=null}},n.src=t,i.appendChild(n)},T.util.getById=function(t){return"string"==typeof t?T.document.getElementById(t):t},T.util.toArray=o,T.util.makeElement=s,T.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},T.util.wrapElement=function(t,e,i){return"string"==typeof e&&(e=s(e,i)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},T.util.getScrollLeftTop=a,T.util.getElementOffset=function(t){var e,n,r=t&&t.ownerDocument,o={left:0,top:0},s={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return s;for(var c in l)s[l[c]]+=parseInt(i(t,c),10)||0;return e=r.documentElement,void 0!==t.getBoundingClientRect&&(o=t.getBoundingClientRect()),n=a(t),{left:o.left+n.left-(e.clientLeft||0)+s.left,top:o.top+n.top-(e.clientTop||0)+s.top}},T.util.getElementStyle=i,T.util.getNodeCanvas=function(t){var e=T.jsdomImplForWrapper(t);return e._canvas||e._image},T.util.cleanUpJsdomNode=function(t){if(T.isLikelyNode){var e=T.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}T.util.request=function(e,i){i||(i={});var n=i.method?i.method.toUpperCase():"GET",r=i.onComplete||function(){},o=new T.window.XMLHttpRequest,s=i.body||i.parameters;return o.onreadystatechange=function(){4===o.readyState&&(r(o),o.onreadystatechange=t)},"GET"===n&&(s=null,"string"==typeof i.parameters&&(e=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(e,i.parameters))),o.open(n,e,!0),"POST"!==n&&"PUT"!==n||o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(s),o}}(),T.log=function(){},T.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach((function(t){void 0!==console[t]&&"function"==typeof console[t].apply&&(T[t]=function(){return console[t].apply(console,arguments)})})),function(){function t(){return!1}function e(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e}var i=T.window.requestAnimationFrame||T.window.webkitRequestAnimationFrame||T.window.mozRequestAnimationFrame||T.window.oRequestAnimationFrame||T.window.msRequestAnimationFrame||function(t){return T.window.setTimeout(t,1e3/60)},n=T.window.cancelAnimationFrame||T.window.clearTimeout;function r(){return i.apply(T.window,arguments)}T.util.animate=function(i){r((function(n){i||(i={});var o,s=n||+new Date,a=i.duration||500,l=s+a,c=i.onChange||t,u=i.abort||t,h=i.onComplete||t,f=i.easing||e,d="startValue"in i?i.startValue:0,p="endValue"in i?i.endValue:100,g=i.byValue||p-d;i.onStart&&i.onStart(),function t(e){var i=(o=e||+new Date)>l?a:o-s,n=i/a,m=f(i,d,g,a),v=Math.abs((m-d)/g);if(!u())return o>l?(c(p,1,1),void h(p,1,1)):(c(m,v,n),void r(t));h(p,1,1)}(s)}))},T.util.requestAnimFrame=r,T.util.cancelAnimFrame=function(){return n.apply(T.window,arguments)}}(),T.util.animateColor=function(t,e,i,n){var r=new T.Color(t).getSource(),o=new T.Color(e).getSource();n=n||{},T.util.animate(T.util.object.extend(n,{duration:i||500,startValue:r,endValue:o,byValue:o,easing:function(t,e,i,r){var o,s,a,l,c=n.colorEasing?n.colorEasing(t,r):1-Math.cos(t/r*(Math.PI/2));return o=e,s=i,a=c,l="rgba("+parseInt(o[0]+a*(s[0]-o[0]),10)+","+parseInt(o[1]+a*(s[1]-o[1]),10)+","+parseInt(o[2]+a*(s[2]-o[2]),10),l+=","+(o&&s?parseFloat(o[3]+a*(s[3]-o[3])):1),l+=")"}}))},function(){function t(t,e,i,n){return t<Math.abs(e)?(t=e,n=i/4):n=0===e&&0===t?i/(2*Math.PI)*Math.asin(1):i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:n}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function i(t,e,i,r){return i-n(r-t,0,i,r)+e}function n(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}T.util.ease={easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,i,n){return t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(i,n,r,o){var s=0;return 0===i?n:1===(i/=o)?n+r:(s||(s=.3*o),-e(t(r,r,s,1.70158),i,o)+n)},easeOutElastic:function(e,i,n,r){var o=0;if(0===e)return i;if(1===(e/=r))return i+n;o||(o=.3*r);var s=t(n,n,o,1.70158);return s.a*Math.pow(2,-10*e)*Math.sin((e*r-s.s)*(2*Math.PI)/s.p)+s.c+i},easeInOutElastic:function(i,n,r,o){var s=0;if(0===i)return n;if(2===(i/=o/2))return n+r;s||(s=o*(.3*1.5));var a=t(r,r,s,1.70158);return i<1?-.5*e(a,i,o)+n:a.a*Math.pow(2,-10*(i-=1))*Math.sin((i*o-a.s)*(2*Math.PI)/a.p)*.5+a.c+n},easeInBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*(t/=n)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:i,easeOutBounce:n,easeInOutBounce:function(t,e,r,o){return t<o/2?.5*i(2*t,0,r,o)+e:.5*n(2*t-o,0,r,o)+.5*r+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,r=e.util.toFixed,o=e.util.parseUnit,s=e.util.multiplyTransformMatrices,a={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform"},l={stroke:"strokeOpacity",fill:"fillOpacity"};function c(t){return t in a?a[t]:t}function u(t,i,n,r){var a,l="[object Array]"===Object.prototype.toString.call(i);if("fill"!==t&&"stroke"!==t||"none"!==i)if("vector-effect"===t)i="non-scaling-stroke"===i;else if("strokeDashArray"===t)i="none"===i?null:i.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)i=n&&n.transformMatrix?s(n.transformMatrix,e.parseTransformAttribute(i)):e.parseTransformAttribute(i);else if("visible"===t)i="none"!==i&&"hidden"!==i,n&&!1===n.visible&&(i=!1);else if("opacity"===t)i=parseFloat(i),n&&void 0!==n.opacity&&(i*=n.opacity);else if("textAnchor"===t)i="start"===i?"left":"end"===i?"right":"center";else if("charSpacing"===t)a=o(i,r)/r*1e3;else if("paintFirst"===t){var c=i.indexOf("fill"),u=i.indexOf("stroke");i="fill";c>-1&&u>-1&&u<c?i="stroke":-1===c&&u>-1&&(i="stroke")}else{if("href"===t||"xlink:href"===t)return i;a=l?i.map(o):o(i,r)}else i="";return!l&&isNaN(a)?i:a}function h(t){return new RegExp("^("+t.join("|")+")\\b","i")}function f(t,e){var i,n,r,o,s=[];for(r=0,o=e.length;r<o;r++)i=e[r],n=t.getElementsByTagName(i),s=s.concat(Array.prototype.slice.call(n));return s}function d(t,e){var i,n=!0;return(i=p(t,e.pop()))&&e.length&&(n=function(t,e){var i,n=!0;for(;t.parentNode&&1===t.parentNode.nodeType&&e.length;)n&&(i=e.pop()),t=t.parentNode,n=p(t,i);return 0===e.length}(t,e)),i&&n&&0===e.length}function p(t,e){var i,n,r=t.nodeName,o=t.getAttribute("class"),s=t.getAttribute("id");if(i=new RegExp("^"+r,"i"),e=e.replace(i,""),s&&e.length&&(i=new RegExp("#"+s+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),o&&e.length)for(n=(o=o.split(" ")).length;n--;)i=new RegExp("\\."+o[n]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"");return 0===e.length}function g(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var n,r,o,s=t.getElementsByTagName("*");for(r=0,o=s.length;r<o;r++)if(e===(n=s[r]).getAttribute("id"))return n}e.svgValidTagNamesRegEx=h(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),e.svgViewBoxElementsRegEx=h(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=h(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=h(["symbol","g","a","svg","clipPath","defs"]),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,i,n){t[n]=Math.tan(e.util.degreesToRadians(i[0]))}var i=e.iMatrix,n=e.reNum,r="(?:\\s+,?\\s*|,\\s*)",o="(?:"+("(?:(matrix)\\s*\\(\\s*("+n+")"+r+"("+n+")"+r+"("+n+")"+r+"("+n+")"+r+"("+n+")"+r+"("+n+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+n+")(?:"+r+"("+n+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+n+")(?:"+r+"("+n+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+n+")(?:"+r+"("+n+")"+r+"("+n+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+n+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+n+")\\s*\\))")+")",s=new RegExp("^\\s*(?:"+("(?:"+o+"(?:"+r+"*"+o+")*)")+"?)\\s*$"),a=new RegExp(o,"g");return function(n){var r=i.concat(),l=[];if(!n||n&&!s.test(n))return r;n.replace(a,(function(n){var s=new RegExp(o).exec(n).filter((function(t){return!!t})),a=s[1],c=s.slice(2).map(parseFloat);switch(a){case"translate":!function(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}(r,c);break;case"rotate":c[0]=e.util.degreesToRadians(c[0]),function(t,i){var n=e.util.cos(i[0]),r=e.util.sin(i[0]),o=0,s=0;3===i.length&&(o=i[1],s=i[2]),t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=o-(n*o-r*s),t[5]=s-(r*o+n*s)}(r,c);break;case"scale":!function(t,e){var i=e[0],n=2===e.length?e[1]:e[0];t[0]=i,t[3]=n}(r,c);break;case"skewX":t(r,c,2);break;case"skewY":t(r,c,1);break;case"matrix":r=c}l.push(r.concat()),r=i.concat()}));for(var c=l[0];l.length>1;)l.shift(),c=e.util.multiplyTransformMatrices(c,l[0]);return c}}();var m=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function v(t){var i,n,r,s,a,l,c=t.getAttribute("viewBox"),u=1,h=1,f=t.getAttribute("width"),d=t.getAttribute("height"),p=t.getAttribute("x")||0,g=t.getAttribute("y")||0,v=t.getAttribute("preserveAspectRatio")||"",y=!c||!e.svgViewBoxElementsRegEx.test(t.nodeName)||!(c=c.match(m)),_=!f||!d||"100%"===f||"100%"===d,b=y&&_,w={},x="",C=0,T=0;if(w.width=0,w.height=0,w.toBeParsed=b,b)return w;if(y)return w.width=o(f),w.height=o(d),w;if(i=-parseFloat(c[1]),n=-parseFloat(c[2]),r=parseFloat(c[3]),s=parseFloat(c[4]),w.minX=i,w.minY=n,w.viewBoxWidth=r,w.viewBoxHeight=s,_?(w.width=r,w.height=s):(w.width=o(f),w.height=o(d),u=w.width/r,h=w.height/s),"none"!==(v=e.util.parsePreserveAspectRatioAttribute(v)).alignX&&("meet"===v.meetOrSlice&&(h=u=u>h?h:u),"slice"===v.meetOrSlice&&(h=u=u>h?u:h),C=w.width-r*u,T=w.height-s*u,"Mid"===v.alignX&&(C/=2),"Mid"===v.alignY&&(T/=2),"Min"===v.alignX&&(C=0),"Min"===v.alignY&&(T=0)),1===u&&1===h&&0===i&&0===n&&0===p&&0===g)return w;if((p||g)&&(x=" translate("+o(p)+" "+o(g)+") "),a=x+" matrix("+u+" 0 0 "+h+" "+(i*u+C)+" "+(n*h+T)+") ",w.viewboxTransform=e.parseTransformAttribute(a),"svg"===t.nodeName){for(l=t.ownerDocument.createElement("g");t.firstChild;)l.appendChild(t.firstChild);t.appendChild(l)}else a=(l=t).getAttribute("transform")+a;return l.setAttribute("transform",a),w}function y(t,e){var i=g(t,e.getAttribute("xlink:href").substr(1));if(i&&i.getAttribute("xlink:href")&&y(t,i),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(t){i&&!e.hasAttribute(t)&&i.hasAttribute(t)&&e.setAttribute(t,i.getAttribute(t))})),!e.children.length)for(var n=i.cloneNode(!0);n.firstChild;)e.appendChild(n.firstChild);e.removeAttribute("xlink:href")}e.parseSVGDocument=function(t,i,r,o){if(t){!function(t){for(var e=f(t,["use","svg:use"]),i=0;e.length&&i<e.length;){var n,r,o,s,a=e[i],l=(a.getAttribute("xlink:href")||a.getAttribute("href")).substr(1),c=a.getAttribute("x")||0,u=a.getAttribute("y")||0,h=g(t,l).cloneNode(!0),d=(h.getAttribute("transform")||"")+" translate("+c+", "+u+")",p=e.length;if(v(h),/^svg$/i.test(h.nodeName)){var m=h.ownerDocument.createElement("g");for(r=0,s=(o=h.attributes).length;r<s;r++)n=o.item(r),m.setAttribute(n.nodeName,n.nodeValue);for(;h.firstChild;)m.appendChild(h.firstChild);h=m}for(r=0,s=(o=a.attributes).length;r<s;r++)"x"!==(n=o.item(r)).nodeName&&"y"!==n.nodeName&&"xlink:href"!==n.nodeName&&"href"!==n.nodeName&&("transform"===n.nodeName?d=n.nodeValue+" "+d:h.setAttribute(n.nodeName,n.nodeValue));h.setAttribute("transform",d),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),a.parentNode.replaceChild(h,a),e.length===p&&i++}}(t);var s,a,l=e.Object.__uid++,c=v(t),u=e.util.toArray(t.getElementsByTagName("*"));if(c.crossOrigin=o&&o.crossOrigin,c.svgUid=l,0===u.length&&e.isLikelyNode){var h=[];for(s=0,a=(u=t.selectNodes('//*[name(.)!="svg"]')).length;s<a;s++)h[s]=u[s];u=h}var d=u.filter((function(t){return v(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)}));if(!d||d&&!d.length)i&&i([],{});else{var p={};u.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var i=t.getAttribute("id");p[i]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[l]=e.getGradientDefs(t),e.cssRules[l]=e.getCSSRules(t),e.clipPaths[l]=p,e.parseElements(d,(function(t,n){i&&(i(t,c,n,u),delete e.gradientDefs[l],delete e.cssRules[l],delete e.clipPaths[l])}),n(c),r,o)}}};var _=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");i(e,{parseFontDeclaration:function(t,e){var i=t.match(_);if(i){var n=i[1],r=i[3],s=i[4],a=i[5],l=i[6];n&&(e.fontStyle=n),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=o(s)),l&&(e.fontFamily=l),a&&(e.lineHeight="normal"===a?1:a)}},getGradientDefs:function(t){var e,i=f(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),n=0,r={};for(n=i.length;n--;)(e=i[n]).getAttribute("xlink:href")&&y(t,e),r[e.getAttribute("id")]=e;return r},parseAttributes:function(t,n,s){if(t){var a,h,f,p={};void 0===s&&(s=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(p=e.parseAttributes(t.parentNode,n,s));var g=n.reduce((function(e,i){return(a=t.getAttribute(i))&&(e[i]=a),e}),{});g=i(g,i(function(t,i){var n={};for(var r in e.cssRules[i])if(d(t,r.split(" ")))for(var o in e.cssRules[i][r])n[o]=e.cssRules[i][r][o];return n}(t,s),e.parseStyleAttribute(t))),h=f=p.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,g["font-size"]&&(g["font-size"]=h=o(g["font-size"],f));var m,v,y={};for(var _ in g)v=u(m=c(_),g[_],p,h),y[m]=v;y&&y.font&&e.parseFontDeclaration(y.font,y);var b=i(p,y);return e.svgValidParentsRegEx.test(t.nodeName)?b:function(t){for(var i in l)if(void 0!==t[l[i]]&&""!==t[i]){if(void 0===t[i]){if(!e.Object.prototype[i])continue;t[i]=e.Object.prototype[i]}if(0!==t[i].indexOf("url(")){var n=new e.Color(t[i]);t[i]=n.setAlpha(r(n.getAlpha()*t[l[i]],2)).toRgba()}}return t}(b)}},parseElements:function(t,i,n,r,o){new e.ElementsParser(t,i,n,r,o).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?function(t,e){var i,n;t.replace(/;\s*$/,"").split(";").forEach((function(t){var r=t.split(":");i=r[0].trim().toLowerCase(),n=r[1].trim(),e[i]=n}))}(i,e):function(t,e){var i,n;for(var r in t)void 0!==t[r]&&(i=r.toLowerCase(),n=t[r],e[i]=n)}(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;var e,i,n=[];for(e=0,i=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<i;e+=2)n.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return n},getCSSRules:function(t){var i,n,r=t.getElementsByTagName("style"),o={};for(i=0,n=r.length;i<n;i++){var s=r[i].textContent||r[i].text;""!==(s=s.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&s.match(/[^{]*\{[\s\S]*?\}/g).map((function(t){return t.trim()})).forEach((function(t){var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),s={},a=r[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(i=0,n=a.length;i<n;i++){var l=a[i].split(/\s*:\s*/),c=l[0],u=l[1];s[c]=u}(t=r[1]).split(",").forEach((function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(o[t]?e.util.object.extend(o[t],s):o[t]=e.util.object.clone(s))}))}))}return o},loadSVGFromURL:function(t,i,n,r){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var o=t.responseXML;o&&!o.documentElement&&e.window.ActiveXObject&&t.responseText&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(t.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));if(!o||!o.documentElement)return i&&i(null),!1;e.parseSVGDocument(o.documentElement,(function(t,e,n,r){i&&i(t,e,n,r)}),n,r)}})},loadSVGFromString:function(t,i,n,r){var o;if(t=t.trim(),void 0!==e.window.DOMParser){var s=new e.window.DOMParser;s&&s.parseFromString&&(o=s.parseFromString(t,"text/xml"))}else e.window.ActiveXObject&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));e.parseSVGDocument(o.documentElement,(function(t,e,n,r){i(t,e,n,r)}),n,r)}})}(e),T.ElementsParser=function(t,e,i,n,r){this.elements=t,this.callback=e,this.options=i,this.reviver=n,this.svgUid=i&&i.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g},(g=T.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},g.createObjects=function(){var t=this;this.elements.forEach((function(e,i){e.setAttribute("svgUid",t.svgUid),t.createObject(e,i)}))},g.findTag=function(t){return T[T.util.string.capitalize(t.tagName.replace("svg:",""))]},g.createObject=function(t,e){var i=this.findTag(t);if(i&&i.fromElement)try{i.fromElement(t,this.createCallback(e,t),this.options)}catch(t){T.log(t)}else this.checkIfDone()},g.createCallback=function(t,e){var i=this;return function(n){var r;i.resolveGradient(n,e,"fill"),i.resolveGradient(n,e,"stroke"),n instanceof T.Image&&n._originalElement&&(r=n.parsePreserveAspectRatioAttribute(e)),n._removeTransformMatrix(r),i.resolveClipPath(n),i.reviver&&i.reviver(e,n),i.instances[t]=n,i.checkIfDone()}},g.extractPropertyDefinition=function(t,e,i){var n=t[e];if(/^url\(/.test(n)){var r=this.regexUrl.exec(n)[1];return this.regexUrl.lastIndex=0,T[i][this.svgUid][r]}},g.resolveGradient=function(t,e,i){var n=this.extractPropertyDefinition(t,i,"gradientDefs");if(n){var r=e.getAttribute(i+"-opacity"),o=T.Gradient.fromElement(n,t,r,this.options);t.set(i,o)}},g.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},g.resolveClipPath=function(t){var e,i,n,r,o=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(o){n=[],i=T.util.invertTransform(t.calcTransformMatrix());for(var s=0;s<o.length;s++)e=o[s],this.findTag(e).fromElement(e,this.createClipPathCallback(t,n),this.options);o=1===n.length?n[0]:new T.Group(n),r=T.util.multiplyTransformMatrices(i,o.calcTransformMatrix());var a=T.util.qrDecompose(r);o.flipX=!1,o.flipY=!1,o.set("scaleX",a.scaleX),o.set("scaleY",a.scaleY),o.angle=a.angle,o.skewX=a.skewX,o.skewY=0,o.setPositionByOrigin({x:a.translateX,y:a.translateY},"center","center"),t.clipPath=o}},g.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))},function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=i,i.prototype={type:"point",constructor:i,add:function(t){return new i(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new i(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new i(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new i(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new i(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new i(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new i(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new i(this.x,this.y)}})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=i,e.Intersection.prototype={constructor:i,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,n,r,o){var s,a=(o.x-r.x)*(t.y-r.y)-(o.y-r.y)*(t.x-r.x),l=(n.x-t.x)*(t.y-r.y)-(n.y-t.y)*(t.x-r.x),c=(o.y-r.y)*(n.x-t.x)-(o.x-r.x)*(n.y-t.y);if(0!==c){var u=a/c,h=l/c;0<=u&&u<=1&&0<=h&&h<=1?(s=new i("Intersection")).appendPoint(new e.Point(t.x+u*(n.x-t.x),t.y+u*(n.y-t.y))):s=new i}else s=new i(0===a||0===l?"Coincident":"Parallel");return s},e.Intersection.intersectLinePolygon=function(t,e,n){var r,o,s,a,l=new i,c=n.length;for(a=0;a<c;a++)r=n[a],o=n[(a+1)%c],s=i.intersectLineLine(t,e,r,o),l.appendPoints(s.points);return l.points.length>0&&(l.status="Intersection"),l},e.Intersection.intersectPolygonPolygon=function(t,e){var n,r=new i,o=t.length;for(n=0;n<o;n++){var s=t[n],a=t[(n+1)%o],l=i.intersectLinePolygon(s,a,e);r.appendPoints(l.points)}return r.points.length>0&&(r.status="Intersection"),r},e.Intersection.intersectPolygonRectangle=function(t,n,r){var o=n.min(r),s=n.max(r),a=new e.Point(s.x,o.y),l=new e.Point(o.x,s.y),c=i.intersectLinePolygon(o,a,t),u=i.intersectLinePolygon(a,s,t),h=i.intersectLinePolygon(s,l,t),f=i.intersectLinePolygon(l,o,t),d=new i;return d.appendPoints(c.points),d.appendPoints(u.points),d.appendPoints(h.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function n(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=i,e.Color.prototype={_tryParsingColor:function(t){var e;t in i.colorNameMap&&(t=i.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=i.sourceFromHex(t)),e||(e=i.sourceFromRgb(t)),e||(e=i.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,i,n){t/=255,i/=255,n/=255;var r,o,s,a=e.util.array.max([t,i,n]),l=e.util.array.min([t,i,n]);if(s=(a+l)/2,a===l)r=o=0;else{var c=a-l;switch(o=s>.5?c/(2-a-l):c/(a+l),a){case t:r=(i-n)/c+(i<n?6:0);break;case i:r=(n-t)/c+2;break;case n:r=(t-i)/c+4}r/=6}return[Math.round(360*r),Math.round(100*o),Math.round(100*s)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,n=this.getSource();return t=1===(t=n[0].toString(16)).length?"0"+t:t,e=1===(e=n[1].toString(16)).length?"0"+e:e,i=1===(i=n[2].toString(16)).length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),n=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,n]),this},overlayWith:function(t){t instanceof i||(t=new i(t));var e,n=[],r=this.getAlpha(),o=this.getSource(),s=t.getSource();for(e=0;e<3;e++)n.push(Math.round(.5*o[e]+.5*s[e]));return n[3]=r,this.setSource(n),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return i.fromSource(i.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(i.reRGBa);if(e){var n=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),r=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),o=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(n,10),parseInt(r,10),parseInt(o,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=i.fromRgb,e.Color.fromHsl=function(t){return i.fromSource(i.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(i.reHSLa);if(e){var r,o,s,a=(parseFloat(e[1])%360+360)%360/360,l=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===l)r=o=s=c;else{var u=c<=.5?c*(l+1):c+l-c*l,h=2*c-u;r=n(h,u,a+1/3),o=n(h,u,a),s=n(h,u,a-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*s),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=i.fromHsl,e.Color.fromHex=function(t){return i.fromSource(i.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(i.reHex)){var e=t.slice(t.indexOf("#")+1),n=3===e.length||4===e.length,r=8===e.length||4===e.length,o=n?e.charAt(0)+e.charAt(0):e.substring(0,2),s=n?e.charAt(1)+e.charAt(1):e.substring(2,4),a=n?e.charAt(2)+e.charAt(2):e.substring(4,6),l=r?n?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(o,16),parseInt(s,16),parseInt(a,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new i;return e.setSource(t),e})}(e),function(){function t(t,e){var i,n,r,o,s=t.getAttribute("style"),a=t.getAttribute("offset")||0;if(a=(a=parseFloat(a)/(/%$/.test(a)?100:1))<0?0:a>1?1:a,s){var l=s.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),o=l.length;o--;){var c=l[o].split(/\s*:\s*/),u=c[0].trim(),h=c[1].trim();"stop-color"===u?i=h:"stop-opacity"===u&&(r=h)}}return i||(i=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),n=(i=new T.Color(i)).getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=n*e,{offset:a,color:i.toRgb(),opacity:r}}var e=T.util.object.clone;function i(t,e,i,n){var r,o;Object.keys(e).forEach((function(t){"Infinity"===(r=e[t])?o=1:"-Infinity"===r?o=0:(o=parseFloat(e[t],10),"string"==typeof r&&/^(\d+\.\d+)%|(\d+)%$/.test(r)&&(o*=.01,"pixels"===n&&("x1"!==t&&"x2"!==t&&"r2"!==t||(o*=i.viewBoxWidth||i.width),"y1"!==t&&"y2"!==t||(o*=i.viewBoxHeight||i.height)))),e[t]=o}))}T.Gradient=T.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,i=this;Object.keys(t).forEach((function(e){i[e]=t[e]})),this.id?this.id+="_"+T.Object.__uid++:this.id=T.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var i=new T.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return T.util.populateWithProperties(this,e,t),e},toSVG:function(t,i){var n,r,o,s,a=e(this.coords,!0),l=(i=i||{},e(this.colorStops,!0)),c=a.r1>a.r2,u=this.gradientTransform?this.gradientTransform.concat():T.iMatrix.concat(),h=-this.offsetX,f=-this.offsetY,d=!!i.additionalTransform,p="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(t,e){return t.offset-e.offset})),"objectBoundingBox"===p?(h/=t.width,f/=t.height):(h+=t.width/2,f+=t.height/2),"path"===t.type&&(h-=t.pathOffset.x,f-=t.pathOffset.y),u[4]-=h,u[5]-=f,s='id="SVGID_'+this.id+'" gradientUnits="'+p+'"',s+=' gradientTransform="'+(d?i.additionalTransform+" ":"")+T.util.matrixToSVG(u)+'" ',"linear"===this.type?o=["<linearGradient ",s,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,'">\n']:"radial"===this.type&&(o=["<radialGradient ",s,' cx="',c?a.x1:a.x2,'" cy="',c?a.y1:a.y2,'" r="',c?a.r1:a.r2,'" fx="',c?a.x2:a.x1,'" fy="',c?a.y2:a.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),n=0,r=l.length;n<r;n++)l[n].offset=1-l[n].offset;var g=Math.min(a.r1,a.r2);if(g>0){var m=g/Math.max(a.r1,a.r2);for(n=0,r=l.length;n<r;n++)l[n].offset+=m*(1-l[n].offset)}}for(n=0,r=l.length;n<r;n++){var v=l[n];o.push("<stop ",'offset="',100*v.offset+"%",'" style="stop-color:',v.color,void 0!==v.opacity?";stop-opacity: "+v.opacity:";",'"/>\n')}return o.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),o.join("")},toLive:function(t){var e,i,n,r=T.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(r.x1,r.y1,r.x2,r.y2):"radial"===this.type&&(e=t.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2)),i=0,n=this.colorStops.length;i<n;i++){var o=this.colorStops[i].color,s=this.colorStops[i].opacity,a=this.colorStops[i].offset;void 0!==s&&(o=new T.Color(o).setAlpha(s).toRgba()),e.addColorStop(a,o)}return e}}}),T.util.object.extend(T.Gradient,{fromElement:function(e,n,r,o){var s=parseFloat(r)/(/%$/.test(r)?100:1);s=s<0?0:s>1?1:s,isNaN(s)&&(s=1);var a,l,c,u,h=e.getElementsByTagName("stop"),f="userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage",d=e.getAttribute("gradientTransform")||"",p=[],g=0,m=0;for("linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?(a="linear",l=function(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}(e)):(a="radial",l=function(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}(e)),c=h.length;c--;)p.push(t(h[c],s));return u=T.parseTransformAttribute(d),i(n,l,o,f),"pixels"===f&&(g=-n.left,m=-n.top),new T.Gradient({id:e.getAttribute("id"),type:a,coords:l,colorStops:p,gradientUnits:f,gradientTransform:u,offsetX:g,offsetY:m})},forObject:function(t,e){return e||(e={}),i(t,e.coords,e.gradientUnits,{viewBoxWidth:100,viewBoxHeight:100}),new T.Gradient(e)}})}(),function(){"use strict";var t=T.util.toFixed;T.Pattern=T.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=T.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)e&&e(this);else if(void 0!==T.util.getFunctionBody(t.source))this.source=new Function(T.util.getFunctionBody(t.source)),e&&e(this);else{var i=this;this.source=T.util.createImage(),T.util.loadImage(t.source,(function(t){i.source=t,e&&e(i)}),null,this.crossOrigin)}},toObject:function(e){var i,n,r=T.Object.NUM_FRACTION_DIGITS;return"function"==typeof this.source?i=String(this.source):"string"==typeof this.source.src?i=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(i=this.source.toDataURL()),n={type:"pattern",source:i,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,r),offsetY:t(this.offsetY,r),patternTransform:this.patternTransform?this.patternTransform.concat():null},T.util.populateWithProperties(this,n,e),n},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.width,n=e.height/t.height,r=this.offsetX/t.width,o=this.offsetY/t.height,s="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,o&&(n+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,r&&(i+=Math.abs(r))),e.src?s=e.src:e.toDataURL&&(s=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+o+'" width="'+i+'" height="'+n+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+s+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var i in"string"==typeof t&&(t=this._parseShadow(t)),t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),n=e.Shadow.reOffsetsAndBlur.exec(i)||[];return{color:(i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(n[1],10)||0,offsetY:parseInt(n[2],10)||0,blur:parseInt(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var n=40,r=40,o=e.Object.NUM_FRACTION_DIGITS,s=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),a=new e.Color(this.color);return t.width&&t.height&&(n=100*i((Math.abs(s.x)+this.blur)/t.width,o)+20,r=100*i((Math.abs(s.y)+this.blur)/t.height,o)+20),t.flipX&&(s.x*=-1),t.flipY&&(s.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" x="-'+n+'%" width="'+(100+2*n)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+i(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+i(s.x,o)+'" dy="'+i(s.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+a.toRgb()+'" flood-opacity="'+a.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var t={},i=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(e){this[e]!==i[e]&&(t[e]=this[e])}),this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){"use strict";if(T.StaticCanvas)T.warn("fabric.StaticCanvas is already defined.");else{var t=T.util.object.extend,e=T.util.getElementOffset,i=T.util.removeFromArray,n=T.util.toFixed,r=T.util.transformPoint,o=T.util.invertTransform,s=T.util.getNodeCanvas,a=T.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");T.StaticCanvas=T.util.createClass(T.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:T.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var i=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,i),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,i),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,i),e.overlayColor&&this.setOverlayColor(e.overlayColor,i),this.calcOffset()},_isRetinaScaling:function(){return 1!==T.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?T.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*T.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*T.devicePixelRatio),this.contextContainer.scale(T.devicePixelRatio,T.devicePixelRatio))},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,n){return"string"==typeof e?T.util.loadImage(e,(function(e){if(e){var r=new T.Image(e,n);this[t]=r,r.canvas=this}i&&i(e)}),this,n&&n.crossOrigin):(n&&e.setOptions(n),this[t]=e,e&&(e.canvas=this),i&&i(e)),this},__setBgOverlayColor:function(t,e,i){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,i),this},_createCanvasElement:function(){var t=a();if(!t)throw l;if(t.style||(t.style={}),void 0===t.getContext)throw l;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=T.util.getById(t)||this._createCanvasElement(),T.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;for(var n in e=e||{},t)i=t[n],e.cssOnly||(this._setBackstoreDimension(n,t[n]),i+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(n,i);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,i,n,r=this._activeObject;for(this.viewportTransform=t,i=0,n=this._objects.length;i<n;i++)(e=this._objects[i]).group||e.setCoords(!1,!0);return r&&"activeSelection"===r.type&&r.setCoords(!1,!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var i=t,n=this.viewportTransform.slice(0);t=r(t,o(this.viewportTransform)),n[0]=e,n[3]=e;var s=r(t,n);return n[4]+=i.x-s.x,n[5]+=i.y-s.y,this.setViewportTransform(n)},setZoom:function(t){return this.zoomToPoint(new T.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new T.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=T.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,i=this.height,n=o(this.viewportTransform);return t.tl=r({x:0,y:0},n),t.br=r({x:e,y:i},n),t.tr=new T.Point(t.br.x,t.tl.y),t.bl=new T.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(T.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var i=this.viewportTransform,n=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),this.fire("before:render",{ctx:t}),this.clipTo&&T.util.clipContext(this,t),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.clipTo&&t.restore(),n&&(n.canvas=this,n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,i=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var i,n;for(i=0,n=e.length;i<n;++i)e[i]&&e[i].render(t)},_renderBackgroundOrOverlay:function(t,e){var i=this[e+"Color"],n=this[e+"Image"],r=this.viewportTransform,o=this[e+"Vpt"];if(i||n){if(i){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=i.toLive?i.toLive(t,this):i,o&&t.transform(r[0],r[1],r[2],r[3],r[4]+(i.offsetX||0),r[5]+(i.offsetY||0));var s=i.gradientTransform||i.patternTransform;s&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),t.fill(),t.restore()}n&&(t.save(),o&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),n.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new T.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new T.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new T.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new T.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new T.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=o(this.viewportTransform);return r({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var n=this.clipPath,r={version:T.version,objects:this._toObjects(e,i)};return n&&(r.clipPath=this._toObject(this.clipPath,e,i)),t(r,this.__serializeBgOverlay(e,i)),T.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(i){return this._toObject(i,t,e)}),this)},_toObject:function(t,e,i){var n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);var r=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=n),r},__serializeBgOverlay:function(t,e){var i={},n=this.backgroundImage,r=this.overlayImage;return this.backgroundColor&&(i.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(i.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),n&&!n.excludeFromExport&&(i.backgroundImage=this._toObject(n,t,e)),r&&!r.excludeFromExport&&(i.overlayImage=this._toObject(r,t,e)),i},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={}),t.reviver=e;var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push("</g>\n"),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,r=e.width||this.width,o=e.height||this.height,s='viewBox="0 0 '+this.width+" "+this.height+'" ',a=T.Object.NUM_FRACTION_DIGITS;e.viewBox?s='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(i=this.viewportTransform,s='viewBox="'+n(-i[4]/i[0],a)+" "+n(-i[5]/i[3],a)+" "+n(this.width/i[0],a)+" "+n(this.height/i[3],a)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',o,'" ',s,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",T.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+T.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var t=this;return["background","overlay"].map((function(e){var i=t[e+"Color"];if(i&&i.toLive){var n=t[e+"Vpt"],r=t.viewportTransform,o={width:t.width/(n?r[0]:1),height:t.height/(n?r[3]:1)};return i.toSVG(o,{additionalTransform:n?T.util.matrixToSVG(r):""})}})).join("")},createSVGFontFacesMarkup:function(){var t,e,i,n,r,o,s,a,l="",c={},u=T.fontPaths,h=this._objects;for(s=0,a=h.length;s<a;s++)if(e=(t=h[s]).fontFamily,-1!==t.type.indexOf("text")&&!c[e]&&u[e]&&(c[e]=!0,t.styles))for(r in i=t.styles)for(o in n=i[r])!c[e=n[o].fontFamily]&&u[e]&&(c[e]=!0);for(var f in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",f,"';\n","\t\t\tsrc: url('",u[f],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(t,e){var i,n,r,o=this._objects;for(n=0,r=o.length;n<r;n++)(i=o[n]).excludeFromExport||this._setSVGObject(t,i,e)},_setSVGObject:function(t,e,i){t.push(e.toSVG(i))},_setSVGBgOverlayImage:function(t,e,i){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(i))},_setSVGBgOverlayColor:function(t,e){var i=this[e+"Color"],n=this.viewportTransform,r=this.width,o=this.height;if(i)if(i.toLive){var s=i.repeat,a=T.util.invertTransform(n),l=this[e+"Vpt"]?T.util.matrixToSVG(a):"";t.push('<rect transform="'+l+" translate(",r/2,",",o/2,')"',' x="',i.offsetX-r/2,'" y="',i.offsetY-o/2,'" ','width="',"repeat-y"===s||"no-repeat"===s?i.source.width:r,'" height="',"repeat-x"===s||"no-repeat"===s?i.source.height:o,'" fill="url(#SVGID_'+i.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,n,r,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(e=(r=o._objects).length;e--;)n=r[e],i(this._objects,n),this._objects.unshift(n);else i(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,n,r,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(r=o._objects,e=0;e<r.length;e++)n=r[e],i(this._objects,n),this._objects.push(n);else i(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var n,r,o,s,a,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(a=l._objects,n=0;n<a.length;n++)r=a[n],(o=this._objects.indexOf(r))>0+c&&(s=o-1,i(this._objects,r),this._objects.splice(s,0,r)),c++;else 0!==(o=this._objects.indexOf(t))&&(s=this._findNewLowerIndex(t,o,e),i(this._objects,t),this._objects.splice(s,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,i){var n,r;if(i)for(n=e,r=e-1;r>=0;--r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){n=r;break}}else n=e-1;return n},bringForward:function(t,e){if(!t)return this;var n,r,o,s,a,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(n=(a=l._objects).length;n--;)r=a[n],(o=this._objects.indexOf(r))<this._objects.length-1-c&&(s=o+1,i(this._objects,r),this._objects.splice(s,0,r)),c++;else(o=this._objects.indexOf(t))!==this._objects.length-1&&(s=this._findNewUpperIndex(t,o,e),i(this._objects,t),this._objects.splice(s,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,i){var n,r,o;if(i)for(n=e,r=e+1,o=this._objects.length;r<o;++r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){n=r;break}}else n=e+1;return n},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(T.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,T.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(T.StaticCanvas.prototype,T.Observable),t(T.StaticCanvas.prototype,T.Collection),t(T.StaticCanvas.prototype,T.DataURLExporter),t(T.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=a();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"setLineDash":return void 0!==i.setLineDash;default:return null}}}),T.StaticCanvas.prototype.toJSON=T.StaticCanvas.prototype.toObject,T.isLikelyNode&&(T.StaticCanvas.prototype.createPNGStream=function(){var t=s(this.lowerCanvasEl);return t&&t.createPNGStream()},T.StaticCanvas.prototype.createJPEGStream=function(t){var e=s(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),T.BaseBrush=T.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,setShadow:function(t){return this.shadow=new T.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,T.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop,e=this.canvas.getZoom();t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*e,t.shadowOffsetX=this.shadow.offsetX*e,t.shadowOffsetY=this.shadow.offsetY*e}},needsFullRender:function(){return new T.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),T.PencilBrush=T.util.createClass(T.BaseBrush,{decimate:.4,initialize:function(t){this.canvas=t,this._points=[]},_drawSegment:function(t,e,i){var n=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,n.x,n.y),n},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&this._captureDrawingPath(t)&&this._points.length>1)if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,n=i.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,i[n-2],i[n-1],!0),r.stroke(),r.restore()}},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){var e=new T.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1])||(this._points.push(t),0))},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new T.Point(t.x,t.y);return this._addPoint(e)},_render:function(){var t,e,i=this.canvas.contextTop,n=this._points[0],r=this._points[1];if(this._saveAndTransform(i),i.beginPath(),2===this._points.length&&n.x===r.x&&n.y===r.y){var o=this.width/1e3;n=new T.Point(n.x,n.y),r=new T.Point(r.x,r.y),n.x-=o,r.x+=o}for(i.moveTo(n.x,n.y),t=1,e=this._points.length;t<e;t++)this._drawSegment(i,n,r),n=this._points[t],r=this._points[t+1];i.lineTo(n.x,n.y),i.stroke(),i.restore()},convertPointsToSVGPath:function(t){var e,i=[],n=this.width/1e3,r=new T.Point(t[0].x,t[0].y),o=new T.Point(t[1].x,t[1].y),s=t.length,a=1,l=0,c=s>2;for(c&&(a=t[2].x<o.x?-1:t[2].x===o.x?0:1,l=t[2].y<o.y?-1:t[2].y===o.y?0:1),i.push("M ",r.x-a*n," ",r.y-l*n," "),e=1;e<s;e++){if(!r.eq(o)){var u=r.midPointFrom(o);i.push("Q ",r.x," ",r.y," ",u.x," ",u.y," ")}r=t[e],e+1<t.length&&(o=t[e+1])}return c&&(a=r.x>t[e-2].x?1:r.x===t[e-2].x?0:-1,l=r.y>t[e-2].y?1:r.y===t[e-2].y?0:-1),i.push("L ",r.x+a*n," ",r.y+l*n),i},createPath:function(t){var e=new T.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var i,n=this.canvas.getZoom(),r=Math.pow(e/n,2),o=t.length-1,s=t[0],a=[s];for(i=1;i<o;i++)Math.pow(s.x-t[i].x,2)+Math.pow(s.y-t[i].y,2)>=r&&(s=t[i],a.push(s));return 1===a.length&&a.push(new T.Point(a[0].x,a[0].y)),a},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"!==t){var e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.add(e),this.canvas.renderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}else this.canvas.requestRenderAll()}}),T.CircleBrush=T.util.createClass(T.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,e),i.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,i=this.canvas.contextTop,n=this.points;for(this._saveAndTransform(i),t=0,e=n.length;t<e;t++)this.dot(i,n[t]);i.restore()},onMouseMove:function(t){this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t)},onMouseUp:function(){var t,e,i=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var n=[];for(t=0,e=this.points.length;t<e;t++){var r=this.points[t],o=new T.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&o.setShadow(this.shadow),n.push(o)}var s=new T.Group(n);s.canvas=this.canvas,this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=i,this.canvas.requestRenderAll()},addPoint:function(t){var e=new T.Point(t.x,t.y),i=T.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,n=new T.Color(this.color).setAlpha(T.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=n,this.points.push(e),e}}),T.SprayBrush=T.util.createClass(T.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.sprayChunks.length;i<n;i++)for(var r=this.sprayChunks[i],o=0,s=r.length;o<s;o++){var a=new T.Rect({width:r[o].width,height:r[o].width,left:r[o].x+1,top:r[o].y+1,originX:"center",originY:"center",fill:this.color});e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new T.Group(e);this.shadow&&l.setShadow(this.shadow),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,i,n,r={};for(i=0,n=t.length;i<n;i++)r[e=t[i].left+""+t[i].top]||(r[e]=t[i]);var o=[];for(e in r)o.push(r[e]);return o},render:function(t){var e,i,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),e=0,i=t.length;e<i;e++){var r=t[e];void 0!==r.opacity&&(n.globalAlpha=r.opacity),n.fillRect(r.x,r.y,r.width,r.width)}n.restore()},_render:function(){var t,e,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);i.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,i,n,r,o=this.width/2;for(r=0;r<this.density;r++){e=T.util.getRandomInt(t.x-o,t.x+o),i=T.util.getRandomInt(t.y-o,t.y+o),n=this.dotWidthVariance?T.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var s=new T.Point(e,i);s.width=n,this.randomOpacity&&(s.opacity=T.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),T.PatternBrush=T.util.createClass(T.PencilBrush,{getPatternSrc:function(){var t=T.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),i=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new T.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),e}}),function(){var t=T.util.getPointer,e=T.util.degreesToRadians,i=T.util.radiansToDegrees,n=Math.atan2,r=Math.abs,o=T.StaticCanvas.supports("setLineDash");for(var s in T.Canvas=T.util.createClass(T.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=T.PencilBrush&&new T.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,i,n=this.getActiveObjects();if(n.length>0&&!this.preserveObjectStacking){e=[],i=[];for(var r=0,o=this._objects.length;r<o;r++)t=this._objects[r],-1===n.indexOf(t)?e.push(t):i.push(t);n.length>1&&(this._activeObject._objects=i),e.push.apply(e,i)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_resetCurrentTransform:function(){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,skewX:t.original.skewX,skewY:t.original.skewY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(t.target)?("center"!==t.originX&&("right"===t.originX?t.mouseXSign=-1:t.mouseXSign=1),"center"!==t.originY&&("bottom"===t.originY?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(t,e,i){var n,r=i||this.getPointer(t,!0);return n=e.group&&e.group===this._activeObject&&"activeSelection"===e.group.type?this._normalizePointer(e.group,r):{x:r.x,y:r.y},e.containsPoint(n)||e._findTargetCorner(r)},_normalizePointer:function(t,e){var i=t.calcTransformMatrix(),n=T.util.invertTransform(i),r=this.restorePointerVpt(e);return T.util.transformPoint(r,n)},isTargetTransparent:function(t,e,i){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var n=this._normalizePointer(t,{x:e,y:i}),r=Math.max(t.cacheTranslationX+n.x*t.zoomX,0),o=Math.max(t.cacheTranslationY+n.y*t.zoomY,0);return T.util.isTransparent(t._cacheContext,Math.round(r),Math.round(o),this.targetFindTolerance)}var s=this.contextCache,a=t.selectionBackgroundColor,l=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(s),s.save(),s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.render(s),s.restore(),t===this._activeObject&&t._renderControls(s,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=a,T.util.isTransparent(s,e,i,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var i=this.getActiveObjects(),n=this._activeObject;return!e||e&&n&&i.length>1&&-1===i.indexOf(e)&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e},_shouldCenterTransform:function(t){if(t){var e,i=this._currentTransform;return"scale"===i.action||"scaleX"===i.action||"scaleY"===i.action?e=this.centeredScaling||t.centeredScaling:"rotate"===i.action&&(e=this.centeredRotation||t.centeredRotation),e?!i.altKey:i.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},_getActionFromCorner:function(t,e,i){if(!e||!t)return"drag";switch(e){case"mtr":return"rotate";case"ml":case"mr":return i[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return i[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(t,i,n){if(i){var r=this.getPointer(t),o=i._findTargetCorner(this.getPointer(t,!0)),s=this._getActionFromCorner(n,o,t,i),a=this._getOriginFromCorner(i,o);this._currentTransform={target:i,action:s,corner:o,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:a.x,originY:a.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey],original:T.util.saveObjectTransform(i)},this._currentTransform.original.originX=a.x,this._currentTransform.original.originY=a.y,this._resetCurrentTransform(),this._beforeTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform,n=i.target,r=t-i.offsetX,o=e-i.offsetY,s=!n.get("lockMovementX")&&n.left!==r,a=!n.get("lockMovementY")&&n.top!==o;return s&&n.set("left",r),a&&n.set("top",o),s||a},_changeSkewTransformOrigin:function(t,e,i){var n="originX",r={0:"center"},o=e.target.skewX,s="left",a="right",l="mt"===e.corner||"ml"===e.corner?1:-1,c=1;t=t>0?1:-1,"y"===i&&(o=e.target.skewY,s="top",a="bottom",n="originY"),r[-1]=s,r[1]=a,e.target.flipX&&(c*=-1),e.target.flipY&&(c*=-1),0===o?(e.skewSign=-l*t*c,e[n]=r[-t]):(o=o>0?1:-1,e.skewSign=o,e[n]=r[o*l*c])},_skewObject:function(t,e,i){var n,r=this._currentTransform,o=r.target,s=o.get("lockSkewingX"),a=o.get("lockSkewingY");if(s&&"x"===i||a&&"y"===i)return!1;var l,c,u=o.getCenterPoint(),h=o.toLocalPoint(new T.Point(t,e),"center","center")[i],f=o.toLocalPoint(new T.Point(r.lastX,r.lastY),"center","center")[i],d=o._getTransformedDimensions();return this._changeSkewTransformOrigin(h-f,r,i),l=o.toLocalPoint(new T.Point(t,e),r.originX,r.originY)[i],c=o.translateToOriginPoint(u,r.originX,r.originY),n=this._setObjectSkew(l,r,i,d),r.lastX=t,r.lastY=e,o.setPositionByOrigin(c,r.originX,r.originY),n},_setObjectSkew:function(t,e,i,n){var r,o,s,a,l,c,u,h,f,d,p=e.target,g=e.skewSign;return"x"===i?(l="y",c="Y",u="X",f=0,d=p.skewY):(l="x",c="X",u="Y",f=p.skewX,d=0),a=p._getTransformedDimensions(f,d),(h=2*Math.abs(t)-a[i])<=2?r=0:(r=g*Math.atan(h/p["scale"+u]/(a[l]/p["scale"+c])),r=T.util.radiansToDegrees(r)),o=p["skew"+u]!==r,p.set("skew"+u,r),0!==p["skew"+c]&&(s=p._getTransformedDimensions(),r=n[l]/s[l]*p["scale"+c],p.set("scale"+c,r)),o},_scaleObject:function(t,e,i){var n=this._currentTransform,r=n.target,o=r.lockScalingX,s=r.lockScalingY,a=r.lockScalingFlip;if(o&&s)return!1;var l,c=r.translateToOriginPoint(r.getCenterPoint(),n.originX,n.originY),u=r.toLocalPoint(new T.Point(t,e),n.originX,n.originY),h=r._getTransformedDimensions();return this._setLocalMouse(u,n),l=this._setObjectScale(u,n,o,s,i,a,h),r.setPositionByOrigin(c,n.originX,n.originY),l},_setObjectScale:function(t,e,i,n,r,o,s){var a=e.target,l=!1,c=!1,u=!1,h=t.x*a.scaleX/s.x,f=t.y*a.scaleY/s.y,d=a.scaleX!==h,p=a.scaleY!==f;if(e.newScaleX=h,e.newScaleY=f,"x"===r&&a instanceof T.Textbox){var g=a.width*(t.x/s.x);return g>=a.getMinWidth()&&(u=g!==a.width,a.set("width",g),u)}return o&&h<=0&&h<a.scaleX&&(l=!0,t.x=0),o&&f<=0&&f<a.scaleY&&(c=!0,t.y=0),"equally"!==r||i||n?r?"x"!==r||a.get("lockUniScaling")?"y"!==r||a.get("lockUniScaling")||c||n||a.set("scaleY",f)&&(u=p):l||i||a.set("scaleX",h)&&(u=d):(l||i||a.set("scaleX",h)&&(u=u||d),c||n||a.set("scaleY",f)&&(u=u||p)):u=this._scaleObjectEqually(t,a,e,s),l||c||this._flipObject(e,r),u},_scaleObjectEqually:function(t,e,i,n){var r,o,s,a=t.y+t.x,l=n.y*i.original.scaleY/e.scaleY+n.x*i.original.scaleX/e.scaleX,c=t.x<0?-1:1,u=t.y<0?-1:1;return o=c*Math.abs(i.original.scaleX*a/l),s=u*Math.abs(i.original.scaleY*a/l),r=o!==e.scaleX||s!==e.scaleY,e.set("scaleX",o),e.set("scaleY",s),r},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target,n=this.getZoom(),o=i.padding/n;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),r(t.x)>o?t.x<0?t.x+=o:t.x-=o:t.x=0,r(t.y)>o?t.y<0?t.y+=o:t.y-=o:t.y=0},_rotateObject:function(t,e){var r=this._currentTransform,o=r.target,s=o.translateToOriginPoint(o.getCenterPoint(),r.originX,r.originY);if(o.lockRotation)return!1;var a=n(r.ey-s.y,r.ex-s.x),l=n(e-s.y,t-s.x),c=i(l-a+r.theta),u=!0;if(o.snapAngle>0){var h=o.snapAngle,f=o.snapThreshold||h,d=Math.ceil(c/h)*h,p=Math.floor(c/h)*h;Math.abs(c-p)<f?c=p:Math.abs(c-d)<f&&(c=d)}return c<0&&(c=360+c),c%=360,o.angle===c?u=!1:(o.angle=c,o.setPositionByOrigin(s,r.originX,r.originY)),u},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,i=e.left,n=e.top,s=r(i),a=r(n);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(n>0?0:-n),s,a)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!o){var l=e.ex+.5-(i>0?0:s),c=e.ey+.5-(n>0?0:a);t.beginPath(),T.util.drawDashedLine(t,l,c,l+s,c,this.selectionDashArray),T.util.drawDashedLine(t,l,c+a-1,l+s,c+a-1,this.selectionDashArray),T.util.drawDashedLine(t,l,c,l,c+a,this.selectionDashArray),T.util.drawDashedLine(t,l+s-1,c,l+s-1,c+a,this.selectionDashArray),t.closePath(),t.stroke()}else T.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+.5-(i>0?0:s),e.ey+.5-(n>0?0:a),s,a)},findTarget:function(t,e){if(!this.skipTargetFind){var i,n,r=this.getPointer(t,!0),o=this._activeObject,s=this.getActiveObjects();if(this.targets=[],s.length>1&&!e&&o===this._searchPossibleTargets([o],r))return o;if(1===s.length&&o._findTargetCorner(r))return o;if(1===s.length&&o===this._searchPossibleTargets([o],r)){if(!this.preserveObjectStacking)return o;i=o,n=this.targets,this.targets=[]}var a=this._searchPossibleTargets(this._objects,r);return t[this.altSelectionKey]&&a&&i&&a!==i&&(a=i,this.targets=n),a}},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(null,e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,i.x,i.y))return!0}},_searchPossibleTargets:function(t,e){for(var i,n,r=t.length;r--;){var o=t[r],s=o.group&&"activeSelection"!==o.group.type?this._normalizePointer(o.group,e):e;if(this._checkTarget(s,o,e)){(i=t[r]).subTargetCheck&&i instanceof T.Group&&(n=this._searchPossibleTargets(i._objects,e))&&this.targets.push(n);break}}return i},restorePointerVpt:function(t){return T.util.transformPoint(t,T.util.invertTransform(this.viewportTransform))},getPointer:function(e,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var n,r=t(e),o=this.upperCanvasEl,s=o.getBoundingClientRect(),a=s.width||0,l=s.height||0;return a&&l||("top"in s&&"bottom"in s&&(l=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,i||(r=this.restorePointerVpt(r)),n=0===a||0===l?{width:1,height:1}:{width:o.width/a,height:o.height/l},{x:r.x*n.width,y:r.y*n.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl?this.upperCanvasEl.className="":this.upperCanvasEl=this._createCanvasElement(),T.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=T.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),T.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),T.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,i=this.height||t.height;T.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=i,T.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),this._hoveredTarget===t&&(this._hoveredTarget=null),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var i=!1,n=this.getActiveObjects(),r=[],o=[],s={e:e};t.forEach((function(t){-1===n.indexOf(t)&&(i=!0,t.fire("deselected",s),o.push(t))})),n.forEach((function(e){-1===t.indexOf(e)&&(i=!0,e.fire("selected",s),r.push(e))})),t.length>0&&n.length>0?(s.selected=r,s.deselected=o,s.updated=r[0]||o[0],s.target=this._activeObject,i&&this.fire("selection:updated",s)):n.length>0?(1===n.length&&(s.target=r[0],this.fire("object:selected",s)),s.selected=r,s.target=this._activeObject,this.fire("selection:created",s)):t.length>0&&(s.deselected=o,this.fire("selection:cleared",s))},setActiveObject:function(t,e){var i=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(i,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&(!!this._discardActiveObject(e,t)&&(!t.onSelect({e:e})&&(this._activeObject=t,!0)))},_discardActiveObject:function(t,e){var i=this._activeObject;if(i){if(i.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),i=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:i,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){T.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,T.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(t),r=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,n),r},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(i){e[i]=t[i]})),this._activeObject.realizeTransform(t),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,n)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),T.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),T.StaticCanvas)"prototype"!==s&&(T.Canvas[s]=T.StaticCanvas[s])}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=T.util.addListener,i=T.util.removeListener,n={passive:!1};function r(t,e){return t.button&&t.button===e-1}T.util.object.extend(T.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var i=this.upperCanvasEl,r=this._getEventPrefix();t(T.window,"resize",this._onResize),t(i,r+"down",this._onMouseDown),t(i,r+"move",this._onMouseMove,n),t(i,r+"out",this._onMouseOut),t(i,r+"enter",this._onMouseEnter),t(i,"wheel",this._onMouseWheel),t(i,"contextmenu",this._onContextMenu),t(i,"dblclick",this._onDoubleClick),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,n),"undefined"!=typeof eventjs&&e in eventjs&&(eventjs[e](i,"gesture",this._onGesture),eventjs[e](i,"drag",this._onDrag),eventjs[e](i,"orientation",this._onOrientationChange),eventjs[e](i,"shake",this._onShake),eventjs[e](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(i,"remove");var t=this._getEventPrefix();i(T.document,t+"up",this._onMouseUp),i(T.document,"touchend",this._onTouchEnd,n),i(T.document,t+"move",this._onMouseMove,n),i(T.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t}),this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){this.currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||(!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(t){t.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();e(T.document,"touchend",this._onTouchEnd,n),e(T.document,"touchmove",this._onMouseMove,n),i(r,o+"down",this._onMouseDown)},_onMouseDown:function(t){this.__onMouseDown(t),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();i(r,o+"move",this._onMouseMove,n),e(T.document,o+"up",this._onMouseUp),e(T.document,o+"move",this._onMouseMove,n)},_onTouchEnd:function(t){if(!(t.touches.length>0)){this.__onMouseUp(t),this._resetTransformEventData(),this.mainTouchId=null;var r=this._getEventPrefix();i(T.document,"touchend",this._onTouchEnd,n),i(T.document,"touchmove",this._onMouseMove,n);var o=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){e(o.upperCanvasEl,r+"down",o._onMouseDown),o._willAddMouseDown=0}),400)}},_onMouseUp:function(t){this.__onMouseUp(t),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();this._isMainEvent(t)&&(i(T.document,o+"up",this._onMouseUp),i(T.document,o+"move",this._onMouseMove,n),e(r,o+"move",this._onMouseMove,n))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,i=this._currentTransform,n=this._groupSelector,o=!1,s=!n||0===n.left&&0===n.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),!r(t,3))return r(t,2)?(this.fireMiddleClick&&this._handleEvent(t,"up",2,s),void this._resetTransformEventData()):void(this.isDrawingMode&&this._isCurrentlyDrawing?this._onMouseUpInDrawingMode(t):this._isMainEvent(t)&&(i&&(this._finalizeCurrentTransform(t),o=i.actionPerformed),s||(this._maybeGroupObjects(t),o||(o=this._shouldRender(e))),e&&(e.isMoving=!1),this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,s),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),o?this.requestRenderAll():s||this.renderTop()));this.fireRightClick&&this._handleEvent(t,"up",3,s)},_simpleEventHandler:function(t,e){var i=this.findTarget(e),n=this.targets,r={e:e,target:i,subTargets:n};if(this.fire(t,r),i&&i.fire(t,r),!n)return i;for(var o=0;o<n.length;o++)n[o].fire(t,r);return i},_handleEvent:function(t,e,i,n){var r=this._target,o=this.targets||[],s={e:t,target:r,subTargets:o,button:i||1,isClick:n||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};this.fire("mouse:"+e,s),r&&r.fire("mouse"+e,s);for(var a=0;a<o.length;a++)o[a].fire("mouse"+e,s)},_finalizeCurrentTransform:function(t){var e,i=this._currentTransform,n=i.target,r={e:t,target:n,transform:i};n._scaling&&(n._scaling=!1),n.setCoords(),(i.actionPerformed||this.stateful&&n.hasStateChanged())&&(i.actionPerformed&&(e=this._addEventOptions(r,i),this._fire(e,r)),this._fire("modified",r))},_addEventOptions:function(t,e){var i,n;switch(e.action){case"scaleX":i="scaled",n="x";break;case"scaleY":i="scaled",n="y";break;case"skewX":i="skewed",n="x";break;case"skewY":i="skewed",n="y";break;case"scale":i="scaled",n="equally";break;case"rotate":i="rotated";break;case"drag":i="moved"}return t.by=n,i},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll(),this.clipTo&&T.util.clipContext(this,this.contextTop);var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){this.clipTo&&this.contextTop.restore();var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(r(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(r(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var i=this._pointer;this._previousPointer=i;var n=this._shouldRender(e),o=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):o&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0}),e){var s=e===this._activeObject;e.selectable&&this.setActiveObject(e,t),e!==this._activeObject||!e.__corner&&o||this._setupCurrentTransform(t,e,s)}this._handleEvent(t,"down"),(n||o)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e}),e.corner&&this.onBeforeScaleRotate(e.target)},__onMouseMove:function(t){var e,i;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var n=this._groupSelector;n?(i=this._pointer,n.left=i.x-n.ex,n.top=i.y-n.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){this.fireSyntheticInOutEvents(t,e,{targetName:"_hoveredTarget",canvasEvtOut:"mouse:out",evtOut:"mouseout",canvasEvtIn:"mouse:over",evtIn:"mouseover"})},_fireEnterLeaveEvents:function(t,e){this.fireSyntheticInOutEvents(t,e,{targetName:"_draggedoverTarget",evtOut:"dragleave",evtIn:"dragenter"})},fireSyntheticInOutEvents:function(t,e,i){var n,r,o,s=this[i.targetName],a=s!==t,l=i.canvasEvtIn,c=i.canvasEvtOut;a&&(n={e:e,target:t,previousTarget:s},r={e:e,target:s,nextTarget:t},this[i.targetName]=t),o=t&&a,s&&a&&(c&&this.fire(c,r),s.fire(i.evtOut,r)),o&&(l&&this.fire(l,n),t.fire(i.evtIn,n))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,i.shiftKey=t.shiftKey,i.altKey=t[this.centeredKey],this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),i.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,i){var n=i.x,r=i.y,o=e.action,s=!1,a={target:e.target,e:t,transform:e,pointer:i};"rotate"===o?(s=this._rotateObject(n,r))&&this._fire("rotating",a):"scale"===o?(s=this._onScale(t,e,n,r))&&this._fire("scaling",a):"scaleX"===o?(s=this._scaleObject(n,r,"x"))&&this._fire("scaling",a):"scaleY"===o?(s=this._scaleObject(n,r,"y"))&&this._fire("scaling",a):"skewX"===o?(s=this._skewObject(n,r,"x"))&&this._fire("skewing",a):"skewY"===o?(s=this._skewObject(n,r,"y"))&&this._fire("skewing",a):(s=this._translateObject(n,r))&&(this._fire("moving",a),this.setCursor(a.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||s},_fire:function(t,e){this.fire("object:"+t,e),e.target.fire(t,e)},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(t,e,i,n){return this._isUniscalePossible(t,e.target)?(e.currentAction="scale",this._scaleObject(i,n)):(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(i,n,"equally"))},_isUniscalePossible:function(t,e){return(t[this.uniScaleKey]||this.uniScaleTransform)&&!e.get("lockUniScaling")},_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor,n=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,r=(!n||!n.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));r?this.setCursor(this.getCornerCursor(r,e,t)):this.setCursor(i)},getCornerCursor:function(e,i,n){return this.actionIsDisabled(e,i,n)?this.notAllowedCursor:e in t?this._getRotatedCornerCursor(e,i,n):"mtr"===e&&i.hasRotatingPoint?this.rotationCursor:this.defaultCursor},actionIsDisabled:function(t,e,i){return"mt"===t||"mb"===t?i[this.altActionKey]?e.lockSkewingX:e.lockScalingY:"ml"===t||"mr"===t?i[this.altActionKey]?e.lockSkewingY:e.lockScalingX:"mtr"===t?e.lockRotation:this._isUniscalePossible(i,e)?e.lockScalingX&&e.lockScalingY:e.lockScalingX||e.lockScalingY},_getRotatedCornerCursor:function(e,i,n){var r=Math.round(i.angle%360/45);return r<0&&(r+=8),r+=t[e],n[this.altActionKey]&&t[e]%2==0&&(r+=2),r%=8,this.cursorMap[r]}})}(),m=Math.min,v=Math.max,T.util.object.extend(T.Canvas.prototype,{_shouldGroup:function(t,e){var i=this._activeObject;return i&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(i!==e||"activeSelection"===i.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var i=this._activeObject;i.__corner||(e!==i||(e=this.findTarget(t,!0))&&e.selectable)&&(i&&"activeSelection"===i.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var i=this._activeObject,n=i._objects.slice(0);i.contains(t)?(i.removeWithUpdate(t),this._hoveredTarget=t,1===i.size()&&this._setActiveObject(i.item(0),e)):(i.addWithUpdate(t),this._hoveredTarget=i),this._fireSelectionEvents(n,e)},_createActiveSelection:function(t,e){var i=this.getActiveObjects(),n=this._createGroup(t);this._hoveredTarget=n,this._setActiveObject(n,e),this._fireSelectionEvents(i,e)},_createGroup:function(t){var e=this._objects,i=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new T.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(t){var e,i=this._collectObjects(t);1===i.length?this.setActiveObject(i[0],t):i.length>1&&(e=new T.ActiveSelection(i.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(t){for(var e,i=[],n=this._groupSelector.ex,r=this._groupSelector.ey,o=n+this._groupSelector.left,s=r+this._groupSelector.top,a=new T.Point(m(n,o),m(r,s)),l=new T.Point(v(n,o),v(r,s)),c=!this.selectionFullyContained,u=n===o&&r===s,h=this._objects.length;h--&&!((e=this._objects[h])&&e.selectable&&e.visible&&(c&&e.intersectsWithRect(a,l)||e.isContainedWithinRect(a,l)||c&&e.containsPoint(a)||c&&e.containsPoint(l))&&(i.push(e),u)););return i.length>1&&(i=i.filter((function(e){return!e.onSelect({e:t})}))),i},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}}),T.util.object.extend(T.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,n=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(n,t);return T.util.toDataURL(r,e,i)},toCanvasElement:function(t,e){t=t||1;var i=((e=e||{}).width||this.width)*t,n=(e.height||this.height)*t,r=this.getZoom(),o=this.width,s=this.height,a=r*t,l=this.viewportTransform,c=(l[4]-(e.left||0))*t,u=(l[5]-(e.top||0))*t,h=this.interactive,f=[a,0,0,a,c,u],d=this.enableRetinaScaling,p=T.util.createCanvasElement(),g=this.contextTop;return p.width=i,p.height=n,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=i,this.height=n,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=l,this.width=o,this.height=s,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=d,this.contextTop=g,p}}),T.util.object.extend(T.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var n="string"==typeof t?JSON.parse(t):T.util.object.clone(t),r=this,o=n.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete n.clipPath,this._enlivenObjects(n.objects,(function(t){r.clear(),r._setBgOverlay(n,(function(){o?r._enlivenObjects([o],(function(i){r.clipPath=i[0],r.__setupCanvas.call(r,n,t,s,e)})):r.__setupCanvas.call(r,n,t,s,e)}))}),i),this}},__setupCanvas:function(t,e,i,n){var r=this;e.forEach((function(t,e){r.insertAt(t,e)})),this.renderOnAddRemove=i,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),n&&n()},_setBgOverlay:function(t,e){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var n=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,i,n),this.__setBgOverlay("overlayImage",t.overlayImage,i,n),this.__setBgOverlay("backgroundColor",t.background,i,n),this.__setBgOverlay("overlayColor",t.overlay,i,n)}else e&&e()},__setBgOverlay:function(t,e,i,n){var r=this;if(!e)return i[t]=!0,void(n&&n());"backgroundImage"===t||"overlayImage"===t?T.util.enlivenObjects([e],(function(e){r[t]=e[0],i[t]=!0,n&&n()})):this["set"+T.util.string.capitalize(t,!0)](e,(function(){i[t]=!0,n&&n()}))},_enlivenObjects:function(t,e,i){t&&0!==t.length?T.util.enlivenObjects(t,(function(t){e&&e(t)}),null,i):e&&e([])},_toDataURL:function(t,e){this.clone((function(i){e(i.toDataURL(t))}))},_toDataURLWithMultiplier:function(t,e,i){this.clone((function(n){i(n.toDataURLWithMultiplier(t,e))}))},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData((function(e){e.loadFromJSON(i,(function(){t&&t(e)}))}))},cloneWithoutData:function(t){var e=T.util.createCanvasElement();e.width=this.width,e.height=this.height;var i=new T.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,(function(){i.renderAll(),t&&t(i)})),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,r=e.util.toFixed,o=e.util.string.capitalize,s=e.util.degreesToRadians,a=e.StaticCanvas.supports("setLineDash"),l=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:l,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var i=e.perfLimitSizeTotal,n=t.width,r=t.height,o=e.maxCacheSideLimit,s=e.minCacheSideLimit;if(n<=o&&r<=o&&n*r<=i)return n<s&&(t.width=s),r<s&&(t.height=s),t;var a=n/r,l=e.util.limitDimsByArea(a,i),c=e.util.capValue,u=c(s,l.x,o),h=c(s,l.y,o);return n>u&&(t.zoomX/=n/u,t.width=u,t.capped=!0),r>h&&(t.zoomY/=r/h,t.height=h,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),i=e.x*t.scaleX/this.scaleX,n=e.y*t.scaleY/this.scaleY;return{width:i+2,height:n+2,zoomX:t.scaleX,zoomY:t.scaleY,x:i,y:n}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var i=t._currentTransform.target,n=t._currentTransform.action;if(this===i&&n.slice&&"scale"===n.slice(0,5))return!1}var r,o,s=this._cacheCanvas,a=this._limitCacheSize(this._getCacheCanvasDimensions()),l=e.minCacheSideLimit,c=a.width,u=a.height,h=a.zoomX,f=a.zoomY,d=c!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==f,g=d||p,m=0,v=0,y=!1;if(d){var _=this._cacheCanvas.width,b=this._cacheCanvas.height,w=c>_||u>b;y=w||(c<.9*_||u<.9*b)&&_>l&&b>l,w&&!a.capped&&(c>l||u>l)&&(m=.1*c,v=.1*u)}return!!g&&(y?(s.width=Math.ceil(c+m),s.height=Math.ceil(u+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,s.width,s.height)),r=a.x/2,o=a.y/2,this.cacheTranslationX=Math.round(s.width/2-r)+r,this.cacheTranslationY=Math.round(s.height/2-o)+o,this.cacheWidth=c,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,f),this.zoomX=h,this.zoomY=f,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initClipping(t),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e;e=this.group&&!this.group._transformDone?this.calcTransformMatrix():this.calcOwnMatrix(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,n={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.angle,i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():null,skewX:r(this.skewX,i),skewY:r(this.skewY,i)};return this.clipPath&&(n.clipPath=this.clipPath.toObject(t),n.clipPath.inverted=this.clipPath.inverted,n.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,n,t),this.includeDefaultValues||(n=this._removeDefaultValues(n)),n},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype;return i.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===i[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(i[e])&&0===t[e].length&&0===i[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var i=this.group.getObjectScaling();t*=i.scaleX,e*=i.scaleY}return{scaleX:t,scaleY:e}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,i=t.scaleY;if(this.canvas){var n=this.canvas.getZoom(),r=this.canvas.getRetinaScaling();e*=n*r,i*=n*r}return{scaleX:e,scaleY:i}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,i){var n="scaleX"===t||"scaleY"===t,r=this[t]!==i,o=!1;return n&&(i=this._constrainScale(i)),"scaleX"===t&&i<0?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&i<0?(this.flipY=!this.flipY,i*=-1):"shadow"!==t||!i||i instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",i):i=new e.Shadow(i),this[t]=i,r&&(o=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||0===this.width&&0===this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.clipTo&&e.util.clipContext(this,t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),this.clipTo&&t.restore(),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var i=this.clipPath;if(t.save(),i.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",i.absolutePositioned){var n=e.util.invertTransform(this.calcTransformMatrix());t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},drawObject:function(t,e){var i=this.fill,n=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):(this._renderBackground(t),this._setStrokeStyles(t,this),this._setFillStyles(t,this)),this._render(t),this._drawClipPath(t),this.fill=i,this.stroke=n},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-i/2,e,i)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){e.stroke&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,t.strokeStyle=e.stroke.toLive?e.stroke.toLive(t,this):e.stroke)},_setFillStyles:function(t,e){e.fill&&(t.fillStyle=e.fill.toLive?e.fill.toLive(t,this):e.fill)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e,i){e&&(1&e.length&&e.push.apply(e,e),a?t.setLineDash(e):i&&i(t),this.strokeUniform&&t.setLineDash(t.getLineDash().map((function(e){return e*t.lineWidth}))))},_renderControls:function(t,i){var n,r,o,a=this.getViewportTransform(),l=this.calcTransformMatrix();r=void 0!==(i=i||{}).hasBorders?i.hasBorders:this.hasBorders,o=void 0!==i.hasControls?i.hasControls:this.hasControls,l=e.util.multiplyTransformMatrices(a,l),n=e.util.qrDecompose(l),t.save(),t.translate(n.translateX,n.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),i.forActiveSelection?(t.rotate(s(n.angle)),r&&this.drawBordersInGroup(t,n,i)):(t.rotate(s(this.angle)),r&&this.drawBorders(t,i)),o&&this.drawControls(t,i),t.restore()},_setShadow:function(t){if(this.shadow){var i,n=this.shadow,r=this.canvas,o=r&&r.viewportTransform[0]||1,s=r&&r.viewportTransform[3]||1;i=n.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),r&&r._isRetinaScaling()&&(o*=e.devicePixelRatio,s*=e.devicePixelRatio),t.shadowColor=n.color,t.shadowBlur=n.blur*e.browserShadowBlurConstant*(o+s)*(i.scaleX+i.scaleY)/4,t.shadowOffsetX=n.offsetX*o*i.scaleX,t.shadowOffsetY=n.offsetY*s*i.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var i=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,r=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,n,r):t.transform(1,0,0,1,n,r),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:n,offsetY:r}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._applyPatternGradientTransform(t,this.fill),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this.stroke.toLive&&"percentage"===this.stroke.gradientUnits?this._applyPatternForTransformedGradient(t,this.stroke):this._applyPatternGradientTransform(t,this.stroke),t.stroke(),t.restore())},_applyPatternForTransformedGradient:function(t,i){var n,r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=e.util.createCanvasElement(),s=this.canvas.getRetinaScaling(),a=r.x/this.scaleX/s,l=r.y/this.scaleY/s;o.width=a,o.height=l,(n=o.getContext("2d")).beginPath(),n.moveTo(0,0),n.lineTo(a,0),n.lineTo(a,l),n.lineTo(0,l),n.closePath(),n.translate(a/2,l/2),n.scale(r.zoomX/this.scaleX/s,r.zoomY/this.scaleY/s),this._applyPatternGradientTransform(n,i),n.fillStyle=i.toLive(t),n.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(s*this.scaleX/r.zoomX,s*this.scaleY/r.zoomY),t.strokeStyle=n.createPattern(o,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var i=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),i=e.util.transformPoint(i,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,i.x+=t.offsetLeft,i.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(i,"center","center")},clone:function(t,i){var n=this.toObject(i);this.constructor.fromObject?this.constructor.fromObject(n,t):e.Object._fromObject("Object",n,t)},cloneAsImage:function(t,i){var n=this.toCanvasElement(i);return t&&t(new e.Image(n)),this},toCanvasElement:function(t){t||(t={});var i=e.util,n=i.saveObjectTransform(this),r=this.shadow,o=Math.abs,s=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);t.withoutTransform&&i.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var a,l,c=e.util.createCanvasElement(),u=this.getBoundingRect(!0,!0),h=this.shadow,f={x:0,y:0};h&&(l=h.blur,a=h.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),f.x=2*Math.round(o(h.offsetX)+l)*o(a.scaleX),f.y=2*Math.round(o(h.offsetY)+l)*o(a.scaleY)),c.width=u.width+f.x,c.height=u.height+f.y,c.width+=c.width%2?2-c.width%2:0,c.height+=c.height%2?2-c.height%2:0;var d=new e.StaticCanvas(c,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(d.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(d.width/2,d.height/2),"center","center");var p=this.canvas;d.add(this);var g=d.toCanvasElement(s||1,t);return this.shadow=r,this.canvas=p,this.set(n).setCoords(),d._objects=[],d.dispose(),d=null,g},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var n={colorStops:[]};return n.type=i.type||(i.r1||i.r2?"radial":"linear"),n.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n.gradientUnits=i.gradientUnits||"pixels",(i.r1||i.r2)&&(n.coords.r1=i.r1,n.coords.r2=i.r2),n.gradientTransform=i.gradientTransform,e.Gradient.prototype.addColorStop.call(n,i.colorStops),this.set(t,e.Gradient.forObject(this,n))},setPatternFill:function(t,i){return this.set("fill",new e.Pattern(t,i))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,i){i=i||this.canvas.getPointer(t);var n=new e.Point(i.x,i.y),r=this._getLeftTopCoords();return this.angle&&(n=e.util.rotatePoint(n,r,s(-this.angle))),{x:n.x-r.x,y:n.y-r.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,i,r,o){var s=e[t];i=n(i,!0),e.util.enlivenPatterns([i.fill,i.stroke],(function(t){void 0!==t[0]&&(i.fill=t[0]),void 0!==t[1]&&(i.stroke=t[1]),e.util.enlivenObjects([i.clipPath],(function(t){i.clipPath=t[0];var e=o?new s(i[o],i):new s(i);r&&r(e)}))}))},e.Object.__uid=0)}(e),y=T.util.degreesToRadians,_={left:-.5,center:0,right:.5},b={top:-.5,center:0,bottom:.5},T.util.object.extend(T.Object.prototype,{translateToGivenOrigin:function(t,e,i,n,r){var o,s,a,l=t.x,c=t.y;return"string"==typeof e?e=_[e]:e-=.5,"string"==typeof n?n=_[n]:n-=.5,"string"==typeof i?i=b[i]:i-=.5,"string"==typeof r?r=b[r]:r-=.5,s=r-i,((o=n-e)||s)&&(a=this._getTransformedDimensions(),l=t.x+o*a.x,c=t.y+s*a.y),new T.Point(l,c)},translateToCenterPoint:function(t,e,i){var n=this.translateToGivenOrigin(t,e,i,"center","center");return this.angle?T.util.rotatePoint(n,t,y(this.angle)):n},translateToOriginPoint:function(t,e,i){var n=this.translateToGivenOrigin(t,"center","center",e,i);return this.angle?T.util.rotatePoint(n,t,y(this.angle)):n},getCenterPoint:function(){var t=new T.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(t,e,i){var n,r,o=this.getCenterPoint();return n=void 0!==e&&void 0!==i?this.translateToGivenOrigin(o,"center","center",e,i):new T.Point(this.left,this.top),r=new T.Point(t.x,t.y),this.angle&&(r=T.util.rotatePoint(r,o,-y(this.angle))),r.subtractEquals(n)},setPositionByOrigin:function(t,e,i){var n=this.translateToCenterPoint(t,e,i),r=this.translateToOriginPoint(n,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(t){var e,i,n=y(this.angle),r=this.getScaledWidth(),o=T.util.cos(n)*r,s=T.util.sin(n)*r;e="string"==typeof this.originX?_[this.originX]:this.originX-.5,i="string"==typeof t?_[t]:t-.5,this.left+=o*(i-e),this.top+=s*(i-e),this.setCoords(),this.originX=t},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var t=T.util.degreesToRadians,e=T.util.multiplyTransformMatrices,i=T.util.transformPoint;T.util.object.extend(T.Object.prototype,{oCoords:null,aCoords:null,ownMatrixCache:null,matrixCache:null,getCoords:function(t,e){this.oCoords||this.setCoords();var i=t?this.aCoords:this.oCoords;return function(t){return[new T.Point(t.tl.x,t.tl.y),new T.Point(t.tr.x,t.tr.y),new T.Point(t.br.x,t.br.y),new T.Point(t.bl.x,t.bl.y)]}(e?this.calcCoords(t):i)},intersectsWithRect:function(t,e,i,n){var r=this.getCoords(i,n);return"Intersection"===T.Intersection.intersectPolygonRectangle(r,t,e).status},intersectsWithObject:function(t,e,i){return"Intersection"===T.Intersection.intersectPolygonPolygon(this.getCoords(e,i),t.getCoords(e,i)).status||t.isContainedWithinObject(this,e,i)||this.isContainedWithinObject(t,e,i)},isContainedWithinObject:function(t,e,i){for(var n=this.getCoords(e,i),r=0,o=t._getImageLines(i?t.calcCoords(e):e?t.aCoords:t.oCoords);r<4;r++)if(!t.containsPoint(n[r],o))return!1;return!0},isContainedWithinRect:function(t,e,i,n){var r=this.getBoundingRect(i,n);return r.left>=t.x&&r.left+r.width<=e.x&&r.top>=t.y&&r.top+r.height<=e.y},containsPoint:function(t,e,i,n){e=e||this._getImageLines(n?this.calcCoords(i):i?this.aCoords:this.oCoords);var r=this._findCrossPoints(t,e);return 0!==r&&r%2==1},isOnScreen:function(t){if(!this.canvas)return!1;for(var e,i=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br,r=this.getCoords(!0,t),o=0;o<4;o++)if((e=r[o]).x<=n.x&&e.x>=i.x&&e.y<=n.y&&e.y>=i.y)return!0;return!!this.intersectsWithRect(i,n,!0,t)||this._containsCenterOfCanvas(i,n,t)},_containsCenterOfCanvas:function(t,e,i){var n={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(n,null,!0,i)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,i,!0,t)||this._containsCenterOfCanvas(e,i,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,n,r,o=0;for(var s in e)if(!((r=e[s]).o.y<t.y&&r.d.y<t.y||r.o.y>=t.y&&r.d.y>=t.y||(r.o.x===r.d.x&&r.o.x>=t.x?n=r.o.x:(0,i=(r.d.y-r.o.y)/(r.d.x-r.o.x),n=-(t.y-0*t.x-(r.o.y-i*r.o.x))/(0-i)),n>=t.x&&(o+=1),2!==o)))break;return o},getBoundingRect:function(t,e){var i=this.getCoords(t,e);return T.util.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var i=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/i)},scaleToHeight:function(t,e){var i=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/i)},calcCoords:function(n){var r=this._calcRotateMatrix(),o=this._calcTranslateMatrix(),s=e(o,r),a=this.getViewportTransform(),l=n?s:e(a,s),c=this._getTransformedDimensions(),u=c.x/2,h=c.y/2,f=i({x:-u,y:-h},l),d=i({x:u,y:-h},l),p=i({x:-u,y:h},l),g=i({x:u,y:h},l);if(!n){var m=this.padding,v=t(this.angle),y=T.util.cos(v),_=T.util.sin(v),b=y*m,w=_*m,x=b+w,C=b-w;m&&(f.x-=C,f.y-=x,d.x+=x,d.y-=C,p.x-=x,p.y+=C,g.x+=C,g.y+=x);var S=new T.Point((f.x+p.x)/2,(f.y+p.y)/2),k=new T.Point((d.x+f.x)/2,(d.y+f.y)/2),O=new T.Point((g.x+d.x)/2,(g.y+d.y)/2),j=new T.Point((g.x+p.x)/2,(g.y+p.y)/2),E=new T.Point(k.x+_*this.rotatingPointOffset,k.y-y*this.rotatingPointOffset)}var A={tl:f,tr:d,br:g,bl:p};return n||(A.ml=S,A.mt=k,A.mr=O,A.mb=j,A.mtr=E),A},setCoords:function(t,e){return this.oCoords=this.calcCoords(t),e||(this.aCoords=this.calcCoords(!0)),t||this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){return T.util.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="";return!t&&this.group&&(e=this.group.transformMatrixKey(t)+"_"),e+this.top+"_"+this.left+"_"+this.scaleX+"_"+this.scaleY+"_"+this.skewX+"_"+this.skewY+"_"+this.angle+"_"+this.originX+"_"+this.originY+"_"+this.width+"_"+this.height+"_"+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){if(t)return this.calcOwnMatrix();var i=this.transformMatrixKey(),n=this.matrixCache||(this.matrixCache={});if(n.key===i)return n.value;var r=this.calcOwnMatrix();return this.group&&(r=e(this.group.calcTransformMatrix(),r)),n.key=i,n.value=r,r},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===t)return e.value;var i=this._calcTranslateMatrix();return this.translateX=i[4],this.translateY=i[5],e.key=t,e.value=T.util.composeMatrix(this),e.value},_calcDimensionsTransformMatrix:function(t,e,i){return T.util.calcDimensionsMatrix({skewX:t,skewY:e,scaleX:this.scaleX*(i&&this.flipX?-1:1),scaleY:this.scaleY*(i&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(t,e){void 0===t&&(t=this.skewX),void 0===e&&(e=this.skewY);var i,n,r=this._getNonTransformedDimensions(),o=0===t&&0===e;if(this.strokeUniform?(i=this.width,n=this.height):(i=r.x,n=r.y),o)return this._finalizeDimensions(i*this.scaleX,n*this.scaleY);var s=[{x:-(i/=2),y:-(n/=2)},{x:i,y:-n},{x:-i,y:n},{x:i,y:n}],a=T.util.calcDimensionsMatrix({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY}),l=T.util.makeBoundingBoxFromPoints(s,a);return this._finalizeDimensions(l.width,l.height)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return T.util.transformPoint(e,t,!0).scalarAdd(2*this.padding)}})}(),T.util.object.extend(T.Object.prototype,{sendToBack:function(){return this.group?T.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?T.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?T.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?T.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?T.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new T.Color(e),n=t+": "+i.toRgb()+"; ",r=i.getAlpha();return 1!==r&&(n+=t+"-opacity: "+r.toString()+"; "),n}return t+": none; "}var e=T.util.toFixed;T.util.object.extend(T.Object.prototype,{getSvgStyles:function(e){var i=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),f=t("fill",this.fill);return[t("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",f,"fill-rule: ",i,"; ","opacity: ",c,";",h,u].join("")},getSvgSpanStyles:function(e,i){var n=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+"; ":"",r=e.strokeWidth?"stroke-width: "+e.strokeWidth+"; ":"",o=(n=n,e.fontSize?"font-size: "+e.fontSize+"px; ":""),s=e.fontStyle?"font-style: "+e.fontStyle+"; ":"",a=e.fontWeight?"font-weight: "+e.fontWeight+"; ":"",l=e.fill?t("fill",e.fill):"",c=e.stroke?t("stroke",e.stroke):"",u=this.getSvgTextDecoration(e);return u&&(u="text-decoration: "+u+"; "),[c,r,n,o,s,a,u,l,e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"",i?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return"overline"in t||"underline"in t||"linethrough"in t?(t.overline?"overline ":"")+(t.underline?"underline ":"")+(t.linethrough?"line-through ":""):""},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){var i=t?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+T.util.matrixToSVG(i)+(e||"")+this.getSvgTransformMatrix()+'" '},getSvgTransformMatrix:function(){return this.transformMatrix?" "+T.util.matrixToSVG(this.transformMatrix):""},_setSVGBg:function(t){if(this.backgroundColor){var i=T.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,i),'" y="',e(-this.height/2,i),'" width="',e(this.width,i),'" height="',e(this.height,i),'"></rect>\n')}},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){var i=(e=e||{}).reviver,n=e.additionalTransform||"",r=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),o=t.indexOf("COMMON_PARTS");return t[o]=r,i?i(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){var i,n,r=(e=e||{}).noStyle,o=e.reviver,s=r?"":'style="'+this.getSvgStyles()+'" ',a=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,f=this.fill,d=this.shadow,p=[],g=t.indexOf("COMMON_PARTS"),m=e.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+T.Object.__uid++,n='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(o)+"</clipPath>\n"),u&&p.push("<g ",a,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons()," >\n"),i=[s,c,r?"":this.addPaintOrder()," ",m?'transform="'+m+'" ':""].join(""),t[g]=i,f&&f.toLive&&p.push(f.toSVG(this)),h&&h.toLive&&p.push(h.toSVG(this)),d&&p.push(d.toSVG(this)),l&&p.push(n),p.push(t.join("")),p.push("</g>\n"),u&&p.push("</g>\n"),o?o(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=T.util.object.extend;function e(e,i,n){var r={};n.forEach((function(t){r[t]=e[t]})),t(e[i],r,!0)}T.util.object.extend(T.Object.prototype,{hasStateChanged:function(t){var e="_"+(t=t||"stateProperties");return Object.keys(this[e]).length<this[t].length||!function t(e,i,n){if(e===i)return!0;if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!t(e[r],i[r]))return!1;return!0}if(e&&"object"==typeof e){var s,a=Object.keys(e);if(!i||"object"!=typeof i||!n&&a.length!==Object.keys(i).length)return!1;for(r=0,o=a.length;r<o;r++)if("canvas"!==(s=a[r])&&!t(e[s],i[s]))return!1;return!0}}(this[e],this,!0)},saveState:function(t){var i=t&&t.propertySet||"stateProperties",n="_"+i;return this[n]?(e(this,n,this[i]),t&&t.stateProperties&&e(this,n,t.stateProperties),this):this.setupState(t)},setupState:function(t){var e=(t=t||{}).propertySet||"stateProperties";return t.propertySet=e,this["_"+e]={},this.saveState(t),this}})}(),function(){var t=T.util.degreesToRadians;T.util.object.extend(T.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var e,i,n=t.x,r=t.y;for(var o in this.__corner=0,this.oCoords)if(this.isControlVisible(o)&&("mtr"!==o||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==o&&"mr"!==o&&"mb"!==o&&"ml"!==o)&&(i=this._getImageLines(this.oCoords[o].corner),0!==(e=this._findCrossPoints({x:n,y:r},i))&&e%2==1))return this.__corner=o,o;return!1},_setCornerCoords:function(){var e,i,n=this.oCoords,r=t(45-this.angle),o=.707106*this.cornerSize,s=o*T.util.cos(r),a=o*T.util.sin(r);for(var l in n)e=n[l].x,i=n[l].y,n[l].corner={tl:{x:e-a,y:i-s},tr:{x:e+s,y:i-a},bl:{x:e-s,y:i+a},br:{x:e+a,y:i+s}}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var i=this.getCenterPoint(),n=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/r[0],1/r[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),n=1/this.borderScaleFactor,r=i.x+n,o=i.y+n,s=void 0!==e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,a=void 0!==e.hasControls?e.hasControls:this.hasControls,l=void 0!==e.rotatingPointOffset?e.rotatingPointOffset:this.rotatingPointOffset;if(t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray,null),t.strokeRect(-r/2,-o/2,r,o),s&&this.isControlVisible("mtr")&&a){var c=-o/2;t.beginPath(),t.moveTo(0,c),t.lineTo(0,c-l),t.stroke()}return t.restore(),this},drawBordersInGroup:function(t,e,i){i=i||{};var n=this._getNonTransformedDimensions(),r=T.util.composeMatrix({scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX}),o=T.util.transformPoint(n,r),s=1/this.borderScaleFactor,a=o.x+s,l=o.y+s;return t.save(),this._setLineDash(t,i.borderDashArray||this.borderDashArray,null),t.strokeStyle=i.borderColor||this.borderColor,t.strokeRect(-a/2,-l/2,a,l),t.restore(),this},drawControls:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),n=i.x,r=i.y,o=e.cornerSize||this.cornerSize,s=-(n+o)/2,a=-(r+o)/2,l=void 0!==e.transparentCorners?e.transparentCorners:this.transparentCorners,c=void 0!==e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,u=l?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",t,u,s,a,e),this._drawControl("tr",t,u,s+n,a,e),this._drawControl("bl",t,u,s,a+r,e),this._drawControl("br",t,u,s+n,a+r,e),this.get("lockUniScaling")||(this._drawControl("mt",t,u,s+n/2,a,e),this._drawControl("mb",t,u,s+n/2,a+r,e),this._drawControl("mr",t,u,s+n,a+r/2,e),this._drawControl("ml",t,u,s,a+r/2,e)),c&&this._drawControl("mtr",t,u,s+n/2,a-this.rotatingPointOffset,e),t.restore(),this},_drawControl:function(t,e,i,n,r,o){if(o=o||{},this.isControlVisible(t)){var s=this.cornerSize,a=!this.transparentCorners&&this.cornerStrokeColor;switch(o.cornerStyle||this.cornerStyle){case"circle":e.beginPath(),e.arc(n+s/2,r+s/2,s/2,0,2*Math.PI,!1),e[i](),a&&e.stroke();break;default:this.transparentCorners||e.clearRect(n,r,s,s),e[i+"Rect"](n,r,s,s),a&&e.strokeRect(n,r,s,s)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility},onDeselect:function(){},onSelect:function(){}})}(),T.util.object.extend(T.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,r=e.onChange||i,o=this;return T.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),o.requestRenderAll(),r()},onComplete:function(){t.setCoords(),n()}}),this},fxCenterObjectV:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,r=e.onChange||i,o=this;return T.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),o.requestRenderAll(),r()},onComplete:function(){t.setCoords(),n()}}),this},fxRemove:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,r=e.onChange||i,o=this;return T.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),o.requestRenderAll(),r()},onComplete:function(){o.remove(t),n()}}),this}}),T.util.object.extend(T.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var n=0,r=i.length;n<r;n++)t=i[n],e=n!==r-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,n){var r,o=this;e=e.toString(),i=i?T.util.object.clone(i):{},~t.indexOf(".")&&(r=t.split("."));var s=r?this.get(r[0])[r[1]]:this.get(t);"from"in i||(i.from=s),e=~e.indexOf("=")?s+parseFloat(e.replace("=","")):parseFloat(e),T.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(o)},onChange:function(e,s,a){r?o[r[0]][r[1]]=e:o.set(t,e),n||i.onChange&&i.onChange(e,s,a)},onComplete:function(t,e,r){n||(o.setCoords(),i.onComplete&&i.onComplete(t,e,r))}})}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,r={x1:1,x2:1,y1:1,y2:1},o=e.StaticCanvas.supports("setLineDash");function s(t,e){var i=t.origin,n=t.axis1,r=t.axis2,o=t.dimension,s=e.nearest,a=e.center,l=e.farthest;return function(){switch(this.get(i)){case s:return Math.min(this.get(n),this.get(r));case a:return Math.min(this.get(n),this.get(r))+.5*this.get(o);case l:return Math.max(this.get(n),this.get(r))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==r[t]&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){if(t.beginPath(),!this.strokeDashArray||this.strokeDashArray&&o){var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2)}t.lineWidth=this.strokeWidth;var i=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i},_renderDashedStroke:function(t){var i=this.calcLinePoints();t.beginPath(),e.util.drawDashedLine(t,i.x1,i.y1,i.x2,i.y2,this.strokeDashArray),t.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return i(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,n=e*this.height*.5;return{x1:i,x2:t*this.width*-.5,y1:n,y2:e*this.height*-.5}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,n,r){r=r||{};var o=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),s=[o.x1||0,o.y1||0,o.x2||0,o.y2||0];n(new e.Line(s,i(o,r)))},e.Line.fromObject=function(t,i){var r=n(t,!0);r.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",r,(function(t){delete t.points,i&&i(t)}),"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.PI;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*i,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,n=(this.endAngle-this.startAngle)%(2*i);if(0===n)t=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var r=e.util.cos(this.startAngle)*this.radius,o=e.util.sin(this.startAngle)*this.radius,s=e.util.cos(this.endAngle)*this.radius,a=e.util.sin(this.endAngle)*this.radius,l=n>i?"1":"0";t=['<path d="M '+r+" "+o," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+s+" "+a,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,i){var n,r=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!("radius"in(n=r)&&n.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,i(new e.Circle(r))},e.Circle.fromObject=function(t,i){return e.Object._fromObject("Circle",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i=this.width/2,n=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,n,0,-n,this.strokeDashArray),e.util.drawDashedLine(t,0,-n,i,n,this.strokeDashArray),e.util.drawDashedLine(t,i,n,-i,n,this.strokeDashArray),t.closePath()},_toSVG:function(){var t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-t+" "+e,"0 "+-e,t+" "+e].join(","),'" />']}}),e.Triangle.fromObject=function(t,i){return e.Object._fromObject("Triangle",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,i,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){var n=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,i(new e.Ellipse(n))},e.Ellipse.fromObject=function(t,i){return e.Object._fromObject("Ellipse",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,r=this.height,o=-this.width/2,s=-this.height/2,a=0!==e||0!==i,l=.4477152502;t.beginPath(),t.moveTo(o+e,s),t.lineTo(o+n-e,s),a&&t.bezierCurveTo(o+n-l*e,s,o+n,s+l*i,o+n,s+i),t.lineTo(o+n,s+r-i),a&&t.bezierCurveTo(o+n,s+r-l*i,o+n-l*e,s+r,o+n-e,s+r),t.lineTo(o+e,s+r),a&&t.bezierCurveTo(o+l*e,s+r,o,s+r-l*i,o,s+r-i),t.lineTo(o,s+i),a&&t.bezierCurveTo(o,s+l*i,o+l*e,s,o+e,s),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i=-this.width/2,n=-this.height/2,r=this.width,o=this.height;t.beginPath(),e.util.drawDashedLine(t,i,n,i+r,n,this.strokeDashArray),e.util.drawDashedLine(t,i+r,n,i+r,n+o,this.strokeDashArray),e.util.drawDashedLine(t,i+r,n+o,i,n+o,this.strokeDashArray),e.util.drawDashedLine(t,i,n+o,i,n,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,n,r){if(!t)return n(null);r=r||{};var o=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var s=new e.Rect(i(r?e.util.object.clone(r):{},o));s.visible=s.visible&&s.width>0&&s.height>0,n(s)},e.Rect.fromObject=function(t,i){return e.Object._fromObject("Rect",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.array.min,r=e.util.array.max,o=e.util.toFixed;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_setPositionDimensions:function(t){var e,i=this._calcDimensions(t);this.width=i.width,this.height=i.height,t.fromSVG||(e=this.translateToGivenOrigin({x:i.left-this.strokeWidth/2,y:i.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),void 0===t.left&&(this.left=t.fromSVG?i.left:e.x),void 0===t.top&&(this.top=t.fromSVG?i.top:e.y),this.pathOffset={x:i.left+this.width/2,y:i.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=n(t,"x")||0,i=n(t,"y")||0;return{left:e,top:i,width:(r(t,"x")||0)-e,height:(r(t,"y")||0)-i}},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],i=this.pathOffset.x,n=this.pathOffset.y,r=e.Object.NUM_FRACTION_DIGITS,s=0,a=this.points.length;s<a;s++)t.push(o(this.points[s].x-i,r),",",o(this.points[s].y-n,r)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,i=this.points.length,n=this.pathOffset.x,r=this.pathOffset.y;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-n,this.points[0].y-r);for(var o=0;o<i;o++)e=this.points[o],t.lineTo(e.x-n,e.y-r);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i,n;t.beginPath();for(var r=0,o=this.points.length;r<o;r++)i=this.points[r],n=this.points[r+1]||i,e.util.drawDashedLine(t,i.x,i.y,n.x,n.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(t){return function(n,r,o){if(!n)return r(null);o||(o={});var s=e.parsePointsAttribute(n.getAttribute("points")),a=e.parseAttributes(n,e[t].ATTRIBUTE_NAMES);a.fromSVG=!0,r(new e[t](s,i(a,o)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(t,i){return e.Object._fromObject("Polyline",t,i,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))},_renderDashedStroke:function(t){this.callSuper("_renderDashedStroke",t),t.closePath()}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(t,i){return e.Object._fromObject("Polygon",t,i,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,n=e.util.array.max,r=e.util.object.extend,o=Object.prototype.toString,s=e.util.drawArc,a=e.util.toFixed,l={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,i){i=i||{},this.callSuper("initialize",i),t||(t=[]);var n="[object Array]"===o.call(t);this.path=n?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(n||(this.path=this._parsePath()),e.Polyline.prototype._setPositionDimensions.call(this,i))},_renderPathCommands:function(t){var e,i,n,r=null,o=0,a=0,l=0,c=0,u=0,h=0,f=-this.pathOffset.x,d=-this.pathOffset.y;t.beginPath();for(var p=0,g=this.path.length;p<g;++p){switch((e=this.path[p])[0]){case"l":l+=e[1],c+=e[2],t.lineTo(l+f,c+d);break;case"L":l=e[1],c=e[2],t.lineTo(l+f,c+d);break;case"h":l+=e[1],t.lineTo(l+f,c+d);break;case"H":l=e[1],t.lineTo(l+f,c+d);break;case"v":c+=e[1],t.lineTo(l+f,c+d);break;case"V":c=e[1],t.lineTo(l+f,c+d);break;case"m":o=l+=e[1],a=c+=e[2],t.moveTo(l+f,c+d);break;case"M":o=l=e[1],a=c=e[2],t.moveTo(l+f,c+d);break;case"c":i=l+e[5],n=c+e[6],u=l+e[3],h=c+e[4],t.bezierCurveTo(l+e[1]+f,c+e[2]+d,u+f,h+d,i+f,n+d),l=i,c=n;break;case"C":l=e[5],c=e[6],u=e[3],h=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,u+f,h+d,l+f,c+d);break;case"s":i=l+e[3],n=c+e[4],null===r[0].match(/[CcSs]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),t.bezierCurveTo(u+f,h+d,l+e[1]+f,c+e[2]+d,i+f,n+d),u=l+e[1],h=c+e[2],l=i,c=n;break;case"S":i=e[3],n=e[4],null===r[0].match(/[CcSs]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),t.bezierCurveTo(u+f,h+d,e[1]+f,e[2]+d,i+f,n+d),l=i,c=n,u=e[1],h=e[2];break;case"q":i=l+e[3],n=c+e[4],u=l+e[1],h=c+e[2],t.quadraticCurveTo(u+f,h+d,i+f,n+d),l=i,c=n;break;case"Q":i=e[3],n=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,n+d),l=i,c=n,u=e[1],h=e[2];break;case"t":i=l+e[1],n=c+e[2],null===r[0].match(/[QqTt]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),t.quadraticCurveTo(u+f,h+d,i+f,n+d),l=i,c=n;break;case"T":i=e[1],n=e[2],null===r[0].match(/[QqTt]/)?(u=l,h=c):(u=2*l-u,h=2*c-h),t.quadraticCurveTo(u+f,h+d,i+f,n+d),l=i,c=n;break;case"a":s(t,l+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+l+f,e[7]+c+d]),l+=e[6],c+=e[7];break;case"A":s(t,l+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),l=e[6],c=e[7];break;case"z":case"Z":l=o,c=a,t.closePath()}r=e}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return r(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',this.path.map((function(t){return t.join(" ")})).join(" "),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=e.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,t)+", "+a(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,n,r,o=[],s=[],a=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u=0,h=this.path.length;u<h;u++){for(n=(t=this.path[u]).slice(1).trim(),s.length=0;i=a.exec(n);)s.push(i[0]);r=[t.charAt(0)];for(var f=0,d=s.length;f<d;f++)e=parseFloat(s[f]),isNaN(e)||r.push(e);var p=r[0],g=l[p.toLowerCase()],m=c[p]||p;if(r.length-1>g)for(var v=1,y=r.length;v<y;v+=g)o.push([p].concat(r.slice(v,v+g))),p=m;else o.push(r)}return o},_calcDimensions:function(){for(var t,r,o,s,a=[],l=[],c=null,u=0,h=0,f=0,d=0,p=0,g=0,m=0,v=this.path.length;m<v;++m){switch((t=this.path[m])[0]){case"l":f+=t[1],d+=t[2],s=[];break;case"L":f=t[1],d=t[2],s=[];break;case"h":f+=t[1],s=[];break;case"H":f=t[1],s=[];break;case"v":d+=t[1],s=[];break;case"V":d=t[1],s=[];break;case"m":u=f+=t[1],h=d+=t[2],s=[];break;case"M":u=f=t[1],h=d=t[2],s=[];break;case"c":r=f+t[5],o=d+t[6],p=f+t[3],g=d+t[4],s=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],p,g,r,o),f=r,d=o;break;case"C":p=t[3],g=t[4],s=e.util.getBoundsOfCurve(f,d,t[1],t[2],p,g,t[5],t[6]),f=t[5],d=t[6];break;case"s":r=f+t[3],o=d+t[4],null===c[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,f+t[1],d+t[2],r,o),p=f+t[1],g=d+t[2],f=r,d=o;break;case"S":r=t[3],o=t[4],null===c[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,t[1],t[2],r,o),f=r,d=o,p=t[1],g=t[2];break;case"q":r=f+t[3],o=d+t[4],p=f+t[1],g=d+t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"Q":p=t[1],g=t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,t[3],t[4]),f=t[3],d=t[4];break;case"t":r=f+t[1],o=d+t[2],null===c[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"T":r=t[1],o=t[2],null===c[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"a":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=u,d=h}c=t,s.forEach((function(t){a.push(t.x),l.push(t.y)})),a.push(f),l.push(d)}var y=i(a)||0,_=i(l)||0;return{left:y,top:_,width:(n(a)||0)-y,height:(n(l)||0)-_}}}),e.Path.fromObject=function(t,i){if("string"==typeof t.sourcePath){var n=t.sourcePath;e.loadSVGFromURL(n,(function(e){var n=e[0];n.setOptions(t),i&&i(n)}))}else e.Object._fromObject("Path",t,i,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,n){var o=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,i(new e.Path(o.d,r(o,n)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,n=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;if(i)this._updateObjectsACoords();else{var r=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),r||this._calcBounds(),this._updateObjectsCoords(r),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0,!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var i=t.left,n=t.top;t.set({left:i-e.x,top:n-e.y}),t.group=this,t.setCoords(!0,!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,i){var n=this._objects.length;if(this.useSetOnGroup)for(;n--;)this._objects[n].setOnGroup(t,i);if("canvas"===t)for(;n--;)this._objects[n]._set(t,i);e.Object.prototype._set.call(this,t,i)},toObject:function(t){var i=this.includeDefaultValues,n=this._objects.map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=i;var r=e.toObject(t);return e.includeDefaultValues=n,r})),r=e.Object.prototype.toObject.call(this,t);return r.objects=n,r},toDatalessObject:function(t){var i,n=this.sourcePath;if(n)i=n;else{var r=this.includeDefaultValues;i=this._objects.map((function(e){var i=e.includeDefaultValues;e.includeDefaultValues=r;var n=e.toDatalessObject(t);return e.includeDefaultValues=i,n}))}var o=e.Object.prototype.toDatalessObject.call(this,t);return o.objects=i,o},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var i=0,n=this._objects.length;i<n;i++)if(this._objects[i].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(this.shadow)return e.Object.prototype.willDrawShadow.call(this);for(var t=0,i=this._objects.length;t<i;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,i=this._objects.length;e<i;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,i=this._objects.length;e<i;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var n=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-n/2,-r/2,n,r)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var i=t.calcTransformMatrix(),n=e.util.qrDecompose(i),r=new e.Point(n.translateX,n.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",n.scaleX),t.set("scaleY",n.scaleY),t.skewX=n.skewX,t.skewY=n.skewY,t.angle=n.angle,t.setPositionByOrigin(r,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),t.setCoords(),delete t.group,this},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,i=this.canvas;this._objects=[];var n=this.toObject();delete n.objects;var r=new e.ActiveSelection([]);return r.set(n),r.type="activeSelection",i.remove(this),t.forEach((function(t){t.group=r,t.dirty=!0,i.add(t)})),r.canvas=i,r._objects=t,i._activeObject=r,r.setCoords(),r}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(!0,!0)})),this},_calcBounds:function(t){for(var e,i,n,r=[],o=[],s=["tr","br","bl","tl"],a=0,l=this._objects.length,c=s.length;a<l;++a)for((e=this._objects[a]).setCoords(!0),n=0;n<c;n++)i=s[n],r.push(e.oCoords[i].x),o.push(e.oCoords[i].y);this._getBounds(r,o,t)},_getBounds:function(t,r,o){var s=new e.Point(i(t),i(r)),a=new e.Point(n(t),n(r)),l=s.y||0,c=s.x||0,u=a.x-s.x||0,h=a.y-s.y||0;this.width=u,this.height=h,o||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],i=0,n=this._objects.length;i<n;i++)e.push("\t\t",this._objects[i].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],i=0,n=this._objects.length;i<n;i++)e.push("\t",this._objects[i].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,(function(n){e.util.enlivenObjects([t.clipPath],(function(r){var o=e.util.object.clone(t,!0);o.clipPath=r[0],delete o.objects,i&&i(new e.Group(n,o,!0))}))}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,i){i=i||{},this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;i.originX&&(this.originX=i.originX),i.originY&&(this.originY=i.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,i),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var i=e.Object.prototype.toObject.call(this),n=new e.Group([]);if(delete i.type,n.set(i),t.forEach((function(t){t.canvas.remove(t),t.group=n})),n._objects=t,!this.canvas)return n;var r=this.canvas;return r.add(n),r._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(i=i||{}).hasControls&&(i.hasControls=!1),void 0===i.hasRotatingPoint&&(i.hasRotatingPoint=!1),i.forActiveSelection=!0;for(var n=0,r=this._objects.length;n<r;n++)this._objects[n]._renderControls(t,i);t.restore()}}),e.ActiveSelection.fromObject=function(t,i){e.util.enlivenObjects(t.objects,(function(n){delete t.objects,i&&i(new e.ActiveSelection(n,t,!0))}))})}(e),function(t){"use strict";var e=T.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?T.warn("fabric.Image is already defined."):(T.Image=T.util.createClass(T.Object,{type:"image",crossOrigin:"",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:T.Object.prototype.stateProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+T.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=T.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){T.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,n=this.width,r=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),T.util.drawDashedLine(t,e,i,e+n,i,this.strokeDashArray),T.util.drawDashedLine(t,e+n,i,e+n,i+r,this.strokeDashArray),T.util.drawDashedLine(t,e+n,i+r,e,i+r,this.strokeDashArray),T.util.drawDashedLine(t,e,i+r,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=[];this.filters.forEach((function(t){t&&i.push(t.toObject())}));var n=e(this.callSuper("toObject",["crossOrigin","cropX","cropY"].concat(t)),{src:this.getSrc(),filters:i});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e=[],i=[],n=-this.width/2,r=-this.height/2,o="";if(this.hasCrop()){var s=T.Object.__uid++;e.push('<clipPath id="imageCrop_'+s+'">\n','\t<rect x="'+n+'" y="'+r+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),o=' clip-path="url(#imageCrop_'+s+')" '}if(i.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',n-this.cropX,'" y="',r-this.cropY,'" width="',this._element.width||this._element.naturalWidth,'" height="',this._element.height||this._element.height,'"',o,"></image>\n"),this.stroke||this.strokeDashArray){var a=this.fill;this.fill=null,t=["\t<rect ",'x="',n,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=a}return e="fill"!==this.paintFirst?e.concat(t,i):e.concat(i,t)},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,i){return T.util.loadImage(t,(function(t){this.setElement(t,i),this._setWidthHeight(),e&&e(this)}),this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.scaleX,r=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||n>e&&r>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=r);T.filterBackend||(T.filterBackend=T.initFilterBackend());var s=T.util.createCanvasElement(),a=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=o.width,c=o.height;s.width=l,s.height=c,this._element=s,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=r,T.filterBackend.applyFilters([t],o,l,c,this._element,a),this._filterScalingX=s.width/this._originalElement.width,this._filterScalingY=s.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,i=e.naturalWidth||e.width,n=e.naturalHeight||e.height;if(this._element===this._originalElement){var r=T.util.createCanvasElement();r.width=i,r.height=n,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1;return T.filterBackend||(T.filterBackend=T.initFilterBackend()),T.filterBackend.applyFilters(t,this._originalElement,i,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element,i=this.width,n=this.height,r=Math.min(e.naturalWidth||e.width,i*this._filterScalingX),o=Math.min(e.naturalHeight||e.height,n*this._filterScalingY),s=-i/2,a=-n/2,l=Math.max(0,this.cropX*this._filterScalingX),c=Math.max(0,this.cropY*this._filterScalingY);e&&t.drawImage(e,l,c,r,o,s,a,i,n)},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(T.util.getById(t),e),T.util.addClass(this.getElement(),T.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?T.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=T.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,n=this._element.height,r=1,o=1,s=0,a=0,l=0,c=0,u=this.width,h=this.height,f={width:u,height:h};return!e||"none"===e.alignX&&"none"===e.alignY?(r=u/i,o=h/n):("meet"===e.meetOrSlice&&(t=(u-i*(r=o=T.util.findScaleToFit(this._element,f)))/2,"Min"===e.alignX&&(s=-t),"Max"===e.alignX&&(s=t),t=(h-n*o)/2,"Min"===e.alignY&&(a=-t),"Max"===e.alignY&&(a=t)),"slice"===e.meetOrSlice&&(t=i-u/(r=o=T.util.findScaleToCover(this._element,f)),"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=n-h/o,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),i=u/r,n=h/o)),{width:i,height:n,scaleX:r,scaleY:o,offsetLeft:s,offsetTop:a,cropX:l,cropY:c}}}),T.Image.CSS_CANVAS="canvas-img",T.Image.prototype.getSvgSrc=T.Image.prototype.getSrc,T.Image.fromObject=function(t,e){var i=T.util.object.clone(t);T.util.loadImage(i.src,(function(t,n){n?e&&e(null,n):T.Image.prototype._initFilters.call(i,i.filters,(function(n){i.filters=n||[],T.Image.prototype._initFilters.call(i,[i.resizeFilter],(function(n){i.resizeFilter=n[0],T.util.enlivenObjects([i.clipPath],(function(n){i.clipPath=n[0];var r=new T.Image(t,i);e(r)}))}))}))}),null,i.crossOrigin)},T.Image.fromURL=function(t,e,i){T.util.loadImage(t,(function(t){e&&e(new T.Image(t,i))}),null,i&&i.crossOrigin)},T.Image.ATTRIBUTE_NAMES=T.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin".split(" ")),T.Image.fromElement=function(t,i,n){var r=T.parseAttributes(t,T.Image.ATTRIBUTE_NAMES);T.Image.fromURL(r["xlink:href"],i,e(n?T.util.object.clone(n):{},r))})}(e),T.util.object.extend(T.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){var e=function(){},i=(t=t||{}).onComplete||e,n=t.onChange||e,r=this;return T.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){r.rotate(t),n()},onComplete:function(){r.setCoords(),i()}}),this}}),T.util.object.extend(T.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";function t(t,e){var i="precision "+e+" float;\nvoid main(){}",n=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(n,i),t.compileShader(n),!!t.getShaderParameter(n,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}T.isWebglSupported=function(e){if(T.isLikelyNode)return!1;e=e||T.WebglFilterBackend.prototype.tileSize;var i=document.createElement("canvas"),n=i.getContext("webgl")||i.getContext("experimental-webgl"),r=!1;if(n){T.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),r=T.maxTextureSize>=e;for(var o=["highp","mediump","lowp"],s=0;s<3;s++)if(t(n,o[s])){T.webGlPrecision=o[s];break}}return this.isSupported=r,r},T.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var i,n=void 0!==window.performance;try{new ImageData(1,1),i=!0}catch(t){i=!1}var r="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(n&&i&&r&&o){var s=T.util.createCanvasElement(),a=new ArrayBuffer(t*e*4);if(T.forceGLPutImageData)return this.imageBuffer=a,void(this.copyGLTo2D=O);var l,c,u={imageBuffer:a,destinationWidth:t,destinationHeight:e,targetCanvas:s};s.width=t,s.height=e,l=window.performance.now(),k.call(u,this.gl,u),c=window.performance.now()-l,l=window.performance.now(),O.call(u,this.gl,u),c>window.performance.now()-l?(this.imageBuffer=a,this.copyGLTo2D=O):this.copyGLTo2D=k}},createWebGLCanvas:function(t,e){var i=T.util.createCanvasElement();i.width=t,i.height=e;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=i.getContext("webgl",n);r||(r=i.getContext("experimental-webgl",n)),r&&(r.clearColor(0,0,0,0),this.canvas=i,this.gl=r)},applyFilters:function(t,e,i,n,r,o){var s,a=this.gl;o&&(s=this.getCachedTexture(o,e));var l={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:a,sourceTexture:this.createTexture(a,i,n,!s&&e),targetTexture:this.createTexture(a,i,n),originalTexture:s||this.createTexture(a,i,n,!s&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},c=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,c),t.forEach((function(t){t&&t.applyTo(l)})),function(t){var e=t.targetCanvas,i=e.width,n=e.height,r=t.destinationWidth,o=t.destinationHeight;i===r&&n===o||(e.width=r,e.height=o)}(l),this.copyGLTo2D(a,l),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(l.sourceTexture),a.deleteTexture(l.targetTexture),a.deleteFramebuffer(c),r.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,i,n){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),r},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var i=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=i,i},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:k,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var i=t.getExtension("WEBGL_debug_renderer_info");if(i){var n=t.getParameter(i.UNMASKED_RENDERER_WEBGL),r=t.getParameter(i.UNMASKED_VENDOR_WEBGL);n&&(e.renderer=n.toLowerCase()),r&&(e.vendor=r.toLowerCase())}return this.gpuInfo=e,e}}}(),function(){"use strict";var t=function(){};function e(){}T.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,i,n,r){var o=r.getContext("2d");o.drawImage(e,0,0,i,n);var s={sourceWidth:i,sourceHeight:n,imageData:o.getImageData(0,0,i,n),originalEl:e,originalImageData:o.getImageData(0,0,i,n),canvasEl:r,ctx:o,filterBackend:this};return t.forEach((function(t){t.applyTo(s)})),s.imageData.width===i&&s.imageData.height===n||(r.width=s.imageData.width,r.height=s.imageData.height),o.putImageData(s.imageData,0,0),s}}}(),T.Image=T.Image||{},T.Image.filters=T.Image.filters||{},T.Image.filters.BaseFilter=T.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,i){e=e||this.fragmentSource,i=i||this.vertexSource,"highp"!==T.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+T.webGlPrecision+" float"));var n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(o));var s=this.getAttributeLocations(t,o),a=this.getUniformLocations(t,o)||{};return a.uStepW=t.getUniformLocation(o,"uStepW"),a.uStepH=t.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:s,uniformLocations:a}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,i){var n=e.aPosition,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,i,n=t.context;t.passes>1?(e=t.destinationWidth,i=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===i||(n.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(n,e,i)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t.targetTexture,0)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=T.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var i=e[t].length;i--;)if(this[t][i]!==e[t][i])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,i=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),T.Image.filters.BaseFilter.fromObject=function(t,e){var i=new T.Image.filters[t.type](t);return e&&e(i),i},function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.ColorMatrix=n(i.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,i,n,r,o,s=t.imageData.data,a=s.length,l=this.matrix,c=this.colorsOnly;for(o=0;o<a;o+=4)e=s[o],i=s[o+1],n=s[o+2],c?(s[o]=e*l[0]+i*l[1]+n*l[2]+255*l[4],s[o+1]=e*l[5]+i*l[6]+n*l[7]+255*l[9],s[o+2]=e*l[10]+i*l[11]+n*l[12]+255*l[14]):(r=s[o+3],s[o]=e*l[0]+i*l[1]+n*l[2]+r*l[3]+255*l[4],s[o+1]=e*l[5]+i*l[6]+n*l[7]+r*l[8]+255*l[9],s[o+2]=e*l[10]+i*l[11]+n*l[12]+r*l[13]+255*l[14],s[o+3]=e*l[15]+i*l[16]+n*l[17]+r*l[18]+255*l[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var i=this.matrix,n=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],r=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,r)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Brightness=n(i.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,i=t.imageData.data,n=i.length,r=Math.round(255*this.brightness);for(e=0;e<n;e+=4)i[e]=i[e]+r,i[e+1]=i[e+1]+r,i[e+2]=i[e+2]+r}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,r=e.util.createClass;n.Convolute=r(n.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),i=this.type+"_"+e+"_"+(this.opaque?1:0),n=this.fragmentSource[i];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,n)),t.programCache[i]},applyTo2d:function(t){var e,i,n,r,o,s,a,l,c,u,h,f,d,p=t.imageData,g=p.data,m=this.matrix,v=Math.round(Math.sqrt(m.length)),y=Math.floor(v/2),_=p.width,b=p.height,w=t.ctx.createImageData(_,b),x=w.data,C=this.opaque?1:0;for(h=0;h<b;h++)for(u=0;u<_;u++){for(o=4*(h*_+u),e=0,i=0,n=0,r=0,d=0;d<v;d++)for(f=0;f<v;f++)s=u+f-y,(a=h+d-y)<0||a>b||s<0||s>_||(l=4*(a*_+s),c=m[d*v+f],e+=g[l]*c,i+=g[l+1]*c,n+=g[l+2]*c,C||(r+=g[l+3]*c));x[o]=e,x[o+1]=i,x[o+2]=n,x[o+3]=C?g[o+3]:r}t.imageData=w},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Grayscale=n(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,i,n=t.imageData.data,r=n.length,o=this.mode;for(e=0;e<r;e+=4)"average"===o?i=(n[e]+n[e+1]+n[e+2])/3:"lightness"===o?i=(Math.min(n[e],n[e+1],n[e+2])+Math.max(n[e],n[e+1],n[e+2]))/2:"luminosity"===o&&(i=.21*n[e]+.72*n[e+1]+.07*n[e+2]),n[e]=i,n[e+1]=i,n[e+2]=i},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var i=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,i)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Invert=n(i.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,i=t.imageData.data,n=i.length;for(e=0;e<n;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,r=e.util.createClass;n.Noise=r(n.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,i,n=t.imageData.data,r=n.length,o=this.noise;for(e=0,r=n.length;e<r;e+=4)i=(.5-Math.random())*o,n[e]+=i,n[e+1]+=i,n[e+2]+=i}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Pixelate=n(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,i,n,r,o,s,a,l,c,u,h,f=t.imageData,d=f.data,p=f.height,g=f.width;for(i=0;i<p;i+=this.blocksize)for(n=0;n<g;n+=this.blocksize)for(r=d[e=4*i*g+4*n],o=d[e+1],s=d[e+2],a=d[e+3],u=Math.min(i+this.blocksize,p),h=Math.min(n+this.blocksize,g),l=i;l<u;l++)for(c=n;c<h;c++)d[e=4*l*g+4*c]=r,d[e+1]=o,d[e+2]=s,d[e+3]=a},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,r=e.util.createClass;n.RemoveColor=r(n.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var i,n,r,o,s=t.imageData.data,a=255*this.distance,l=new e.Color(this.color).getSource(),c=[l[0]-a,l[1]-a,l[2]-a],u=[l[0]+a,l[1]+a,l[2]+a];for(i=0;i<s.length;i+=4)n=s[i],r=s[i+1],o=s[i+2],n>c[0]&&r>c[1]&&o>c[2]&&n<u[0]&&r<u[1]&&o<u[2]&&(s[i+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,i){var n=new e.Color(this.color).getSource(),r=parseFloat(this.distance),o=[0+n[0]/255-r,0+n[1]/255-r,0+n[2]/255-r,1],s=[n[0]/255+r,n[1]/255+r,n[2]/255+r,1];t.uniform4fv(i.uLow,o),t.uniform4fv(i.uHigh,s)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in r)i[o]=n(i.ColorMatrix,{type:o,matrix:r[o],mainParameter:!1,colorsOnly:!0}),e.Image.filters[o].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,i=e.Image.filters,n=e.util.createClass;i.BlendColor=n(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,i=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(i)||(e=this.buildSource(this.mode),t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},applyTo2d:function(t){var i,n,r,o,s,a,l,c=t.imageData.data,u=c.length,h=1-this.alpha;i=(l=new e.Color(this.color).getSource())[0]*this.alpha,n=l[1]*this.alpha,r=l[2]*this.alpha;for(var f=0;f<u;f+=4)switch(o=c[f],s=c[f+1],a=c[f+2],this.mode){case"multiply":c[f]=o*i/255,c[f+1]=s*n/255,c[f+2]=a*r/255;break;case"screen":c[f]=255-(255-o)*(255-i)/255,c[f+1]=255-(255-s)*(255-n)/255,c[f+2]=255-(255-a)*(255-r)/255;break;case"add":c[f]=o+i,c[f+1]=s+n,c[f+2]=a+r;break;case"diff":case"difference":c[f]=Math.abs(o-i),c[f+1]=Math.abs(s-n),c[f+2]=Math.abs(a-r);break;case"subtract":c[f]=o-i,c[f+1]=s-n,c[f+2]=a-r;break;case"darken":c[f]=Math.min(o,i),c[f+1]=Math.min(s,n),c[f+2]=Math.min(a,r);break;case"lighten":c[f]=Math.max(o,i),c[f+1]=Math.max(s,n),c[f+2]=Math.max(a,r);break;case"overlay":c[f]=i<128?2*o*i/255:255-2*(255-o)*(255-i)/255,c[f+1]=n<128?2*s*n/255:255-2*(255-s)*(255-n)/255,c[f+2]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255;break;case"exclusion":c[f]=i+o-2*i*o/255,c[f+1]=n+s-2*n*s/255,c[f+2]=r+a-2*r*a/255;break;case"tint":c[f]=i+o*h,c[f+1]=n+s*h,c[f+2]=r+a*h}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,i){var n=new e.Color(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,t.uniform4fv(i.uColor,n)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,i=e.Image.filters,n=e.util.createClass;i.BlendImage=n(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,i)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,i=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]},applyTo2d:function(t){var i,n,r,o,s,a,l,c,u,h,f,d=t.imageData,p=t.filterBackend.resources,g=d.data,m=g.length,v=d.width,y=d.height,_=this.image;p.blendImage||(p.blendImage=e.util.createCanvasElement()),h=(u=p.blendImage).getContext("2d"),u.width!==v||u.height!==y?(u.width=v,u.height=y):h.clearRect(0,0,v,y),h.setTransform(_.scaleX,0,0,_.scaleY,_.left,_.top),h.drawImage(_._element,0,0,v,y),f=h.getImageData(0,0,v,y).data;for(var b=0;b<m;b+=4)switch(s=g[b],a=g[b+1],l=g[b+2],c=g[b+3],i=f[b],n=f[b+1],r=f[b+2],o=f[b+3],this.mode){case"multiply":g[b]=s*i/255,g[b+1]=a*n/255,g[b+2]=l*r/255,g[b+3]=c*o/255;break;case"mask":g[b+3]=o}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,i){e.Image.fromObject(t.image,(function(n){var r=e.util.object.clone(t);r.image=n,i(new e.Image.filters.BlendImage(r))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,n=Math.floor,r=Math.sqrt,o=Math.abs,s=Math.round,a=Math.sin,l=Math.ceil,c=e.Image.filters,u=e.util.createClass;c.Resize=u(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),i=this.type+"_"+e;if(!t.programCache.hasOwnProperty(i)){var n=this.generateShader(e);t.programCache[i]=this.createProgram(t.context,n)}return t.programCache[i]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),n=new Array(i),r=1;r<=i;r++)n[r-1]=t(r*e);return n},generateShader:function(t){for(var e=new Array(t),i=this.fragmentSourceTOP,n=1;n<=t;n++)e[n-1]=n+".0 * uDelta";return i+="uniform float uTaps["+t+"];\n",i+="void main() {\n",i+="  vec4 color = texture2D(uTexture, vTexCoord);\n",i+="  float sum = 1.0;\n",e.forEach((function(t,e){i+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",i+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",i+="  sum += 2.0 * uTaps["+e+"];\n"})),i+="  gl_FragColor = color / sum;\n",i+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;var i=(e*=Math.PI)/t;return a(e)/e*a(i)/i}},applyTo2d:function(t){var e=t.imageData,i=this.scaleX,n=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/n;var r,o=e.width,a=e.height,l=s(o*i),c=s(a*n);"sliceHack"===this.resizeType?r=this.sliceByTwo(t,o,a,l,c):"hermite"===this.resizeType?r=this.hermiteFastResize(t,o,a,l,c):"bilinear"===this.resizeType?r=this.bilinearFiltering(t,o,a,l,c):"lanczos"===this.resizeType&&(r=this.lanczosResize(t,o,a,l,c)),t.imageData=r},sliceByTwo:function(t,i,r,o,s){var a,l,c=t.imageData,u=!1,h=!1,f=.5*i,d=.5*r,p=e.filterBackend.resources,g=0,m=0,v=i,y=0;for(p.sliceByTwo||(p.sliceByTwo=document.createElement("canvas")),((a=p.sliceByTwo).width<1.5*i||a.height<r)&&(a.width=1.5*i,a.height=r),(l=a.getContext("2d")).clearRect(0,0,1.5*i,r),l.putImageData(c,0,0),o=n(o),s=n(s);!u||!h;)i=f,r=d,o<n(.5*f)?f=n(.5*f):(f=o,u=!0),s<n(.5*d)?d=n(.5*d):(d=s,h=!0),l.drawImage(a,g,m,i,r,v,y,f,d),g=v,m=y,y+=d;return l.getImageData(g,m,o,s)},lanczosResize:function(t,e,s,a,c){var u=t.imageData.data,h=t.ctx.createImageData(a,c),f=h.data,d=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,g=this.rcpScaleY,m=2/this.rcpScaleX,v=2/this.rcpScaleY,y=l(p*this.lanczosLobes/2),_=l(g*this.lanczosLobes/2),b={},w={},x={};return function t(l){var C,T,S,k,O,j,E,A,P,D,M;for(w.x=(l+.5)*p,x.x=n(w.x),C=0;C<c;C++){for(w.y=(C+.5)*g,x.y=n(w.y),O=0,j=0,E=0,A=0,P=0,T=x.x-y;T<=x.x+y;T++)if(!(T<0||T>=e)){D=n(1e3*o(T-w.x)),b[D]||(b[D]={});for(var I=x.y-_;I<=x.y+_;I++)I<0||I>=s||(M=n(1e3*o(I-w.y)),b[D][M]||(b[D][M]=d(r(i(D*m,2)+i(M*v,2))/1e3)),(S=b[D][M])>0&&(O+=S,j+=S*u[k=4*(I*e+T)],E+=S*u[k+1],A+=S*u[k+2],P+=S*u[k+3]))}f[k=4*(C*a+l)]=j/O,f[k+1]=E/O,f[k+2]=A/O,f[k+3]=P/O}return++l<a?t(l):h}(0)},bilinearFiltering:function(t,e,i,r,o){var s,a,l,c,u,h,f,d,p,g=0,m=this.rcpScaleX,v=this.rcpScaleY,y=4*(e-1),_=t.imageData.data,b=t.ctx.createImageData(r,o),w=b.data;for(l=0;l<o;l++)for(c=0;c<r;c++)for(u=m*c-(s=n(m*c)),h=v*l-(a=n(v*l)),p=4*(a*e+s),f=0;f<4;f++)d=_[p+f]*(1-u)*(1-h)+_[p+4+f]*u*(1-h)+_[p+y+f]*h*(1-u)+_[p+y+4+f]*u*h,w[g++]=d;return b},hermiteFastResize:function(t,e,i,s,a){for(var c=this.rcpScaleX,u=this.rcpScaleY,h=l(c/2),f=l(u/2),d=t.imageData.data,p=t.ctx.createImageData(s,a),g=p.data,m=0;m<a;m++)for(var v=0;v<s;v++){for(var y=4*(v+m*s),_=0,b=0,w=0,x=0,C=0,T=0,S=0,k=(m+.5)*u,O=n(m*u);O<(m+1)*u;O++)for(var j=o(k-(O+.5))/f,E=(v+.5)*c,A=j*j,P=n(v*c);P<(v+1)*c;P++){var D=o(E-(P+.5))/h,M=r(A+D*D);M>1&&M<-1||(_=2*M*M*M-3*M*M+1)>0&&(S+=_*d[(D=4*(P+O*e))+3],w+=_,d[D+3]<255&&(_=_*d[D+3]/250),x+=_*d[D],C+=_*d[D+1],T+=_*d[D+2],b+=_)}g[y]=x/b,g[y+1]=C/b,g[y+2]=T/b,g[y+3]=S/w}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Contrast=n(i.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,i=t.imageData.data,n=i.length,r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(e=0;e<n;e+=4)i[e]=o*(i[e]-128)+128,i[e+1]=o*(i[e+1]-128)+128,i[e+2]=o*(i[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Saturation=n(i.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,i,n=t.imageData.data,r=n.length,o=-this.saturation;for(e=0;e<r;e+=4)i=Math.max(n[e],n[e+1],n[e+2]),n[e]+=i!==n[e]?(i-n[e])*o:0,n[e+1]+=i!==n[e+1]?(i-n[e+1])*o:0,n[e+2]+=i!==n[e+2]?(i-n[e+2])*o:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Blur=n(i.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var i,n,r=t.filterBackend.resources,o=t.imageData.width,s=t.imageData.height;r.blurLayer1||(r.blurLayer1=e.util.createCanvasElement(),r.blurLayer2=e.util.createCanvasElement()),i=r.blurLayer1,n=r.blurLayer2,i.width===o&&i.height===s||(n.width=i.width=o,n.height=i.height=s);var a,l,c,u,h=i.getContext("2d"),f=n.getContext("2d"),d=.06*this.blur*.5;for(h.putImageData(t.imageData,0,0),f.clearRect(0,0,o,s),u=-15;u<=15;u++)c=d*(l=u/15)*o+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(l),f.drawImage(i,c,a),h.drawImage(n,0,0),f.globalAlpha=1,f.clearRect(0,0,n.width,n.height);for(u=-15;u<=15;u++)c=d*(l=u/15)*s+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(l),f.drawImage(i,a,c),h.drawImage(n,0,0),f.globalAlpha=1,f.clearRect(0,0,n.width,n.height);t.ctx.drawImage(i,0,0);var p=t.ctx.getImageData(0,0,i.width,i.height);return h.globalAlpha=1,h.clearRect(0,0,i.width,i.height),p},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var i=this.chooseRightDelta();t.uniform2fv(e.delta,i)},chooseRightDelta:function(){var t,e=1,i=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?i[0]=t:i[1]=t,i}}),i.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Gamma=n(i.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,i=t.imageData.data,n=this.gamma,r=i.length,o=1/n[0],s=1/n[1],a=1/n[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,r=256;e<r;e++)this.rVals[e]=255*Math.pow(e/255,o),this.gVals[e]=255*Math.pow(e/255,s),this.bVals[e]=255*Math.pow(e/255,a);for(e=0,r=i.length;e<r;e+=4)i[e]=this.rVals[i[e]],i[e+1]=this.gVals[i[e+1]],i[e+2]=this.bVals[i[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Composed=n(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,i){var n=(t.subFilters||[]).map((function(t){return new e.Image.filters[t.type](t)})),r=new e.Image.filters.Composed({subFilters:n});return i&&i(r),r}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.HueRotation=n(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,i=e.util.cos(t),n=e.util.sin(t),r=Math.sqrt(1/3)*n,o=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+o/3,this.matrix[1]=1/3*o-r,this.matrix[2]=1/3*o+r,this.matrix[5]=1/3*o+r,this.matrix[6]=i+1/3*o,this.matrix[7]=1/3*o-r,this.matrix[10]=1/3*o-r,this.matrix[11]=1/3*o+r,this.matrix[12]=i+1/3*o},isNeutralState:function(t){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone;e.Text?e.warn("fabric.Text is already defined"):(e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),cacheProperties:e.Object.prototype.cacheProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,i,n,r,o,s,a=0,l=this._textLines.length;a<l;a++)if(("justify"===this.textAlign||a!==l-1&&!this.isEndOfWrapping(a))&&(n=0,r=this._textLines[a],(e=this.getLineWidth(a))<this.width&&(s=this.textLines[a].match(this._reSpacesAndTabs)))){i=s.length,t=(this.width-e)/i;for(var c=0,u=r.length;c<=u;c++)o=this.__charBounds[a][c],this._reSpaceAndTab.test(r[c])?(o.width+=t,o.kernedWidth+=t,o.left+=n,n+=t):o.left+=n}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,i){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,i)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,i=this._textLines.length;e<i;e++){var n=this.getLineWidth(e);n>t&&(t=n)}return t},_renderTextLine:function(t,e,i,n,r,o){this._renderChars(t,e,i,n,r,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,i,n,r,o,s,a=0,l=t.fillStyle,c=this._getLeftOffset(),u=this._getTopOffset(),h=0,f=0,d=0,p=this._textLines.length;d<p;d++)if(e=this.getHeightOfLine(d),this.textBackgroundColor||this.styleHas("textBackgroundColor",d)){n=this._textLines[d],i=this._getLineLeftOffset(d),f=0,h=0,r=this.getValueOfPropertyAt(d,0,"textBackgroundColor");for(var g=0,m=n.length;g<m;g++)o=this.__charBounds[d][g],(s=this.getValueOfPropertyAt(d,g,"textBackgroundColor"))!==r?(t.fillStyle=r,r&&t.fillRect(c+i+h,u+a,f,e/this.lineHeight),h=o.left,f=o.width,r=s):f+=o.kernedWidth;s&&(t.fillStyle=s,t.fillRect(c+i+h,u+a,f,e/this.lineHeight)),a+=e}else a+=e;t.fillStyle=l,this._removeShadow(t)}},getFontCache:function(t){var i=t.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var n=e.charWidthsCache[i],r=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return n[r]||(n[r]={}),n[r]},_applyCharStyles:function(t,e,i,n,r){this._setFillStyles(e,r),this._setStrokeStyles(e,r),e.font=this._getFontDeclaration(r)},_measureChar:function(t,e,i,n){var r,o,s,a,l=this.getFontCache(e),c=i+t,u=this._getFontDeclaration(e)===this._getFontDeclaration(n),h=e.fontSize/this.CACHE_FONT_SIZE;if(i&&void 0!==l[i]&&(s=l[i]),void 0!==l[t]&&(a=r=l[t]),u&&void 0!==l[c]&&(a=(o=l[c])-s),void 0===r||void 0===s||void 0===o){var f=this.getMeasuringContext();this._setTextStyles(f,e,!0)}return void 0===r&&(a=r=f.measureText(t).width,l[t]=r),void 0===s&&u&&i&&(s=f.measureText(i).width,l[i]=s),u&&void 0===o&&(o=f.measureText(c).width,l[c]=o,a=o-s),{width:r*h,kernedWidth:a*h}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var e,i,n,r,o=0,s=this._textLines[t],a=new Array(s.length);for(this.__charBounds[t]=a,e=0;e<s.length;e++)i=s[e],r=this._getGraphemeBox(i,t,e,n),a[e]=r,o+=r.kernedWidth,n=i;return a[e]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:o,numOfSpaces:0}},_getGraphemeBox:function(t,e,i,n,r){var o,s=this.getCompleteStyleDeclaration(e,i),a=n?this.getCompleteStyleDeclaration(e,i-1):{},l=this._measureChar(t,s,n,a),c=l.kernedWidth,u=l.width;0!==this.charSpacing&&(u+=o=this._getWidthOfCharSpacing(),c+=o);var h={width:u,left:0,height:s.fontSize,kernedWidth:c,deltaY:s.deltaY};if(i>0&&!r){var f=this.__charBounds[e][i-1];h.left=f.left+f.width+l.kernedWidth-l.width}return h},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],i=this.getHeightOfChar(t,0),n=1,r=e.length;n<r;n++)i=Math.max(this.getHeightOfChar(t,n),i);return this.__lineHeights[t]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,i=0,n=this._textLines.length;i<n;i++)t=this.getHeightOfLine(i),e+=i===n-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var i=0,n=this._getLeftOffset(),r=this._getTopOffset(),o=this._applyPatternGradientTransform(t,"fillText"===e?this.fill:this.stroke),s=0,a=this._textLines.length;s<a;s++){var l=this.getHeightOfLine(s),c=l/this.lineHeight,u=this._getLineLeftOffset(s);this._renderTextLine(e,t,this._textLines[s],n+u-o.offsetX,r+i+c-o.offsetY,s),i+=l}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,i,n,r,o){var s,a,l,c,u=this.getHeightOfLine(o),h=-1!==this.textAlign.indexOf("justify"),f="",d=0,p=!h&&0===this.charSpacing&&this.isEmptyStyles(o);if(e.save(),r-=u*this._fontSizeFraction/this.lineHeight,p)return this._renderChar(t,e,o,0,this.textLines[o],n,r,u),void e.restore();for(var g=0,m=i.length-1;g<=m;g++)c=g===m||this.charSpacing,f+=i[g],l=this.__charBounds[o][g],0===d?(n+=l.kernedWidth-l.width,d+=l.width):d+=l.kernedWidth,h&&!c&&this._reSpaceAndTab.test(i[g])&&(c=!0),c||(s=s||this.getCompleteStyleDeclaration(o,g),a=this.getCompleteStyleDeclaration(o,g+1),c=this._hasStyleChanged(s,a)),c&&(this._renderChar(t,e,o,g,f,n,r,u),f="",s=a,n+=d,d=0);e.restore()},_renderChar:function(t,e,i,n,r,o,s){var a=this._getStyleDeclaration(i,n),l=this.getCompleteStyleDeclaration(i,n),c="fillText"===t&&l.fill,u="strokeText"===t&&l.stroke&&l.strokeWidth;(u||c)&&(a&&e.save(),this._applyCharStyles(t,e,i,n,l),a&&a.textBackgroundColor&&this._removeShadow(e),a&&a.deltaY&&(s+=a.deltaY),c&&e.fillText(r,o,s),u&&e.strokeText(r,o,s),a&&e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,i){var n=this.get2DCursorLocation(t,!0),r=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),o=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),s={fontSize:r*i.size,deltaY:o+r*i.baseline};return this.setSelectionStyles(s,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]?this.__lineWidths[t]:(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e,e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,i){var n=this._getStyleDeclaration(t,e);return n&&void 0!==n[i]?n[i]:this[i]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var i,n,r,o,s,a,l,c,u,h,f,d,p,g,m,v,y=this._getLeftOffset(),_=this._getTopOffset(),b=this._getWidthOfCharSpacing(),w=0,x=this._textLines.length;w<x;w++)if(i=this.getHeightOfLine(w),this[e]||this.styleHas(e,w)){l=this._textLines[w],g=i/this.lineHeight,o=this._getLineLeftOffset(w),h=0,f=0,c=this.getValueOfPropertyAt(w,0,e),v=this.getValueOfPropertyAt(w,0,"fill"),u=_+g*(1-this._fontSizeFraction),n=this.getHeightOfChar(w,0),s=this.getValueOfPropertyAt(w,0,"deltaY");for(var C=0,T=l.length;C<T;C++)d=this.__charBounds[w][C],p=this.getValueOfPropertyAt(w,C,e),m=this.getValueOfPropertyAt(w,C,"fill"),r=this.getHeightOfChar(w,C),a=this.getValueOfPropertyAt(w,C,"deltaY"),(p!==c||m!==v||r!==n||a!==s)&&f>0?(t.fillStyle=v,c&&v&&t.fillRect(y+o+h,u+this.offsets[e]*n+s,f,this.fontSize/15),h=d.left,f=d.width,c=p,v=m,n=r,s=a):f+=d.kernedWidth;t.fillStyle=m,p&&m&&t.fillRect(y+o+h,u+this.offsets[e]*n+s,f-b,this.fontSize/15),_+=i}else _+=i;this._removeShadow(t)}},_getFontDeclaration:function(t,i){var n=t||this,r=this.fontFamily,o=e.Text.genericFonts.indexOf(r.toLowerCase())>-1,s=void 0===r||r.indexOf("'")>-1||r.indexOf(",")>-1||r.indexOf('"')>-1||o?n.fontFamily:'"'+n.fontFamily+'"';return[e.isLikelyNode?n.fontWeight:n.fontStyle,e.isLikelyNode?n.fontStyle:n.fontWeight,i?this.CACHE_FONT_SIZE+"px":n.fontSize+"px",s].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var i=t.split(this._reNewline),n=new Array(i.length),r=["\n"],o=[],s=0;s<i.length;s++)n[s]=e.util.string.graphemeSplit(i[s]),o=o.concat(n[s],r);return o.pop(),{_unwrappedLines:n,lines:i,graphemeText:o,graphemeLines:n}},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),n=this.callSuper("toObject",e);return n.styles=i(this.styles,!0),n},set:function(t,e){this.callSuper("set",t,e);var i=!1;if("object"==typeof t)for(var n in t)i=i||-1!==this._dimensionAffectingProps.indexOf(n);else i=-1!==this._dimensionAffectingProps.indexOf(t);return i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,n,r){if(!t)return n(null);var o=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),s=o.textAnchor||"left";if((r=e.util.object.extend(r?i(r):{},o)).top=r.top||0,r.left=r.left||0,o.textDecoration){var a=o.textDecoration;-1!==a.indexOf("underline")&&(r.underline=!0),-1!==a.indexOf("overline")&&(r.overline=!0),-1!==a.indexOf("line-through")&&(r.linethrough=!0),delete r.textDecoration}"dx"in o&&(r.left+=o.dx),"dy"in o&&(r.top+=o.dy),"fontSize"in r||(r.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in t?l=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(l=t.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=r.strokeWidth;r.strokeWidth=0;var u=new e.Text(l,r),h=u.getScaledHeight()/u.height,f=((u.height+u.strokeWidth)*u.lineHeight-u.height)*h,d=u.getScaledHeight()+f,p=0;"center"===s&&(p=u.getScaledWidth()/2),"right"===s&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(d-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:void 0!==c?c:1}),n(u)},e.Text.fromObject=function(t,i){return e.Object._fromObject("Text",t,i,"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text))}(e),T.util.object.extend(T.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e=void 0===t?this.styles:{line:this.styles[t]};for(var i in e)for(var n in e[i])for(var r in e[i][n])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var i=void 0===e?this.styles:{0:this.styles[e]};for(var n in i)for(var r in i[n])if(void 0!==i[n][r][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,i,n=this.styles,r=0,o=!0,s=0;for(var a in n){for(var l in e=0,n[a]){var c;r++,(c=n[a][l]).hasOwnProperty(t)?(i?c[t]!==i&&(o=!1):i=c[t],c[t]===this[t]&&delete c[t]):o=!1,0!==Object.keys(c).length?e++:delete n[a][l]}0===e&&delete n[a]}for(var u=0;u<this._textLines.length;u++)s+=this._textLines[u].length;o&&r===s&&(this[t]=i,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,i,n,r=this.styles;for(i in r){for(n in e=r[i])delete e[n][t],0===Object.keys(e[n]).length&&delete e[n];0===Object.keys(e).length&&delete r[i]}}},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),T.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var i=e?this._unwrappedTextLines:this._textLines,n=i.length,r=0;r<n;r++){if(t<=i[r].length)return{lineIndex:r,charIndex:t};t-=i[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:i[r-1].length<t?i[r-1].length:t}},getSelectionStyles:function(t,e,i){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var n=[],r=t;r<e;r++)n.push(this.getStyleAtPosition(r,i));return n},getStyleAtPosition:function(t,e){var i=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex))||{}},setSelectionStyles:function(t,e,i){void 0===e&&(e=this.selectionStart||0),void 0===i&&(i=this.selectionEnd||e);for(var n=e;n<i;n++)this._extendStyles(n,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var i=this.styles&&this.styles[t];return i?i[e]:null},getCompleteStyleDeclaration:function(t,e){for(var i,n=this._getStyleDeclaration(t,e)||{},r={},o=0;o<this._styleProperties.length;o++)r[i=this._styleProperties[o]]=void 0===n[i]?this[i]:n[i];return r},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}T.IText=T.util.createClass(T.Text,T.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),i=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:e,top:i,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,i,n,r,o=0,s=0,a=this.get2DCursorLocation(t);n=a.charIndex,i=a.lineIndex;for(var l=0;l<i;l++)o+=this.getHeightOfLine(l);e=this._getLineLeftOffset(i);var c=this.__charBounds[i][n];return c&&(s=c.left),0!==this.charSpacing&&n===this._textLines[i].length&&(s-=this._getWidthOfCharSpacing()),r={top:o,left:e+(s>0?s:0)},this.cursorOffsetCache=r,this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),n=i.lineIndex,r=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(n,r,"fontSize"),s=this.scaleX*this.canvas.getZoom(),a=this.cursorWidth/s,l=t.topOffset,c=this.getValueOfPropertyAt(n,r,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.getValueOfPropertyAt(n,r,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-a/2,l+t.top+c,a,o)},renderSelection:function(t,e){for(var i=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(i),s=this.get2DCursorLocation(n),a=o.lineIndex,l=s.lineIndex,c=o.charIndex<0?0:o.charIndex,u=s.charIndex<0?0:s.charIndex,h=a;h<=l;h++){var f,d=this._getLineLeftOffset(h)||0,p=this.getHeightOfLine(h),g=0,m=0;if(h===a&&(g=this.__charBounds[a][c].left),h>=a&&h<l)m=r&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===l)if(0===u)m=this.__charBounds[l][u].left;else{var v=this._getWidthOfCharSpacing();m=this.__charBounds[l][u-1].left+this.__charBounds[l][u-1].width-v}f=p,(this.lineHeight<1||h===l&&this.lineHeight>1)&&(p/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+d+g,t.top+t.topOffset+p,m-g,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+d+g,t.top+t.topOffset,m-g,p)),t.topOffset+=f}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),T.IText.fromObject=function(e,i){if(t(e),e.styles)for(var n in e.styles)for(var r in e.styles[n])t(e.styles[n][r]);T.Object._fromObject("IText",e,i,"text")}}(),w=T.util.object.clone,T.util.object.extend(T.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],T.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,n){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){r.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),i)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this._text[t])?t-1:t,n=this._text[i],r=/[ \n\.,;!\?\-]/;!r.test(n)&&i>0&&i<this._text.length;)i+=e,n=this._text[i];return r.test(n)&&"\n"!==n&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,n=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&i!==n||i!==e&&n!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===n||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,i){var n=i.slice(0,t),r=T.util.string.graphemeSplit(n).length;if(t===e)return{selectionStart:r,selectionEnd:r};var o=i.slice(t,e);return{selectionStart:r,selectionEnd:r+T.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(t,e,i){var n=i.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+i.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),n=i.lineIndex,r=i.charIndex,o=this.getValueOfPropertyAt(n,r,"fontSize")*this.lineHeight,s=e.leftOffset,a=this.calcTransformMatrix(),l={x:e.left+s,y:e.top+e.topOffset+o},c=this.canvas.upperCanvasEl,u=c.width,h=c.height,f=u-o,d=h-o,p=c.clientWidth/u,g=c.clientHeight/h;return l=T.util.transformPoint(l,a),(l=T.util.transformPoint(l,this.canvas.viewportTransform)).x*=p,l.y*=g,l.x<0&&(l.x=0),l.x>f&&(l.x=f),l.y<0&&(l.y=0),l.y>d&&(l.y=d),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&(this.hiddenTextarea.blur&&this.hiddenTextarea.blur(),this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null),this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var i,n,r=this.get2DCursorLocation(t,!0),o=this.get2DCursorLocation(e,!0),s=r.lineIndex,a=r.charIndex,l=o.lineIndex,c=o.charIndex;if(s!==l){if(this.styles[s])for(i=a;i<this._unwrappedTextLines[s].length;i++)delete this.styles[s][i];if(this.styles[l])for(i=c;i<this._unwrappedTextLines[l].length;i++)(n=this.styles[l][i])&&(this.styles[s]||(this.styles[s]={}),this.styles[s][a+i-c]=n);for(i=s+1;i<=l;i++)delete this.styles[i];this.shiftLineStyles(l,s-l)}else if(this.styles[s]){n=this.styles[s];var u,h,f=c-a;for(i=a;i<c;i++)delete n[i];for(h in this.styles[s])(u=parseInt(h,10))>=c&&(n[u-f]=n[h],delete n[h])}},shiftLineStyles:function(t,e){var i=w(this.styles);for(var n in this.styles){var r=parseInt(n,10);r>t&&(this.styles[r+e]=i[r],i[r-e]||delete this.styles[r])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(t,e,i,n){var r,o={},s=!1;for(var a in i||(i=1),this.shiftLineStyles(t,i),this.styles[t]&&(r=this.styles[t][0===e?e:e-1]),this.styles[t]){var l=parseInt(a,10);l>=e&&(s=!0,o[l-e]=this.styles[t][a],delete this.styles[t][a])}for(s?this.styles[t+i]=o:delete this.styles[t+i];i>1;)i--,n&&n[i]?this.styles[t+i]={0:w(n[i])}:r?this.styles[t+i]={0:w(r)}:delete this.styles[t+i];this._forceClearCache=!0},insertCharStyleObject:function(t,e,i,n){this.styles||(this.styles={});var r=this.styles[t],o=r?w(r):{};for(var s in i||(i=1),o){var a=parseInt(s,10);a>=e&&(r[a+i]=o[a],o[a-i]||delete r[a])}if(this._forceClearCache=!0,n)for(;i--;)Object.keys(n[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]=w(n[i]));else if(r)for(var l=r[e?e-1:1];l&&i--;)this.styles[t][e+i]=w(l)},insertNewStyleBlock:function(t,e,i){for(var n=this.get2DCursorLocation(e,!0),r=[0],o=0,s=0;s<t.length;s++)"\n"===t[s]?r[++o]=0:r[o]++;for(r[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,r[0],i),i=i&&i.slice(r[0]+1)),o&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+r[0],o),s=1;s<o;s++)r[s]>0?this.insertCharStyleObject(n.lineIndex+s,0,r[s],i):i&&(this.styles[n.lineIndex+s][0]=i[0]),i=i&&i.slice(r[s]+1);r[s]>0&&this.insertCharStyleObject(n.lineIndex+s,0,r[s],i)},setSelectionStartEndWithShift:function(t,e,i){i<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}}),T.util.object.extend(T.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("mousedblclick",(function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))})),this.on("tripleclick",(function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))}))},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||this===this.canvas._activeObject&&(this.selected=!0)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),i=0,n=0,r=0,o=0,s=0,a=0,l=this._textLines.length;a<l&&r<=e.y;a++)r+=this.getHeightOfLine(a)*this.scaleY,s=a,a>0&&(o+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));n=this._getLineLeftOffset(s)*this.scaleX;for(var c=0,u=this._textLines[s].length;c<u&&(i=n,(n+=this.__charBounds[s][c].kernedWidth*this.scaleX)<=e.x);c++)o++;return this._getNewSelectionStartFromOffset(e,i,n,o,u)},_getNewSelectionStartFromOffset:function(t,e,i,n,r){var o=t.x-e,s=i-t.x,a=n+(s>o||s<0?0:1);return this.flipX&&(a=r-a),a>this._text.length&&(a=this._text.length),a}}),T.util.object.extend(T.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=T.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+t.fontSize+";",T.document.body.appendChild(this.hiddenTextarea),T.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),T.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),T.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),T.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),T.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),T.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),T.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),T.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),T.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(T.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing&&!this.inCompositionMode){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey)))return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var i,n,r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,s=r.length,a=s-o;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var l=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),c=this.selectionStart>l.selectionStart;this.selectionStart!==this.selectionEnd?(i=this._text.slice(this.selectionStart,this.selectionEnd),a+=this.selectionEnd-this.selectionStart):s<o&&(i=c?this._text.slice(this.selectionEnd+a,this.selectionEnd):this._text.slice(this.selectionStart,this.selectionStart-a)),n=r.slice(l.selectionEnd-a,l.selectionEnd),i&&i.length&&(this.selectionStart!==this.selectionEnd?this.removeStyleFromTo(this.selectionStart,this.selectionEnd):c?this.removeStyleFromTo(this.selectionEnd-i.length,this.selectionEnd):this.removeStyleFromTo(this.selectionEnd,this.selectionEnd+i.length)),n.length&&(e&&n.join("")===T.copiedText&&!T.disableStyleCopyPaste?this.insertNewStyleBlock(n,this.selectionStart,T.copiedTextStyle):this.insertNewStyleBlock(n,this.selectionStart)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(T.copiedText=this.getSelectedText(),T.disableStyleCopyPaste?T.copiedTextStyle=null:T.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||T.window.clipboardData},_getWidthBeforeCursor:function(t,e){var i,n=this._getLineLeftOffset(t);return e>0&&(n+=(i=this.__charBounds[t][e-1]).left+i.width),n},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),r=n.lineIndex;if(r===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-i;var o=n.charIndex,s=this._getWidthBeforeCursor(r,o),a=this._getIndexOnLine(r+1,s);return this._textLines[r].slice(o).length+a+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),r=n.lineIndex;if(0===r||t.metaKey||33===t.keyCode)return-i;var o=n.charIndex,s=this._getWidthBeforeCursor(r,o),a=this._getIndexOnLine(r-1,s),l=this._textLines[r].slice(0,o),c=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+a-l.length+(1-c)},_getIndexOnLine:function(t,e){for(var i,n,r=this._textLines[t],o=this._getLineLeftOffset(t),s=0,a=0,l=r.length;a<l;a++)if((o+=i=this.__charBounds[t][a].width)>e){n=!0;var c=o-i,u=o,h=Math.abs(c-e);s=Math.abs(u-e)<h?a:a-1;break}return n||(s=r.length-1),s},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var i=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),0!==i&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var n;if(t.altKey)n=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;n=this["findLineBoundary"+i](this[e])}if(void 0!==typeof n&&this[e]!==n)return this[e]=n,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var i="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?i+="Shift":i+="outShift",this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){void 0===e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,i,n){void 0===n&&(n=i),n>i&&this.removeStyleFromTo(i,n);var r=T.util.string.graphemeSplit(t);this.insertNewStyleBlock(r,i,e),this._text=[].concat(this._text.slice(0,i),r,this._text.slice(n)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),x=T.util.toFixed,C=/  +/g,T.util.object.extend(T.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var i,n=[],r=[],o=t;this._setSVGBg(r);for(var s=0,a=this._textLines.length;s<a;s++)i=this._getLineLeftOffset(s),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(r,s,e+i,o),this._setSVGTextLineText(n,s,e+i,o),o+=this.getHeightOfLine(s);return{textSpans:n,textBgRects:r}},_createTextCharSpan:function(t,e,i,n){var r=t!==t.trim()||t.match(C),o=this.getSvgSpanStyles(e,r),s=o?'style="'+o+'"':"",a=e.deltaY,l="",c=T.Object.NUM_FRACTION_DIGITS;return a&&(l=' dy="'+x(a,c)+'" '),['<tspan x="',x(i,c),'" y="',x(n,c),'" ',l,s,">",T.util.string.escapeXml(t),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,i,n){var r,o,s,a,l,c=this.getHeightOfLine(e),u=-1!==this.textAlign.indexOf("justify"),h="",f=0,d=this._textLines[e];n+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,g=d.length-1;p<=g;p++)l=p===g||this.charSpacing,h+=d[p],s=this.__charBounds[e][p],0===f?(i+=s.kernedWidth-s.width,f+=s.width):f+=s.kernedWidth,u&&!l&&this._reSpaceAndTab.test(d[p])&&(l=!0),l||(r=r||this.getCompleteStyleDeclaration(e,p),o=this.getCompleteStyleDeclaration(e,p+1),l=this._hasStyleChangedForSvg(r,o)),l&&(a=this._getStyleDeclaration(e,p)||{},t.push(this._createTextCharSpan(h,a,i,n)),h="",r=o,i+=f,f=0)},_pushTextBgRect:function(t,e,i,n,r,o){var s=T.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(e),' x="',x(i,s),'" y="',x(n,s),'" width="',x(r,s),'" height="',x(o,s),'"></rect>\n')},_setSVGTextLineBg:function(t,e,i,n){for(var r,o,s=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight,l=0,c=0,u=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),h=0,f=s.length;h<f;h++)r=this.__charBounds[e][h],(o=this.getValueOfPropertyAt(e,h,"textBackgroundColor"))!==u?(u&&this._pushTextBgRect(t,u,i+c,n,l,a),c=r.left,l=r.width,u=o):l+=r.kernedWidth;o&&this._pushTextBgRect(t,o,i+c,n,l,a)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new T.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,i=0,n=0;n<t;n++)i+=this.getHeightOfLine(n);return e=this.getHeightOfLine(n),{lineTop:i,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return T.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}}),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,i=0,n=0,r={},o=0;o<t.graphemeLines.length;o++)"\n"===t.graphemeText[n]&&o>0?(i=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&o>0&&(i++,n++),r[o]={line:e,offset:i},n+=t.graphemeLines[o].length,i+=t.graphemeLines[o].length;return r},styleHas:function(t,i){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];n&&(i=n.line)}return e.Text.prototype.styleHas.call(this,t,i)},isEmptyStyles:function(t){var e,i,n=0,r=!1,o=this._styleMap[t],s=this._styleMap[t+1];for(var a in o&&(t=o.line,n=o.offset),s&&(r=s.line===t,e=s.offset),i=void 0===t?this.styles:{line:this.styles[t]})for(var l in i[a])if(l>=n&&(!r||l<e))for(var c in i[a][l])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[t];if(!i)return null;t=i.line,e=i.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,i){var n=this._styleMap[t];t=n.line,e=n.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var i,n=[];for(this.isWrapping=!0,i=0;i<t.length;i++)n=n.concat(this._wrapLine(t[i],i,e));return this.isWrapping=!1,n},_measureWord:function(t,e,i){var n,r=0;i=i||0;for(var o=0,s=t.length;o<s;o++){r+=this._getGraphemeBox(t[o],e,o+i,n,!0).kernedWidth,n=t[o]}return r},_wrapLine:function(t,i,n,r){var o=0,s=this.splitByGrapheme,a=[],l=[],c=s?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),u="",h=0,f=s?"":" ",d=0,p=0,g=0,m=!0,v=s?0:this._getWidthOfCharSpacing();r=r||0;0===c.length&&c.push([]),n-=r;for(var y=0;y<c.length;y++)u=s?c[y]:e.util.string.graphemeSplit(c[y]),d=this._measureWord(u,i,h),h+=u.length,(o+=p+d-v)>=n&&!m?(a.push(l),l=[],o=d,m=!0):o+=v,m||s||l.push(f),l=l.concat(u),p=this._measureWord([f],i,h),h++,m=!1,d>g&&(g=d);return y&&a.push(l),g+r>this.dynamicMinWidth&&(this.dynamicMinWidth=g-v+r),a},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var i=e.Text.prototype._splitTextIntoLines.call(this,t),n=this._wrapText(i.lines,this.width),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n[o].join("");return i.lines=r,i.graphemeLines=n,i},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,i){return e.Object._fromObject("Textbox",t,i,"text")}}(e)}).call(this,i(16).Buffer)},function(t,e,i){"use strict";i.r(e);var n=i(14),r={token:null,global:{curMode:null,data:null,liveData:{liveId:0,courseId:0}},player:{techOrder:null,status:null,withUi:!1},video:{poster:null,autoplay:!0,controls:!1}},o=i(2),s=i(0),a=i.n(s);const l={[o.UPDATE_TOKEN](t,e){t.token=e},[o.UPDATE_INIT_DATA](t,e){t.global.data=e},[o.UPDATE_LIVE_DATA](t,e){t.global.liveData=e},[o.UPDATE_LIVE_MODE](t,e){t.global.curMode=e},[o.UPDATE_LIVE_STATUS](t,e){t.player.status=e}};var c={commit(t,e){if(a.a.debug("Commit =>",t,e),l[o[t]])return l[o[t]].call(this,r,e);throw new Error(`${t} mutations 未定义,请检查...`)}},u={getToken:()=>r.token,getInitData:()=>r.global.data},h=i(20),f=i.n(h),d=i(3),p=i.n(d);f.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",f.a.defaults.transformRequest=[function(t){let e="";for(const i in t)e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i])+"&";return e=e.replace(/\&$/,"")}];const g=f.a.create({baseURL:p.a.PROTOCOL+p.a.APP_DOMAIN,timeout:5e3});g.interceptors.request.use(t=>t,t=>Promise.reject(t)),g.interceptors.response.use(t=>{const e=t.data;return 0!==e.code?(console.warn({message:e.msg||"Error",type:"error",duration:5e3}),Promise.reject(new Error(e.msg||"Error"))):e},t=>(console.error("❌系统错误,请重新登陆⚠️"+t),console.warn({message:t.message,type:"error",duration:5e3}),Promise.reject(t)));var m=g;const v={[o.GET_CHAT_LIST]:(t,e)=>(()=>m({method:"GET",url:"/playback/chat.php",params:{access_token:b.state().token,"51test":window.location.href.indexOf("51test")>-1?1:null}}))()};var y={dispatch(t,e){if(a.a.debug("Dispatch =>",t,e,o[t]),v[t])return v[t].call(this,r,e);throw new Error(`${t} Action未定义,请检查...`)}};const _={init(){a.a.debug("Store init done ==>",r),this.observe()},getters:t=>"function"==typeof u[t]?u[t]():null,state:()=>r,dispatch(t,e){return y.dispatch.apply(y,arguments)},commit(t,e){return c.commit.apply(c,arguments)},observe(){Object(n.watch)(r,"token",(t,e)=>{}),Object(n.watch)(r.global,"curMode",(t,e)=>{}),Object(n.watch)(r.global,"data",(t,e)=>{}),Object(n.watch)(r.player,"status",(t,e)=>{})}};window.__vstore__=_;var b=e.default=_},function(t,e,i){var n;void 0===(n=function(t){var e=i(3),n=i(15),r=e.PROTOCOL+"log.talk-fun.com",o={srcUrl:null,sdkVersion:null,setBaseParam:function(t){t.sdkVersion&&(this.sdkVersion=t.sdkVersion),t.srcUrl&&(this.srcUrl=window.encodeURIComponent(t.srcUrl))},init:function(t){this.logConfig=t},socket:function(t){this.logConfig&&this.logConfig.socket&&n.ajax({type:"GET",url:r+"/stats/socket.html",data:t})},play:function(t){this.sdkVersion&&(t.sdkVersion=this.sdkVersion),this.srcUrl&&(t.srcUrl=this.srcUrl),n.ajax({type:"GET",url:r+"/stats/play.html",data:t})},errorReport:function(t){"undefined"!=typeof access_token&&(t.access_token=access_token),t.__type="jserror",n.ajax({type:"GET",url:r+"/stats.html",data:t})}},s={};return window.onerror=function(){var t=["Error","Script","Line","Column","StackTrace"],e="",i=arguments.length;i>5&&(i=5);for(var n=0;n<i;n++)e=e+"|"+t[n]+": "+arguments[n];var r={type:"JS-ERROR-LOG",msg:e};void 0===s[r.msg]&&(o.errorReport(r),s[r.msg]=1)},o}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){(function(n){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;e.splice(1,0,i,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(r=n))}),e.splice(r,0,i)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=i(81)(e);const{formatters:r}=t.exports;r.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,i(21))},function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){var e,i,n,r,o,s;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(s=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)o=t[e],s.set(o,r),r+=o.length;return s}},s={arraySet:function(t,e,i,n,r){for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(n)},function(t,e,i){var n;void 0===(n=function(t){var e=i(1),n=i(3),r=i(0);return{playType:"live",vodPlayer:null,currentMediaSourceIndex:0,mainContainerId:null,curMeidaData:null,mode:0,containers:{},playStatus:"wait",currentMode:"0",COMMAND:{START:"start",STOP:"stop",WAIT:"wait",GRAFFITI:1,RUBBER:26,IMAGE:11,TEXT:15,CIRCLE:16,RECTANGLE:17,LINE:18,ERASER:20,DRAW:25,DRAW_LIST:31,PAGE:51,ARROW:19,DOTTED_LINE:21,PPTCLEAR:3,CAMERA_START:101,CAMERA_STOP:102,VIDEO_START:103,VIDEO_STOP:104,MODE_CHANGE:151,DESKTOP_START:201,DESKTOP_STOP:202,DESKTOP_PAUSE:203,IMAGE_PRELOAD:1111,LIVE_POWER_CHANGE:161,POINTER:1112},constant:{MODE_EDUCATION:0,MODE_VIDEO:1,MODE_DESKTOP:2,MODE_NAME:{0:"课件模式",1:"视频分享模式",2:"桌面分享模式"}},setFlvPlayer:function(t){this.flvPlayer||(this.flvPlayer=t)},commonEventListener:function(t){t.addEventListener("x5videoenterfullscreen",(function(){t.play(),r.debug("wx fullscreen enter..."),e.get("wx:enter:fullscreen")()}),!1),t.addEventListener("x5videoexitfullscreen",(function(){t.play(),r.debug("wx fullscreen exit..."),e.get("wx:exit:fullscreen")()}),!1)},settingMaps:{emotions:null},config:function(t){"object"==typeof t&&t.playType&&(this.playType=t.playType)},setting:function(t,e){t||(t=""),this.settingMaps.hasOwnProperty(t)?this.settingMaps[t]=e:r.debug("配置非法属性 ==> "+t)},getSetting:function(t){if("string"==typeof t)return this.settingMaps[t]},initConfig:null,initialize:function(){this.mainContainerId&&(document.getElementById(this.mainContainerId).innerHTML="")},setPlayerStatus:function(t){this.playStatus=t},isForceAudio:function(t){return!(!this.initConfig||!this.initConfig.forceAudio)&&(!t||"start"!==t)},isForceVideo:function(){return!(!this.initConfig||!this.initConfig.forceVideo)},getContainerId:function(t){return"mt-container-"+t},getContainer:function(t){var e=this.getContainerId(t),i=document.getElementById(e),n=document.querySelector("#tf-style-container"),r=document.getElementById(this.mainContainerId);if(!r)return!1;if(!n){var o=document.createElement("style");o.type="text/css",o.id="tf-style-container",document.head.appendChild(o),n=document.querySelector("#tf-style-container")}return i||((i=document.createElement("div")).id=e,n.sheet.addRule("#"+i.id,"width: 100%; height: 100%; overflow: hidden;"),r&&document.getElementById(this.mainContainerId).appendChild(i)),i},modeChange:function(t,i){var n=t.c.split("|"),o=n[0],s=n[1],a=n[1];this.baseCurrentMode=s,o==this.constant.MODE_VIDEO&&(o=this.constant.MODE_DESKTOP),s==this.constant.MODE_VIDEO&&(s=this.constant.MODE_DESKTOP),this.beforeMode=o,this.currentMode=s,this.getContainer(o)&&(this.getContainer(o).style.height="1px",this.getContainer(o).style.overflow="hidden",this.getContainer(o).style.visibility="hidden",r.isMobile()&&(this.getContainer(o).style.display="none")),this.getContainer(s)&&(this.getContainer(s).style.height="100%",this.getContainer(s).style.visibility="visible",r.isMobile()&&(this.getContainer(s).style.display="block")),e.get("live:mode:change")({beforeMode:o,currentMode:s,sourceMode:a}),i&&i(o,s)},getFlvVideoUrl:function(t){return n.PROTOCOL+this.stream2flv(t)},getVideoUrl:function(t){var e=t;return r.debug("stream content => ",e),"playback"==this.playType?e:n.PROTOCOL+this.stream2m3u8(e)},stream2m3u8:function(t){return t.hosts.hls+t.domain+"/"+t.app+"/"+t.path+"/"+t.ext.m3u8+(t.query.length>0?"?"+t.query:"")},stream2flv:function(t){var e;return e=t.hosts.flv+t.domain+"/"+t.app+"/"+t.path+t.ext.flv+(t.query.length>0?"?"+query:""),r.debug("get flv url ==>",n.PROTOCOL+e),e},removePlayIcon:function(t){var e=document.querySelector("#tf-xplay-icon");e&&(e.parentNode.removeChild(e),t&&(t.style.width="100%",t.style.height="100%"))},getPlayIcon:function(t){if(document.querySelector("#tf-xplay-icon")||!t)return!1;var e=this,i=r.touchSupport()?"touchend":"click",o=document.createElement("div");o.id="tf-xplay-icon",o.style.position="relative",o.style.width="100%",o.style.height="100%",o.style["z-index"]="100",o.style.top="0",o.style.left="0",o.style.cursor="pointer",o.style.cssText+="background-image: url("+n.player.PLAY_ICON+");background-color: #2f2f2f;background-repeat: no-repeat; background-position: 50% 50%;",t.style.width="1px",t.style.height="1px",t.parentNode.style.width="100%",t.parentNode.style.height="100%",t.parentNode.appendChild(o),o.addEventListener(i,(function(){t.play().then((function(){t.style.width="100%",t.style.height="100%",e.flvPlayer&&e.flvPlayer.play(!0)})),o.removeEventListener(i,null,!1),o.parentNode.removeChild(this)}),!1)},elementPlay:function(t,i){if(t){var n=this;void 0!==t?t.play().then((function(){n.setPlayerStatus("playing"),r.debug("H5 player is playing."),e.get("live:video:onplay")(),n.removePlayIcon(t),r.callback(i,"play")})).catch((function(o){n.setPlayerStatus("error"),r.debug("h5 player play error! Autoplay disabled!",o),e.get("live:video:pause")(),n.getPlayIcon(t),r.callback(i,"error")})):t.play()}},mediaValidate:function(t,e){if(!this.curMeidaData.detail)return!1;var i=t-this.curMeidaData.detail.duration,n=e;r.debug("验证视频时长 ===> 偏差"+i+"秒."),this.vodPlayer.vodLiveType?n(!0):i>this.vodPlayer.live.timeDiffLimit?(this.currentMediaSourceIndex+=1,this.currentMediaSourceIndex>this.curMeidaData.detail.allUrl.length&&(this.currentMediaSourceIndex=this.curMeidaData.detail.allUrl.length-1),this.vodPlayer.changeSource(this.currentMediaSourceIndex),n(!1)):n(!0)},getVideoSource:function(t){if(r.debug("getVideoSource ==> "+t),!t)return!1;var e=[];if(/\.m3u8/gi.test(t)){var i={type:"application/x-mpegURL",src:t};e.push(i)}else{for(var n=["mp4","mov","webm","ogv","hts"],o=0;o<n.length;o++){var s={},a=n[o];s.type="video/"+a,s.src=t.replace(/\.mp4/gi,"."+a),e.push(s)}r.debug("vod socure ===>",e)}return e},isOpenSafariVideo:function(){return!(!this.initConfig||!this.initConfig.safariOpenVideo)},isCreateAudio:function(){return!!r.isIphone()&&!(r.isQQMobile()||this.isOpenSafariVideo()||r.getPlatformInfo().version>10)}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<n.length;r++)if((i=n[r])===e||i.fn===e){n.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,r=(i=i.slice(0)).length;n<r;++n)i[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){var n,r=i(94),o=i(42),s=i(95),a=i(96),l=i(97);"undefined"!=typeof ArrayBuffer&&(n=i(98));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=c||u;e.protocol=3;var f=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=r(f),p={type:"error",data:"parser error"},g=i(99);function m(t,e,i){for(var n=new Array(t.length),r=a(t.length,i),o=function(t,i,r){e(i,(function(e,i){n[t]=i,r(e,n)}))},s=0;s<t.length;s++)o(s,t[s],r)}e.encodePacket=function(t,i,n,r){"function"==typeof i&&(r=i,i=!1),"function"==typeof n&&(r=n,n=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=f[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}(t,i,r);if(void 0!==g&&o instanceof g)return function(t,i,n){if(!i)return e.encodeBase64Packet(t,n);if(h)return function(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=new FileReader;return r.onload=function(){e.encodePacket({type:t.type,data:r.result},i,!0,n)},r.readAsArrayBuffer(t.data)}(t,i,n);var r=new Uint8Array(1);r[0]=f[t.type];var o=new g([r.buffer,t.data]);return n(o)}(t,i,r);if(o&&o.base64)return function(t,i){var n="b"+e.packets[t.type]+t.data.data;return i(n)}(t,r);var s=f[t.type];return void 0!==t.data&&(s+=n?l.encode(String(t.data),{strict:!1}):String(t.data)),r(""+s)},e.encodeBase64Packet=function(t,i){var n,r="b"+e.packets[t.type];if(void 0!==g&&t.data instanceof g){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];i(r+t)},o.readAsDataURL(t.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),l=0;l<s.length;l++)a[l]=s[l];n=String.fromCharCode.apply(null,a)}return r+=btoa(n),i(r)},e.decodePacket=function(t,i,n){if(void 0===t)return p;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),i);if(n&&!1===(t=function(t){try{t=l.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var r=t.charAt(0);return Number(r)==r&&d[r]?t.length>1?{type:d[r],data:t.substring(1)}:{type:d[r]}:p}r=new Uint8Array(t)[0];var o=s(t,1);return g&&"blob"===i&&(o=new g([o])),{type:d[r],data:o}},e.decodeBase64Packet=function(t,e){var i=d[t.charAt(0)];if(!n)return{type:i,data:{base64:!0,data:t.substr(1)}};var r=n.decode(t.substr(1));return"blob"===e&&g&&(r=new g([r])),{type:i,data:r}},e.encodePayload=function(t,i,n){"function"==typeof i&&(n=i,i=null);var r=o(t);if(i&&r)return g&&!h?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n);if(!t.length)return n("0:");m(t,(function(t,n){e.encodePacket(t,!!r&&i,!1,(function(t){n(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return n(e.join(""))}))},e.decodePayload=function(t,i,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,i,n);var r;if("function"==typeof i&&(n=i,i=null),""===t)return n(p,0,1);for(var o,s,a="",l=0,c=t.length;l<c;l++){var u=t.charAt(l);if(":"===u){if(""===a||a!=(o=Number(a)))return n(p,0,1);if(a!=(s=t.substr(l+1,o)).length)return n(p,0,1);if(s.length){if(r=e.decodePacket(s,i,!1),p.type===r.type&&p.data===r.data)return n(p,0,1);if(!1===n(r,l+o,c))return}l+=o,a=""}else a+=u}return""!==a?n(p,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,i){if(!t.length)return i(new ArrayBuffer(0));m(t,(function(t,i){e.encodePacket(t,!0,!0,(function(t){return i(null,t)}))}),(function(t,e){var n=e.reduce((function(t,e){var i;return t+(i="string"==typeof e?e.length:e.byteLength).toString().length+i+2}),0),r=new Uint8Array(n),o=0;return e.forEach((function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);i=n.buffer}r[o++]=e?0:1;var a=i.byteLength.toString();for(s=0;s<a.length;s++)r[o++]=parseInt(a[s]);r[o++]=255;for(n=new Uint8Array(i),s=0;s<n.length;s++)r[o++]=n[s]})),i(r.buffer)}))},e.encodePayloadAsBlob=function(t,i){m(t,(function(t,i){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);t=n.buffer,e[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)s[r]=parseInt(o[r]);if(s[o.length]=255,g){var a=new g([e.buffer,s.buffer,t]);i(null,a)}}))}),(function(t,e){return i(new g(e))}))},e.decodePayloadAsBinary=function(t,i,n){"function"==typeof i&&(n=i,i=null);for(var r=t,o=[];r.byteLength>0;){for(var a=new Uint8Array(r),l=0===a[0],c="",u=1;255!==a[u];u++){if(c.length>310)return n(p,0,1);c+=a[u]}r=s(r,2+c.length),c=parseInt(c);var h=s(r,0,c);if(l)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(t){var f=new Uint8Array(h);h="";for(u=0;u<f.length;u++)h+=String.fromCharCode(f[u])}o.push(h),r=s(r,c)}var d=o.length;o.forEach((function(t,r){n(e.decodePacket(t,i,!0),r,d)}))}},function(t,e,i){var n;void 0===(n=function(t){let e=i(61),n=i(78);return{vote:e,flower:i(79),lottery:n}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.unwatch=e.watch=void 0;var r=n(i(4)),o=n(i(3)),s=(e.watch=function(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];var n=e[1];l(n)?g.apply(void 0,e):s(n)?v.apply(void 0,e):m.apply(void 0,e)},e.unwatch=function(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];var n=e[1];l(n)||void 0===n?b.apply(void 0,e):s(n)?_.apply(void 0,e):y.apply(void 0,e)},function(t){return"[object Array]"==={}.toString.call(t)}),a=function(t){return"[object Object]"==={}.toString.call(t)},l=function(t){return"[object Function]"==={}.toString.call(t)},c=function(t,e,i){(0,o.default)(t,e,{enumerable:!1,configurable:!0,writable:!1,value:i})},u=function(t,e,i,n,r){var o,s=t.__watchers__[e];(o=t.__watchers__.__watchall__)&&(s=s?s.concat(o):o);for(var a=s?s.length:0,l=0;a>l;l++)s[l].call(t,i,n,e,r)},h=["pop","push","reverse","shift","sort","unshift","splice"],f=function(t,e,i,n){c(t,i,(function(){for(var r=0,o=void 0,s=void 0,a=arguments.length,l=Array(a),c=0;a>c;c++)l[c]=arguments[c];if("splice"===i){var u=l[0],h=u+l[1];o=t.slice(u,h),s=[];for(var f=2;f<l.length;f++)s[f-2]=l[f];r=u}else s="push"===i||"unshift"===i?l.length>0?l:void 0:l.length>0?l[0]:void 0;var d=e.apply(t,l);return"pop"===i?(o=d,r=t.length):"push"===i?r=t.length-1:"shift"===i?o=d:"unshift"!==i&&void 0===s&&(s=d),n.call(t,r,i,s,o),d}))},d=function(t,e){if(l(e)&&t&&!(t instanceof String)&&s(t))for(var i=h.length;i>0;i--){var n=h[i-1];f(t,t[n],n,e)}},p=function(t,e,i,n){var l=!1,h=s(t);void 0===t.__watchers__&&(c(t,"__watchers__",{}),h&&d(t,(function(i,r,o,l){if(u(t,i,o,l,r),0!==n&&o&&(a(o)||s(o))){var c,h=t.__watchers__[e];(c=t.__watchers__.__watchall__)&&(h=h?h.concat(c):c);for(var f=h?h.length:0,d=0;f>d;d++)if("splice"!==r)g(o,h[d],void 0===n?n:n-1);else for(var p=0;p<o.length;p++)g(o[p],h[d],void 0===n?n:n-1)}}))),void 0===t.__proxy__&&c(t,"__proxy__",{}),void 0===t.__watchers__[e]&&(t.__watchers__[e]=[],h||(l=!0));for(var f=0;f<t.__watchers__[e].length;f++)if(t.__watchers__[e][f]===i)return;t.__watchers__[e].push(i),l&&function(){var i=(0,r.default)(t,e);void 0!==i?function(){var n={enumerable:i.enumerable,configurable:i.configurable};["get","set"].forEach((function(e){void 0!==i[e]&&(n[e]=function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];return i[e].apply(t,r)})})),["writable","value"].forEach((function(t){void 0!==i[t]&&(n[t]=i[t])})),(0,o.default)(t.__proxy__,e,n)}():t.__proxy__[e]=t[e],function(t,e,i,n){(0,o.default)(t,e,{get:i,set:function(t){n.call(this,t)},enumerable:!0,configurable:!0})}(t,e,(function(){return t.__proxy__[e]}),(function(i){var r=t.__proxy__[e];if(0!==n&&t[e]&&(a(t[e])||s(t[e]))&&!t[e].__watchers__)for(var o=0;o<t.__watchers__[e].length;o++)g(t[e],t.__watchers__[e][o],void 0===n?n:n-1);r!==i&&(t.__proxy__[e]=i,u(t,e,i,r,"set"))}))}()},g=function t(e,i,n){if("string"!=typeof e&&(e instanceof Object||s(e)))if(s(e)){if(p(e,"__watchall__",i,n),void 0===n||n>0)for(var r=0;r<e.length;r++)t(e[r],i,n)}else{var o=[];for(var a in e)({}).hasOwnProperty.call(e,a)&&o.push(a);v(e,o,i,n)}},m=function(t,e,i,n){"string"!=typeof t&&(t instanceof Object||s(t))&&(l(t[e])||(null!==t[e]&&(void 0===n||n>0)&&g(t[e],i,void 0!==n?n-1:n),p(t,e,i,n)))},v=function(t,e,i,n){if("string"!=typeof t&&(t instanceof Object||s(t)))for(var r=0;r<e.length;r++){var o=e[r];m(t,o,i,n)}},y=function(t,e,i){if(void 0!==t.__watchers__&&void 0!==t.__watchers__[e])if(void 0===i)delete t.__watchers__[e];else for(var n=0;n<t.__watchers__[e].length;n++)t.__watchers__[e][n]===i&&t.__watchers__[e].splice(n,1)},_=function(t,e,i){for(var n in e)e.hasOwnProperty(n)&&y(t,e[n],i)},b=function(t,e){if(!(t instanceof String||!t instanceof Object&&!s(t)))if(s(t)){for(var i=["__watchall__"],n=0;n<t.length;n++)i.push(n);_(t,i,e)}else!function t(e,i){var n=[];for(var r in e)e.hasOwnProperty(r)&&(e[r]instanceof Object&&t(e[r],i),n.push(r));_(e,n,i)}(t,e)}},function(t,e){var i=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=i)},function(t,e){var i=Object;t.exports={create:i.create,getProto:i.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:i.getOwnPropertyDescriptor,setDesc:i.defineProperty,setDescs:i.defineProperties,getKeys:i.keys,getNames:i.getOwnPropertyNames,getSymbols:i.getOwnPropertySymbols,each:[].forEach}},function(t,e,i){t.exports={default:i(5),__esModule:!0}},function(t,e,i){t.exports={default:i(6),__esModule:!0}},function(t,e,i){var n=i(2);t.exports=function(t,e,i){return n.setDesc(t,e,i)}},function(t,e,i){var n=i(2);i(17),t.exports=function(t,e){return n.getDesc(t,e)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var n=i(7);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,i){var n=i(13),r=i(1),o=i(9),s="prototype",a=function(t,e,i){var l,c,u,h=t&a.F,f=t&a.G,d=t&a.S,p=t&a.P,g=t&a.B,m=t&a.W,v=f?r:r[e]||(r[e]={}),y=f?n:d?n[e]:(n[e]||{})[s];for(l in f&&(i=e),i)(c=!h&&y&&l in y)&&l in v||(u=c?y[l]:i[l],v[l]=f&&"function"!=typeof y[l]?i[l]:g&&c?o(u,n):m&&y[l]==u?function(t){var e=function(e){return this instanceof t?new t(e):t(e)};return e[s]=t[s],e}(u):p&&"function"==typeof u?o(Function.call,u):u,p&&((v[s]||(v[s]={}))[l]=u))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,t.exports=a},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e,i){var n=i(8);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){var n=i(11),r=i(1),o=i(12);t.exports=function(t,e){var i=(r.Object||{})[t]||Object[t],s={};s[t]=e(i),n(n.S+n.F*o((function(){i(1)})),"Object",s)}},function(t,e,i){var n=i(14),r=i(10);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(16);i(15)("getOwnPropertyDescriptor",(function(t){return function(e,i){return t(n(e),i)}}))}])},function(t,e,i){var n;void 0===(n=function(t){var e=i(0),n=(i(10),{url:i(3).APP_HOST+"/live/network.php",pullUrl:null,pullHost:null,pullHostType:{video:null,desktop:null},groupData:{},sourceSetting:{code:0,data:[],buffer:1,sourceName:"",curSourceStream:{},isDefaultSetting:!0},setPullInfo:function(){var t=[];t.push("rtmp://"),t.push(this.sourceSetting.curSourceStream.host),t.push(this.sourceSetting.curSourceStream.app),t.push(this.sourceSetting.curSourceStream.path),t&&(this.pullUrl=t[0]+t[1]+"/"+t[2]+"/"+t[3],this.pullHost=t[1]),e.debug("network pullUrl ===>"+this.pullUrl,t)},setGroup:function(t){for(var e=t.length,i=0;i<e;i++)this.sourceSetting.sourceName||1!=t[i].cur||(this.sourceSetting.sourceName=t[i].sourceName),this.groupData[t[i].sourceName]=t[i].stream},getOperators:function(t,i){var n=this,r=1;n.setPullInfo(),i&&(r=i),e.ajax({url:n.url,type:"GET",data:{access_token:n.room.getAccessToken(),pullUrl:n.pullUrl,act:"list",version:r},success:function(i){i.data&&i.data.length>0&&n.setGroup(i.data),0==i.code?(i.buffer=n.player.liveBuffer||1,e.isInNative()&&window.SDK&&SDK.call("getOperatorSuccess",i)):e.isInNative()&&window.SDK&&SDK.call("getOperatorFail",i),"function"==typeof t&&t(i)},error:function(){e.isInNative()&&window.SDK&&SDK.call("getOperatorFail",{error:"-1"}),"function"==typeof t&&t({code:"-1"})}})},reset:function(){this.groupData={},this.sourceSetting={isDefaultSetting:!0}},curDefinition:"fd",setDefinition:function(t){var e=this;if(t&&(e.curDefinition=t),t&&""==e.sourceSetting.sourceName)e.getOperators((function(){e.setDefinition()}),2);else{if(e.groupData[e.sourceSetting.sourceName]){var i=e.groupData[e.sourceSetting.sourceName],n="";i.definition&&i.definition[e.curDefinition]&&(n=i.definition[e.curDefinition].streamExt||"");var r=i.path;i=JSON.stringify(i).replace(r,r+n),i=JSON.parse(i),e.sourceSetting.curSourceStream=i}e.sourceSetting.isDefaultSetting=!1,e.playBySetting(!1,!1)}},playBySetting:function(t){if(t&&t.streams){var e=[];for(var i in t.streams){var n={};if(n.cur=t.streams[i].cur||0,n.sourceName=t.streams[i].typeName||"",n.stream=t.streams[i],e.unshift(n),this.sourceSetting.isDefaultSetting&&0==i&&(this.sourceSetting.sourceName=t.streams[i].typeName,t.streams[i].definition))for(var r in t.streams[i].definition)if(t.streams[i].definition[r].isDefault){this.definition=r;break}}return this.setGroup(e),void this.setDefinition()}this.setSource(this.sourceSetting)},setOperator:function(t,i){var n=this,r={};if(e.isMobileSDK())try{r=JSON.parse(t)}catch(t){SDK.call("setOperatorFail",t)}else"string"==typeof t?(r.type=t,r.buffer=n.player.liveBuffer):"object"==typeof t&&(r=t);n.sourceSetting.buffer=r.buffer||1,n.sourceSetting.sourceName=r.sourceName||"",e.debug("network groupData ===> ",n.groupData[r.sourceName],r.sourceName),n.setPullInfo(),e.ajax({url:n.url,type:"GET",data:{access_token:n.room.getAccessToken(),act:"get",type:r.type,sourceName:r.sourceName||""},success:function(t){e.isMobileSDK()?(SDK.call("setOperator",t),1==e.getSDKMode()&&i&&i(t)):0==t.code&&(n.sourceSetting.data=t.data,n.sourceSetting.code=t.code,n.setDefinition(),i&&i(t))}})},setSource:function(t,i){if(this.sourceSetting.isDefaultSetting=!1,e.isMobile())this.player.changeSource(t),i&&i(t);else{if(!this.player)return!1;var n={t:"flashInfo",ipList:t.data,buffer:t.buffer,sourceName:t.sourceName,stream:t.curSourceStream};n=JSON.stringify(n),this.player.getCameraPlayer((function(e){e.cameraCommand(n),i&&i(t.code)})),this.player.getPlayer((function(e){e.command(n),i&&i(t.code)}))}},changeHost:function(t){var i=this;i.setPullInfo(),e.ajax({url:i.url,type:"GET",data:{access_token:i.room.getAccessToken(),act:"changeHost",pullHost:i.pullHost},success:function(n){if(0!=n.code||""==n.data.newPullHost)return t&&t({code:-1}),!1;var r={_old:i.pullHost,_new:n.data.newPullHost};i.pullUrl=i.pullUrl.replace(i.pullHost,n.data.newPullHost),i.pullHost=n.data.newPullHost;var o={pullHost:r,type:"hostChange"};if(!i.player)return!1;e.debug("pullHost ===>",o),i.player.changeHost(o,t)}})},init:function(t,e){this.room=t,this.player=e},hostReplace:{},oriUrls:{},hostGroup:[],addHostGroup:function(t){for(var e in t)this.hostGroup.push(t[e])},getRetryUrl:function(t){var e=t,i=e.split("/")[2];return void 0!==this.hostReplace[i]&&(t=t.replace(i,this.hostReplace[i])),this.oriUrls[t]=e,t},loadRetry:function(t,e){var i=this;if(void 0===i.oriUrls[t])return!1;var n=i.oriUrls[t].split("/")[2],r=t.split("/")[2];for(var o in i.hostGroup)for(var s in i.hostGroup[o])if(i.hostGroup[o][s]==n){var a=[].concat(i.hostGroup[o]);return a.splice(s,1),void 0!==a[a.indexOf(r)+1]&&(i.hostReplace[n]=a[a.indexOf(r)+1],setTimeout((function(){e(i.oriUrls[t])}),1e3)),!0}return!1},ajax:function(t,i){var n=this;t.url=n.getRetryUrl(t.url),t.error=function(){n.loadRetry(t.url,(function(e){t.url=e,n.ajax(t,i)}))},i&&(t.success=function(t){i(t)}),e.ajax(t)}});return window.network=n,n}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=i(87),r=i(88),o=i(89);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,i)}function c(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,i),r=(t=a(t,n)).write(e,i);r!==n&&(t=t.slice(0,r));return t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|d(e.length);return 0===(t=a(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=a(t,e<0?0:0|d(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function f(t,e){var i=e.length<0?0:0|d(e.length);t=a(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(t).length;default:if(n)return H(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,i);case"utf8":case"utf-8":return k(this,e,i);case"ascii":return j(this,e,i);case"latin1":case"binary":return E(this,e,i);case"base64":return S(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function m(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function v(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:y(t,e,i,n,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):y(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function y(t,e,i,n,r){var o,s=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,i/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){var u=-1;for(o=i;o<a;o++)if(c(t,o)===c(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){for(var h=!0,f=0;f<l;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function _(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[i+s]=a}return s}function b(t,e,i,n){return V(H(e,t.length-i),t,i,n)}function w(t,e,i,n){return V(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function x(t,e,i,n){return w(t,e,i,n)}function C(t,e,i,n){return V(z(e),t,i,n)}function T(t,e,i,n){return V(function(t,e){for(var i,n,r,o=[],s=0;s<t.length&&!((e-=2)<0);++s)i=t.charCodeAt(s),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function S(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function k(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o,s,a,l,c=t[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=i)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=h}return function(t){var e=t.length;if(e<=O)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=O));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return c(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return u(e),e<=0?a(t,e):void 0!==i?"string"==typeof n?a(t,e).fill(i,n):a(t,e).fill(i):a(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var s=t[i];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(n,r),u=t.slice(e,i),h=0;h<a;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return v(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return v(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return _(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return w(this,t,e,i);case"latin1":case"binary":return x(this,t,e,i);case"base64":return C(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function j(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function E(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function A(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=U(t[o]);return r}function P(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function D(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,i,n,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function I(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function R(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function F(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function L(t,e,i,n,o){return o||F(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function B(t,e,i,n,o){return o||F(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;i=new l(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||D(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||D(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||D(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||D(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||M(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||M(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);M(this,t,e,i,r-1,-r)}var o=0,s=1,a=0;for(this[e]=255&t;++o<i&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);M(this,t,e,i,r-1,-r)}var o=i-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return L(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return L(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return B(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return B(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,o=n-i;if(this===t&&i<e&&e<n)for(r=o-1;r>=0;--r)t[r+e]=this[r+i];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var s=l.isBuffer(t)?t:H(new l(t,n).toString()),a=s.length;for(o=0;o<i-e;++o)this[o+e]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){var i;e=e||1/0;for(var n=t.length,r=null,o=[],s=0;s<n;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function z(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(24))},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),n=0,r=i.length;n<r;n++){var o=i[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){t.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){var n;void 0===(n=function(t){var e=i(0),n=i(1),r=i(3);return{access_token:null,room:{},user:{},heartbeatInterval:60,getAccessToken:function(){return this.access_token},init:function(t,i,o){var s=this;this.access_token=t;var a={access_token:t};i&&i.params&&Object.assign(a,i.params),e.ajax({type:"GET",url:r.APP_HOST+"/live/playback.php",data:a,dataType:"jsonp",jsonpCallback:"vodCallback",cache:!0,success:function(i){if(i.code===r.CODE.SUCCESS&&i.data){var a=i.data;o&&o(i.data),s.room=i.data,s.user=i.data.user,a.vodLive&&1==a.vodLive?s.vodLiveType=!0:s.heartBeat(s.room,t,1)}else e.error("点播加载错误",i),n.get("vod:room:error")(i)}})},heartBeat:function(t,i,n){var o=1e3*this.heartbeatInterval,s=n,a=function(){e.ajax({type:"GET",url:r.APP_HOST+"/live/heartbeat.php",data:"v_type=2&onload="+s+"&access_token="+i,success:function(t){e.debug("vod-heartbeat===>",t)}})};a(),setInterval((function(){a()}),o),1===s&&(s=0)}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){t.exports=i(62)},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var l,c=[],u=!1,h=-1;function f(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&d())}function d(){if(!u){var t=a(f);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new p(t,e)),1!==c.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){var n=i(83)("socket.io-parser"),r=i(11),o=i(86),s=i(23),a=i(38);function l(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=l,e.Decoder=h;var c=e.ERROR+'"encode error"';function u(t){var i=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data){var r=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===r)return c;i+=r}return n("encoded %j as %s",t,i),i}function h(){this.reconstructor=null}function f(t){this.reconPack=t,this.buffers=[]}function d(t){return{type:e.ERROR,data:"parser error: "+t}}l.prototype.encode=function(t,i){(n("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){o.removeBlobs(t,(function(t){var i=o.deconstructPacket(t),n=u(i.packet),r=i.buffers;r.unshift(n),e(r)}))}(t,i):i([u(t)])},r(h.prototype),h.prototype.add=function(t){var i;if("string"==typeof t)i=function(t){var i=0,r={type:Number(t.charAt(0))};if(null==e.types[r.type])return d("unknown packet type "+r.type);if(e.BINARY_EVENT===r.type||e.BINARY_ACK===r.type){for(var o="";"-"!==t.charAt(++i)&&(o+=t.charAt(i),i!=t.length););if(o!=Number(o)||"-"!==t.charAt(i))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(i+1))for(r.nsp="";++i;){if(","===(l=t.charAt(i)))break;if(r.nsp+=l,i===t.length)break}else r.nsp="/";var a=t.charAt(i+1);if(""!==a&&Number(a)==a){for(r.id="";++i;){var l;if(null==(l=t.charAt(i))||Number(l)!=l){--i;break}if(r.id+=t.charAt(i),i===t.length)break}r.id=Number(r.id)}if(t.charAt(++i)){var c=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==c&&(r.type===e.ERROR||s(c))))return d("invalid payload");r.data=c}return n("decoded %s as %j",t,r),r}(t),e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type?(this.reconstructor=new f(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(92);t.exports=function(t){var e=t.xdomain,i=t.xscheme,r=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!i&&r)return new XDomainRequest}catch(t){}if(!e)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},function(t,e,i){var n=i(12),r=i(11);function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=o,r(o.prototype),o.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var e=n.decodePacket(t,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},function(t,e,i){"use strict";var n=i(4);function r(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,i){if(!e)return t;var o;if(i)o=i(e);else if(n.isURLSearchParams(e))o=e.toString();else{var s=[];n.forEach(e,(function(t,e){null!=t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,(function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),s.push(r(e)+"="+r(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,i){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,i){"use strict";(function(e){var n=i(4),r=i(68),o={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a,l={adapter:(void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?a=i(32):"undefined"!=typeof XMLHttpRequest&&(a=i(32)),a),transformRequest:[function(t,e){return r(e,"Accept"),r(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),n.forEach(["post","put","patch"],(function(t){l.headers[t]=n.merge(o)})),t.exports=l}).call(this,i(21))},function(t,e,i){"use strict";var n=i(4),r=i(69),o=i(29),s=i(71),a=i(72),l=i(33);t.exports=function(t){return new Promise((function(e,c){var u=t.data,h=t.headers;n.isFormData(u)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",p=t.auth.password||"";h.Authorization="Basic "+btoa(d+":"+p)}if(f.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:t,request:f};r(e,c,n),f=null}},f.onabort=function(){f&&(c(l("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){c(l("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(l("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var g=i(73),m=(t.withCredentials||a(t.url))&&t.xsrfCookieName?g.read(t.xsrfCookieName):void 0;m&&(h[t.xsrfHeaderName]=m)}if("setRequestHeader"in f&&n.forEach(h,(function(t,e){void 0===u&&"content-type"===e.toLowerCase()?delete h[e]:f.setRequestHeader(e,t)})),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),c(t),f=null)})),void 0===u&&(u=null),f.send(u)}))}},function(t,e,i){"use strict";var n=i(70);t.exports=function(t,e,i,r,o){var s=new Error(t);return n(s,e,i,r,o)}},function(t,e,i){"use strict";var n=i(4);t.exports=function(t,e){e=e||{};var i={};return n.forEach(["url","method","params","data"],(function(t){void 0!==e[t]&&(i[t]=e[t])})),n.forEach(["headers","auth","proxy"],(function(r){n.isObject(e[r])?i[r]=n.deepMerge(t[r],e[r]):void 0!==e[r]?i[r]=e[r]:n.isObject(t[r])?i[r]=n.deepMerge(t[r]):void 0!==t[r]&&(i[r]=t[r])})),n.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],(function(n){void 0!==e[n]?i[n]=e[n]:void 0!==t[n]&&(i[n]=t[n])})),i}},function(t,e,i){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,i){var n;void 0===(n=function(t){var e=i(0),n=i(1),r=i(7),o=i(15),s=i(3),a={access_token:null,getAccessToken:function(){return this.access_token},course:null,setCourse:function(t){this.course=t},configs:null,init:function(t,i,a){e.debug("room.init.js => module init."),a&&(this.player=a);var l=this,c=t;this.access_token=t,e.ajax({type:"GET",url:s.APP_HOST+"/live/init.php",dataType:"jsonp",data:{access_token:t},success:function(t){if(t.code!=s.CODE.SUCCESS&&e.error(t),t.code===s.CODE.SUCCESS){var a=t;e.setRoom(a),r.init(a.log);try{a=e.detectProtocol(JSON.stringify(a)),a=JSON.parse(a)}catch(t){e.debug("room data parse Error "+t)}if(a.course&&a.course.course_id&&(l.course=a.course),!e.isMobileSDK()&&a.ext.liveEndExpire>0&&0===a.ext.liveEndJumpUrl.indexOf("http")&&window.localStorage){if(window.localStorage.getItem("liveEndExpireToken")==c)return void(window.location.href=a.ext.liveEndJumpUrl);window.localStorage.removeItem("liveEndExpireToken")}l.room=a,o.addHostGroup(a.hostGroup||{}),e.debug("房间验证成功====>",a);try{i(a)}catch(t){console.error(t)}}else t.code>=s.CODE.LIVE_COURSE_UNEXIST&&t.code<=s.CODE.LIVE_COURSE_NOT_START?n.get("live:course:access:error")(t):n.get("system:room:error")(t)},error:function(){n.get("system:room:error")("room请求超时,请重试...")}})},liveEndExpieTimer:null,broadcastHandler:function(t){var i=this;"start"==t.t?i.liveEndExpieTimer&&(clearTimeout(i.liveEndExpieTimer),i.liveEndExpieTimer=null):"stop"==t.t&&!e.isMobileSDK()&&i.room.ext.liveEndExpire>0&&0===i.room.ext.liveEndJumpUrl.indexOf("http")&&(i.liveEndExpieTimer=setTimeout((function(){window.localStorage&&window.localStorage.setItem("liveEndExpireToken",i.getAccessToken()),window.location.href=i.room.ext.liveEndJumpUrl}),1e3*i.room.ext.liveEndExpire))}};return window.room=a,a}.call(e,i,e,t))||(t.exports=n)},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,r=t.indexOf("["),o=t.indexOf("]");-1!=r&&-1!=o&&(t=t.substring(0,r)+t.substring(r,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=i.exec(t||""),a={},l=14;l--;)a[n[l]]=s[l]||"";return-1!=r&&-1!=o&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,i){(function(e){t.exports=function(t){return i&&e.isBuffer(t)||n&&(t instanceof ArrayBuffer||r(t))};var i="function"==typeof e&&"function"==typeof e.isBuffer,n="function"==typeof ArrayBuffer,r=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}}).call(this,i(16).Buffer)},function(t,e,i){var n=i(90),r=i(45),o=i(11),s=i(22),a=i(46),l=i(47),c=i(8)("socket.io-client:manager"),u=i(44),h=i(104),f=Object.prototype.hasOwnProperty;function d(t,e){if(!(this instanceof d))return new d(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=e.parser||s;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=n(this.uri,this.opts);var i=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=a(i,"open",(function(){r.onopen(),t&&t()})),s=a(i,"error",(function(e){if(c("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var l=this._timeout;c("connect attempt will timeout after %d",l);var u=setTimeout((function(){c("connect attempt timed out after %d",l),o.destroy(),i.close(),i.emit("error","timeout"),r.emitAll("connect_timeout",l)}),l);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(s),this},d.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",l(this,"ondata"))),this.subs.push(a(t,"ping",l(this,"onping"))),this.subs.push(a(t,"pong",l(this,"onpong"))),this.subs.push(a(t,"error",l(this,"onerror"))),this.subs.push(a(t,"close",l(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",l(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,e){var i=this.nsps[t];if(!i){i=new r(this,t,e),this.nsps[t]=i;var n=this;i.on("connecting",o),i.on("connect",(function(){i.id=n.generateId(t)})),this.autoConnect&&o()}function o(){~u(n.connecting,i)||n.connecting.push(i)}return i},d.prototype.destroy=function(t){var e=u(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},d.prototype.packet=function(t){c("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()})))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){c("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout((function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(i)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,i){var n=i(25),r=i(93),o=i(100),s=i(101);e.polling=function(t){var e=!1,i=!1,s=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,l=location.port;l||(l=a?443:80),e=t.hostname!==location.hostname||l!==t.port,i=t.secure!==a}if(t.xdomain=e,t.xscheme=i,"open"in new n(t)&&!t.forceJSONP)return new r(t);if(!s)throw new Error("JSONP disabled");return new o(t)},e.websocket=s},function(t,e,i){var n=i(26),r=i(17),o=i(12),s=i(18),a=i(43),l=i(8)("engine.io-client:polling");t.exports=u;var c=null!=new(i(25))({xdomain:!1}).responseType;function u(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),n.call(this,t)}s(u,n),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(t){var e=this;function i(){l("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(l("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--n||i()}))),this.writable||(l("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){l("pre-pause writing complete"),--n||i()})))}else i()},u.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(t){var e=this;l("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,(function(t,i,n){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var t=this;function e(){l("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},u.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,i)}))},u.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=r.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,e,i){(function(e){var n=i(23),r=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.exports=function t(i){if(!i||"object"!=typeof i)return!1;if(n(i)){for(var r=0,a=i.length;r<a;r++)if(t(i[r]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(i)||"function"==typeof ArrayBuffer&&i instanceof ArrayBuffer||o&&i instanceof Blob||s&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return t(i.toJSON(),!0);for(var l in i)if(Object.prototype.hasOwnProperty.call(i,l)&&t(i[l]))return!0;return!1}}).call(this,i(16).Buffer)},function(t,e,i){"use strict";var n,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},a=0,l=0;function c(t){var e="";do{e=r[t%o]+e,t=Math.floor(t/o)}while(t>0);return e}function u(){var t=c(+new Date);return t!==n?(a=0,n=t):t+"."+c(a++)}for(;l<o;l++)s[r[l]]=l;u.encode=c,u.decode=function(t){var e=0;for(l=0;l<t.length;l++)e=e*o+s[t.charAt(l)];return e},t.exports=u},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e,i){var n=i(22),r=i(11),o=i(103),s=i(46),a=i(47),l=i(8)("socket.io-client:socket"),c=i(17),u=i(42);t.exports=d;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=r.prototype.emit;function d(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}r(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",a(this,"onopen")),s(t,"packet",a(this,"onpacket")),s(t,"close",a(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(h.hasOwnProperty(t))return f.apply(this,arguments),this;var e=o(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:u(e))?n.BINARY_EVENT:n.EVENT,data:e,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?c.encode(this.query):this.query;l("sending connect packet with query %s",t),this.packet({type:n.CONNECT,query:t})}else this.packet({type:n.CONNECT})},d.prototype.onclose=function(t){l("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var e=t.nsp===this.nsp,i=t.type===n.ERROR&&"/"===t.nsp;if(e||i)switch(t.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(t);break;case n.ACK:case n.BINARY_ACK:this.onack(t);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var e=t.data||[];l("emitting event %j",e),null!=t.id&&(l("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},d.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var r=o(arguments);l("sending ack %j",r),e.packet({type:u(r)?n.BINARY_ACK:n.ACK,id:t,data:r})}}},d.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(l("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):l("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}},function(t,e){var i=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}},function(t,e,i){"use strict";t.exports=function(t,e,i,n){for(var r=65535&t|0,o=t>>>16&65535|0,s=0;0!==i;){i-=s=i>2e3?2e3:i;do{o=o+(r=r+e[n++]|0)|0}while(--s);r%=65521,o%=65521}return r|o<<16|0}},function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var o=n,s=r+i;t^=-1;for(var a=r;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}},function(t,e,i){"use strict";var n=i(9),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var s=new n.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",s=0;s<e;s++)i+=String.fromCharCode(t[s]);return i}s[254]=s[254]=1,e.string2buf=function(t){var e,i,r,o,s,a=t.length,l=0;for(o=0;o<a;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(l),s=0,o=0;s<l;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,n,r,o,a=e||t.length,c=new Array(2*a);for(n=0,i=0;i<a;)if((r=t[i++])<128)c[n++]=r;else if((o=s[r])>4)c[n++]=65533,i+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&i<a;)r=r<<6|63&t[i++],o--;o>1?c[n++]=65533:r<65536?c[n++]=r:(r-=65536,c[n++]=55296|r>>10&1023,c[n++]=56320|1023&r)}return l(c,n)},e.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+s[t[i]]>e?i:e}},function(t,e,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){var n;void 0===(n=function(t){var e=i(0),n=i(1),r=i(54),o=i(10),s={cameraContainerId:null,cameraPlayerId:null,playType:"live",pptPlayerType:"flash",videoPlayType:"",playStatus:"stop",h5Player:null,cameraWidth:280,cameraHeight:210,durationTimmer:null,videoUrl:null,duration:null,currentDuration:0,stream:[],bn:0,ba:0,bx:0,waitLastTime:0,callSdk:function(t,e){},config:function(t){"object"==typeof t&&(t.width&&(this.cameraWidth=parseInt(t.width)),t.height&&(this.cameraHeight=parseInt(t.height)),t.playType&&(this.playType=t.playType),t.pptPlayerType&&(this.pptPlayerType=t.pptPlayerType),t.videoPlayType&&(this.videoPlayType=t.videoPlayType))},camera:function(t,i,n){if(this.cameraContainerId=t,this.cameraPlayerId=i,!e.isMobileSDK()){this.cameraPlayer;this.cameraCallback=n}},getCamera:function(t){if(e.isMobileSDK())return!1;var i={};return this.cameraVideo?(e.debug("Get Camera Element ==>",this.cameraVideo),this.cameraVideo):(e.debug("Createing the Camera Element ==>",this.cameraPlayerId,this.cameraVideo),o.isForceAudio()||"audio"===t?((i=document.createElement("audio")).setAttribute("preload","auto"),i.className="camera_audio"):o.isForceVideo()||"video"===t?((i=document.createElement("video")).setAttribute("preload","auto"),i.className="camera_video"):e.isWechat()?((i=document.createElement("video")).setAttribute("preload","auto"),i.className="camera_wechat"):o.isCreateAudio()?(i=document.createElement("audio")).className="camera_iphone":e.isIpad()?((i=document.createElement("video")).className="camera_ipad",i.setAttribute("preload","none")):e.isAndroid()?((i=document.createElement("video")).className="camera_android",i.setAttribute("preload","auto")):(i=document.createElement("video")).className="camera_default",i.id=this.cameraPlayerId,i.setAttribute("autoplay",""),i.setAttribute("autoplay","true"),i.setAttribute("webkit-playsinline","webkit-playsinline"),i.setAttribute("playsinline",""),i.setAttribute("x5-playsinline",""),i.setAttribute("controlsList","nodownload"),i.addEventListener("contextmenu",(function(t){t.preventDefault()}),!1),e.isCompatible()&&(i.setAttribute("x5-video-player-type","h5"),i.style["object-position"]="0 0"),document.getElementById(this.cameraContainerId).appendChild(i),this.cameraVideo=i,i)},getCameraPlayer:function(){return this.cameraVideo},getVideojsPlayer:function(t,i){var s=this;if(s.cameraPlayer){if(s.cameraPlayer.src()!==s.videoUrl){l=o.getVideoSource(s.videoUrl);s.playStatus="waiting",s.cameraPlayer.src(l)}return e.isWechat()&&e.detectiveWxJsBridge((function(){s.play()})),s.cameraPlayer}var a=["html5","flash"];"html5"===s.videoPlayType&&(a=["html5","flash"]),e.isMobile()&&(a=["html5"]),window.location.href.indexOf("vjs=flash")>-1?a=["flash","html5"]:window.location.href.indexOf("vjs=html5")>-1&&(a=["html5","flash"]);var l=o.getVideoSource(s.videoUrl),c=document.querySelector("#"+this.cameraContainerId).clientWidth||280;if(!t)return e.debug("摄像头视频标签未定义."),!1;t.parentNode.style.width="100%",t.parentNode.style.height="100%";var u=r(t,{techOrder:a,sources:l,preload:!0,width:c,bigPlayButton:!1,errorDisplay:!1,loadingSpinner:!1,posterImage:!0,textTrackSettings:!1,textTrackDisplay:!1,controlBar:!1,controls:!1,autoplay:!0},(function(){s.videoLoadState=!0;var t=this.el_.firstChild;t.style.width="100%",t.style.height="100%",this.el_.tech_={},this.el_.tech_.el_=this.el_,s.h5Player=this.tech_.el_,s.cameraCallback(this.el_),this.el_.style.width="100%",this.el_.style.height="100%",s.play(),"function"==typeof i&&i()}));if(s.cameraPlayer=u,window.__video__=s.cameraPlayer,"playback"===this.playType){u.on("loadeddata",(function(t){if(!s.isChecked)return s.pause(),!1;e.isMobile()&&e.isAndroid(),n.get("live:video:loaded")("media"),s.seekDuration&&s.seekDuration>0&&(e.debug("seeking===>"+s.seekDuration),e.isMobile()?setTimeout((function(){s.seek(s.seekDuration),s.play(),s.seekDuration=0}),1e3):(s.seekDuration>0&&s.seek(s.seekDuration),s.play(),s.seekDuration=0),s.isSeekFinished=!0)})),u.on("loadedmetadata",(function(t){o.mediaValidate(this.duration(),(function(t){s.isChecked=!!t})),n.get("live:video:metadata")()}));var h=0;u.on("timeupdate",(function(){var t=u.currentTime(),e=Math.round((new Date).getTime()/1e3);t<=s.currentDuration?s.setWaitingTimes(e):s.bx>0&&e-h>1&&(s.bx-=1,h=e),s.currentDuration=t,s.setMeidaPlayStatus("playing"),n.get("live:camera:timeupdate")(t)})),u.on("loadstart",(function(){n.get("live:video:loadstart")()})),u.on("firstbufferinfo",(function(){var t=u.techGet_("firstbufferinfo");n.get("live:loading:info")(t)})),u.on("play",(function(){s.play(),n.get("live:video:playing")()})),u.on("canplay",(function(){n.get("live:video:canplay")(),s.firstLoad=!0})),u.on("pause",(function(){s.setMeidaPlayStatus("pause"),n.get("live:video:pause")()})),u.on("seeking",(function(){s.setMeidaPlayStatus("seeking"),n.get("live:video:seeking")(),s.isSeekFinished=!1,u.duration()==u.currentTime()&&(s.playStatus="ended",o.playStatus=s.playStatus)})),u.on("seeked",(function(){s.setMeidaPlayStatus("seeked"),n.get("live:seek:finish")(),s.isSeekFinished=!0})),u.on("waiting",(function(){s.bn+=1,s.ba+=1,s.setMeidaPlayStatus("waiting"),n.get("live:video:waiting")()})),u.on("ended",(function(){s.setMeidaPlayStatus("ended"),n.get("live:video:ended")()})),u.on("error",(function(t){s.setMeidaPlayStatus("error"),s.bn+=1,s.ba+=1,0==s.changeSource&&(s.changeSource=1),n.get("live:video:error")(t)})),u.on("durationchange",(function(){s.setMeidaPlayStatus("durationchange"),n.get("live:video:durationchange")()})),u.on("abort",(function(){s.setMeidaPlayStatus("abort"),n.get("live:video:abort")(this)}))}return e.isWechat()&&e.detectiveWxJsBridge((function(){s.play()})),u},setMeidaPlayStatus:function(t){this.playStatus=t,o.playStatus=t},playRate:function(t){if(this.cameraPlayer&&"Flash"!=this.cameraPlayer.techName_)return this.cameraPlayer.playbackRate(t)},destroy:function(){this.cameraVideo&&(this.cameraVideo=null),this.cameraPlayer&&(this.cameraPlayer.dispose(),this.cameraPlayer=null)},startDurationTimmer:function(){var t=this;t.durationTimmer||(e.isMobileSDK()?t.durationTimmer=setInterval((function(){n.get("live:duration")(schedule.playDuration,t.duration,schedule.playDuration/t.duration)}),500):t.durationTimmer=setInterval((function(){o.currentDuration>0&&o.currentDuration>=t.duration&&t.stopDurationTimmer()}),200))},stopDurationTimmer:function(){this.durationTimmer&&(clearInterval(this.durationTimmer),this.durationTimmer=null)},getVideoUrl:function(t){return"playback"===this.playType?t:(t=t.replace("rtmp://","http://").split("|"))[0]+"/"+t[1]+"/playlist.m3u8"},seek:function(t){var i=this;if(i.bx=0,i.seekDuration=t,e.debug("video seek ===> "+i.seekDuration),"playback"===this.playType){if(e.isMobileSDK())setTimeout((function(){i.play()}),100);else i.cameraPlayer&&(i.cameraPlayer.currentTime(t),i.play(),i.startDurationTimmer());i.changeSource=0}},playHandle:null,play:function(){o.elementPlay(this.h5Player,t=>{console.warn(t),"error"===t?this.pause():(e.debug("视频开始播放..."),o.vodPlayer.tick(),this.startDurationTimmer())})},pause:function(){var t=this.cameraPlayer;return t&&(t.pause(),this.playStatus="pause"),this.setMeidaPlayStatus("pause"),o.vodPlayer.pauseTick(),this.stopDurationTimmer(),Promise.resolve()},stop:function(){if(e.debug("video call stop!"),e.isMobileSDK())SDK.mediaStop();else{var t=this.cameraPlayer;t&&t.pause()}this.setMeidaPlayStatus("ended"),this.stopDurationTimmer()},volume:function(t){e.isMobileSDK()||this.cameraPlayer&&this.cameraPlayer.volume(t)},videoDo:function(t){e.debug("videoDo",t);if(103==t.t){if(e.isMobileSDK()){e.debug("SDK video start:",i);var i=[];"playback"===this.playType?(i[0]=t.c,i[1]=""):i=t.c.split("|"),SDK.audioStart(i[0],i[1]),this.stream=i}else{if(0==t.c.length)return;var n=this.getVideoUrl(t.c);if(this.videoUrl===n)return!1;this.videoUrl=n,e.debug("play video:"+n);var r=this.getCamera();this.getVideojsPlayer(r)}this.startDurationTimmer()}else 104==t.t&&this.stop()},changeSource:0,setWaitingTimes:function(t){t-this.waitLastTime>=1&&(this.bn+=1,this.ba+=1,this.bx<15?this.bx+=1:(this.bx=0,this.changeSource=1,n.get("live:video:timeout")(this.bx)),this.waitLastTime=t)},cameraDo:function(t){e.debug("cameraDo",t);if(101==t.t){if(e.isMobileSDK())SDK.cameraStart(this.stream[0],this.stream[1]);else(i=this.getCamera()).width=this.cameraWidth,i.height=this.cameraHeight;n.get("camera:start")(i)}else if(102==t.t){var i;if(e.isMobileSDK())setTimeout((function(){SDK.cameraStop()}),500);else(i=this.getCamera()).width=0,i.height=0;n.get("camera:stop")(i)}}};return window.video=s,s}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){(function(e){var i,n,r,o,s,a,l;t.exports=function t(e,n,r){function o(a,l){if(!n[a]){if(!e[a]){if(!l&&"function"==typeof i&&i)return i(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};e[a][0].call(u.exports,(function(t){var i=e[a][1][t];return o(i||t)}),u,u.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof i&&i,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,i,n){(function(e){try{e._videojsSwfPath=window.TF_getStaticHost("static-1.talk-fun.com/open/maituo/static/swf")||"static-1.talk-fun.com/open/maituo/static/swf"}catch(t){e._videojsSwfPath="static-1.talk-fun.com/open/maituo/static/swf"}e.__vodPlayerUrl__="",window.location.href.indexOf("debug=list")>-1?e.__vodPlayerUrl__=e._videojsSwfPath+"/debug/video-js.swf":e.__vodPlayerUrl__=e._videojsSwfPath+"/video-js.swf";var n=void 0!==e?e:"undefined"!=typeof window?window:{},r=t("min-document");if("undefined"!=typeof document)i.exports=document;else{var o=n["__GLOBAL_DOCUMENT_CACHE@4"];o||(o=n["__GLOBAL_DOCUMENT_CACHE@4"]=r),i.exports=o}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":3}],2:[function(t,i,n){(function(t){"undefined"!=typeof window?i.exports=window:void 0!==t?i.exports=t:"undefined"!=typeof self?i.exports=self:i.exports={}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e,i){},{}],4:[function(t,e,i){var n=t("../internal/getNative")(Date,"now")||function(){return(new Date).getTime()};e.exports=n},{"../internal/getNative":20}],5:[function(t,e,i){var n=t("../lang/isObject"),r=t("../date/now"),o="Expected a function",s=Math.max;e.exports=function(t,e,i){var a,l,c,u,h,f,d,p=0,g=!1,m=!0;if("function"!=typeof t)throw new TypeError(o);if(e=e<0?0:+e||0,!0===i){var v=!0;m=!1}else n(i)&&(v=!!i.leading,g="maxWait"in i&&s(+i.maxWait||0,e),m="trailing"in i?!!i.trailing:m);function y(e,i){i&&clearTimeout(i),l=f=d=void 0,e&&(p=r(),c=t.apply(h,a),f||l||(a=h=void 0))}function _(){var t=e-(r()-u);t<=0||t>e?y(d,l):f=setTimeout(_,t)}function b(){y(m,f)}function w(){if(a=arguments,u=r(),h=this,d=m&&(f||!v),!1===g)var i=v&&!f;else{l||v||(p=u);var n=g-(u-p),o=n<=0||n>g;o?(l&&(l=clearTimeout(l)),p=u,c=t.apply(h,a)):l||(l=setTimeout(b,n))}return o&&f?f=clearTimeout(f):f||e===g||(f=setTimeout(_,e)),i&&(o=!0,c=t.apply(h,a)),!o||f||l||(a=h=void 0),c}return w.cancel=function(){f&&clearTimeout(f),l&&clearTimeout(l),p=0,l=f=d=void 0},w}},{"../date/now":4,"../lang/isObject":33}],6:[function(t,e,i){var n="Expected a function",r=Math.max;e.exports=function(t,e){if("function"!=typeof t)throw new TypeError(n);return e=r(void 0===e?t.length-1:+e||0,0),function(){for(var i=arguments,n=-1,o=r(i.length-e,0),s=Array(o);++n<o;)s[n]=i[e+n];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,i[0],s);case 2:return t.call(this,i[0],i[1],s)}var a=Array(e+1);for(n=-1;++n<e;)a[n]=i[n];return a[e]=s,t.apply(this,a)}}},{}],7:[function(t,e,i){var n=t("./debounce"),r=t("../lang/isObject"),o="Expected a function";e.exports=function(t,e,i){var s=!0,a=!0;if("function"!=typeof t)throw new TypeError(o);return!1===i?s=!1:r(i)&&(s="leading"in i?!!i.leading:s,a="trailing"in i?!!i.trailing:a),n(t,e,{leading:s,maxWait:+e,trailing:a})}},{"../lang/isObject":33,"./debounce":5}],8:[function(t,e,i){e.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}},{}],9:[function(t,e,i){e.exports=function(t,e){for(var i=-1,n=t.length;++i<n&&!1!==e(t[i],i,t););return t}},{}],10:[function(t,e,i){e.exports=function(t,e,i){i||(i={});for(var n=-1,r=e.length;++n<r;){var o=e[n];i[o]=t[o]}return i}},{}],11:[function(t,e,i){var n=t("./createBaseFor")();e.exports=n},{"./createBaseFor":18}],12:[function(t,e,i){var n=t("./baseFor"),r=t("../object/keysIn");e.exports=function(t,e){return n(t,e,r)}},{"../object/keysIn":39,"./baseFor":11}],13:[function(t,e,i){var n=t("./arrayEach"),r=t("./baseMergeDeep"),o=t("../lang/isArray"),s=t("./isArrayLike"),a=t("../lang/isObject"),l=t("./isObjectLike"),c=t("../lang/isTypedArray"),u=t("../object/keys");e.exports=function t(e,i,h,f,d){if(!a(e))return e;var p=s(i)&&(o(i)||c(i)),g=p?void 0:u(i);return n(g||i,(function(n,o){if(g&&(n=i[o=n]),l(n))f||(f=[]),d||(d=[]),r(e,i,o,t,h,f,d);else{var s=e[o],a=h?h(s,n,o,e,i):void 0,c=void 0===a;c&&(a=n),void 0===a&&(!p||o in e)||!c&&(a==a?a===s:s!=s)||(e[o]=a)}})),e}},{"../lang/isArray":30,"../lang/isObject":33,"../lang/isTypedArray":36,"../object/keys":38,"./arrayEach":9,"./baseMergeDeep":14,"./isArrayLike":21,"./isObjectLike":26}],14:[function(t,e,i){var n=t("./arrayCopy"),r=t("../lang/isArguments"),o=t("../lang/isArray"),s=t("./isArrayLike"),a=t("../lang/isPlainObject"),l=t("../lang/isTypedArray"),c=t("../lang/toPlainObject");e.exports=function(t,e,i,u,h,f,d){for(var p=f.length,g=e[i];p--;)if(f[p]==g)return void(t[i]=d[p]);var m=t[i],v=h?h(m,g,i,t,e):void 0,y=void 0===v;y&&(v=g,s(g)&&(o(g)||l(g))?v=o(m)?m:s(m)?n(m):[]:a(g)||r(g)?v=r(m)?c(m):a(m)?m:{}:y=!1),f.push(g),d.push(v),y?t[i]=u(v,g,h,f,d):(v==v?v!==m:m==m)&&(t[i]=v)}},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isPlainObject":34,"../lang/isTypedArray":36,"../lang/toPlainObject":37,"./arrayCopy":8,"./isArrayLike":21}],15:[function(t,e,i){var n=t("./toObject");e.exports=function(t){return function(e){return null==e?void 0:n(e)[t]}}},{"./toObject":28}],16:[function(t,e,i){var n=t("../utility/identity");e.exports=function(t,e,i){if("function"!=typeof t)return n;if(void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)};case 5:return function(i,n,r,o,s){return t.call(e,i,n,r,o,s)}}return function(){return t.apply(e,arguments)}}},{"../utility/identity":42}],17:[function(t,e,i){var n=t("./bindCallback"),r=t("./isIterateeCall"),o=t("../function/restParam");e.exports=function(t){return o((function(e,i){var o=-1,s=null==e?0:i.length,a=s>2?i[s-2]:void 0,l=s>2?i[2]:void 0,c=s>1?i[s-1]:void 0;for("function"==typeof a?(a=n(a,c,5),s-=2):s-=(a="function"==typeof c?c:void 0)?1:0,l&&r(i[0],i[1],l)&&(a=s<3?void 0:a,s=1);++o<s;){var u=i[o];u&&t(e,u,a)}return e}))}},{"../function/restParam":6,"./bindCallback":16,"./isIterateeCall":24}],18:[function(t,e,i){var n=t("./toObject");e.exports=function(t){return function(e,i,r){for(var o=n(e),s=r(e),a=s.length,l=t?a:-1;t?l--:++l<a;){var c=s[l];if(!1===i(o[c],c,o))break}return e}}},{"./toObject":28}],19:[function(t,e,i){var n=t("./baseProperty")("length");e.exports=n},{"./baseProperty":15}],20:[function(t,e,i){var n=t("../lang/isNative");e.exports=function(t,e){var i=null==t?void 0:t[e];return n(i)?i:void 0}},{"../lang/isNative":32}],21:[function(t,e,i){var n=t("./getLength"),r=t("./isLength");e.exports=function(t){return null!=t&&r(n(t))}},{"./getLength":19,"./isLength":25}],22:[function(t,e,i){var n=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}();e.exports=n},{}],23:[function(t,e,i){var n=/^\d+$/,r=9007199254740991;e.exports=function(t,e){return t="number"==typeof t||n.test(t)?+t:-1,e=null==e?r:e,t>-1&&t%1==0&&t<e}},{}],24:[function(t,e,i){var n=t("./isArrayLike"),r=t("./isIndex"),o=t("../lang/isObject");e.exports=function(t,e,i){if(!o(i))return!1;var s=typeof e;if("number"==s?n(i)&&r(e,i.length):"string"==s&&e in i){var a=i[e];return t==t?t===a:a!=a}return!1}},{"../lang/isObject":33,"./isArrayLike":21,"./isIndex":23}],25:[function(t,e,i){var n=9007199254740991;e.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},{}],26:[function(t,e,i){e.exports=function(t){return!!t&&"object"==typeof t}},{}],27:[function(t,e,i){var n=t("../lang/isArguments"),r=t("../lang/isArray"),o=t("./isIndex"),s=t("./isLength"),a=t("../lang/isString"),l=t("../object/keysIn"),c=Object.prototype.hasOwnProperty;e.exports=function(t){for(var e=l(t),i=e.length,u=i&&t.length,h=!!u&&s(u)&&(r(t)||n(t)||a(t)),f=-1,d=[];++f<i;){var p=e[f];(h&&o(p,u)||c.call(t,p))&&d.push(p)}return d}},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isString":35,"../object/keysIn":39,"./isIndex":23,"./isLength":25}],28:[function(t,e,i){var n=t("../lang/isObject"),r=t("../lang/isString"),o=t("../support");e.exports=function(t){if(o.unindexedChars&&r(t)){for(var e=-1,i=t.length,s=Object(t);++e<i;)s[e]=t.charAt(e);return s}return n(t)?t:Object(t)}},{"../lang/isObject":33,"../lang/isString":35,"../support":41}],29:[function(t,e,i){var n=t("../internal/isArrayLike"),r=t("../internal/isObjectLike"),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable;e.exports=function(t){return r(t)&&n(t)&&s.call(t,"callee")&&!a.call(t,"callee")}},{"../internal/isArrayLike":21,"../internal/isObjectLike":26}],30:[function(t,e,i){var n=t("../internal/getNative"),r=t("../internal/isLength"),o=t("../internal/isObjectLike"),s=Object.prototype.toString,a=n(Array,"isArray")||function(t){return o(t)&&r(t.length)&&"[object Array]"==s.call(t)};e.exports=a},{"../internal/getNative":20,"../internal/isLength":25,"../internal/isObjectLike":26}],31:[function(t,e,i){var n=t("./isObject"),r="[object Function]",o=Object.prototype.toString;e.exports=function(t){return n(t)&&o.call(t)==r}},{"./isObject":33}],32:[function(t,e,i){var n=t("./isFunction"),r=t("../internal/isHostObject"),o=t("../internal/isObjectLike"),s=/^\[object .+?Constructor\]$/,a=Object.prototype,l=Function.prototype.toString,c=a.hasOwnProperty,u=RegExp("^"+l.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return null!=t&&(n(t)?u.test(l.call(t)):o(t)&&(r(t)?u:s).test(t))}},{"../internal/isHostObject":22,"../internal/isObjectLike":26,"./isFunction":31}],33:[function(t,e,i){e.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},{}],34:[function(t,e,i){var n=t("../internal/baseForIn"),r=t("./isArguments"),o=t("../internal/isHostObject"),s=t("../internal/isObjectLike"),a=t("../support"),l="[object Object]",c=Object.prototype,u=c.hasOwnProperty,h=c.toString;e.exports=function(t){var e,i;return!(!s(t)||h.call(t)!=l||o(t)||r(t)||!(u.call(t,"constructor")||"function"!=typeof(e=t.constructor)||e instanceof e))&&(a.ownLast?(n(t,(function(t,e,n){return i=u.call(n,e),!1})),!1!==i):(n(t,(function(t,e){i=e})),void 0===i||u.call(t,i)))}},{"../internal/baseForIn":12,"../internal/isHostObject":22,"../internal/isObjectLike":26,"../support":41,"./isArguments":29}],35:[function(t,e,i){var n=t("../internal/isObjectLike"),r="[object String]",o=Object.prototype.toString;e.exports=function(t){return"string"==typeof t||n(t)&&o.call(t)==r}},{"../internal/isObjectLike":26}],36:[function(t,e,i){var n=t("../internal/isLength"),r=t("../internal/isObjectLike"),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var s=Object.prototype.toString;e.exports=function(t){return r(t)&&n(t.length)&&!!o[s.call(t)]}},{"../internal/isLength":25,"../internal/isObjectLike":26}],37:[function(t,e,i){var n=t("../internal/baseCopy"),r=t("../object/keysIn");e.exports=function(t){return n(t,r(t))}},{"../internal/baseCopy":10,"../object/keysIn":39}],38:[function(t,e,i){var n=t("../internal/getNative"),r=t("../internal/isArrayLike"),o=t("../lang/isObject"),s=t("../internal/shimKeys"),a=t("../support"),l=n(Object,"keys"),c=l?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||("function"==typeof t?a.enumPrototypes:r(t))?s(t):o(t)?l(t):[]}:s;e.exports=c},{"../internal/getNative":20,"../internal/isArrayLike":21,"../internal/shimKeys":27,"../lang/isObject":33,"../support":41}],39:[function(t,e,i){var n=t("../internal/arrayEach"),r=t("../lang/isArguments"),o=t("../lang/isArray"),s=t("../lang/isFunction"),a=t("../internal/isIndex"),l=t("../internal/isLength"),c=t("../lang/isObject"),u=t("../lang/isString"),h=t("../support"),f="[object Error]",d="[object Object]",p="[object String]",g=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],m=Error.prototype,v=Object.prototype,y=String.prototype,_=v.hasOwnProperty,b=v.toString,w={};w["[object Array]"]=w["[object Date]"]=w["[object Number]"]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},w["[object Boolean]"]=w[p]={constructor:!0,toString:!0,valueOf:!0},w[f]=w["[object Function]"]=w["[object RegExp]"]={constructor:!0,toString:!0},w[d]={constructor:!0},n(g,(function(t){for(var e in w)if(_.call(w,e)){var i=w[e];i[t]=_.call(i,t)}})),e.exports=function(t){if(null==t)return[];c(t)||(t=Object(t));var e=t.length;e=e&&l(e)&&(o(t)||r(t)||u(t))&&e||0;for(var i=t.constructor,n=-1,x=s(i)&&i.prototype||v,C=x===t,T=Array(e),S=e>0,k=h.enumErrorProps&&(t===m||t instanceof Error),O=h.enumPrototypes&&s(t);++n<e;)T[n]=n+"";for(var j in t)O&&"prototype"==j||k&&("message"==j||"name"==j)||S&&a(j,e)||"constructor"==j&&(C||!_.call(t,j))||T.push(j);if(h.nonEnumShadows&&t!==v){var E=t===y?p:t===m?f:b.call(t),A=w[E]||w[d];for(E==d&&(x=v),e=g.length;e--;){var P=A[j=g[e]];C&&P||(P?!_.call(t,j):t[j]===x[j])||T.push(j)}}return T}},{"../internal/arrayEach":9,"../internal/isIndex":23,"../internal/isLength":25,"../lang/isArguments":29,"../lang/isArray":30,"../lang/isFunction":31,"../lang/isObject":33,"../lang/isString":35,"../support":41}],40:[function(t,e,i){var n=t("../internal/baseMerge"),r=t("../internal/createAssigner")(n);e.exports=r},{"../internal/baseMerge":13,"../internal/createAssigner":17}],41:[function(t,e,i){var n=Array.prototype,r=Error.prototype,o=Object.prototype.propertyIsEnumerable,s=n.splice,a={};!function(t){var e=function(){this.x=1},i={0:1,length:1},n=[];for(var l in e.prototype={valueOf:1,y:1},new e)n.push(l);a.enumErrorProps=o.call(r,"message")||o.call(r,"name"),a.enumPrototypes=o.call(e,"prototype"),a.nonEnumShadows=!/valueOf/.test(n),a.ownLast="x"!=n[0],a.spliceObjects=(s.call(i,0,1),!i[0]),a.unindexedChars="x"[0]+Object("x")[0]!="xx"}(),e.exports=a},{}],42:[function(t,e,i){e.exports=function(t){return t}},{}],43:[function(t,e,i){"use strict";var n=t("object-keys");e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test");if("string"==typeof e)return!1;if(e instanceof Symbol)return!1;for(e in t[e]=42,t)return!1;if(0!==n(t).length)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},{"object-keys":49}],44:[function(t,e,i){"use strict";var n=t("object-keys"),r=t("function-bind"),o=function(t){return null!=t},s=t("./hasSymbols")(),a=Object,l=r.call(Function.call,Array.prototype.push),c=r.call(Function.call,Object.prototype.propertyIsEnumerable);e.exports=function(t,e){if(!o(t))throw new TypeError("target must be an object");var i,r,u,h,f,d=a(t);for(i=1;i<arguments.length;++i){if(r=a(arguments[i]),h=n(r),s&&Object.getOwnPropertySymbols)for(f=Object.getOwnPropertySymbols(r),u=0;u<f.length;++u)c(r,f[u])&&l(h,f[u]);for(u=0;u<h.length;++u)d[h[u]]=r[h[u]]}return d}},{"./hasSymbols":43,"function-bind":48,"object-keys":49}],45:[function(t,e,i){"use strict";var n=t("define-properties"),r=t("./implementation");n(r,{implementation:r,getPolyfill:t("./polyfill"),shim:t("./shim")}),e.exports=r},{"./implementation":44,"./polyfill":51,"./shim":52,"define-properties":46}],46:[function(t,e,i){"use strict";var n=t("object-keys"),r=t("foreach"),o="function"==typeof Symbol&&"symbol"==typeof Symbol(),s=Object.prototype.toString,a=Object.defineProperty&&function(){var t={};try{for(var e in Object.defineProperty(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),l=function(t,e,i,n){var r;e in t&&("function"!=typeof(r=n)||"[object Function]"!==s.call(r)||!n())||(a?Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},c=function(t,e){var i=arguments.length>2?arguments[2]:{},s=n(e);o&&(s=s.concat(Object.getOwnPropertySymbols(e))),r(s,(function(n){l(t,n,e[n],i[n])}))};c.supportsDescriptors=!!a,e.exports=c},{foreach:47,"object-keys":49}],47:[function(t,e,i){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(t,e,i){if("[object Function]"!==r.call(e))throw new TypeError("iterator must be a function");var o=t.length;if(o===+o)for(var s=0;s<o;s++)e.call(i,t[s],s,t);else for(var a in t)n.call(t,a)&&e.call(i,t[a],a,t)}},{}],48:[function(t,e,i){var n="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,o=Object.prototype.toString;e.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==o.call(e))throw new TypeError(n+e);for(var i=r.call(arguments,1),s=function(){if(this instanceof u){var n=e.apply(this,i.concat(r.call(arguments)));return Object(n)===n?n:this}return e.apply(t,i.concat(r.call(arguments)))},a=Math.max(0,e.length-i.length),l=[],c=0;c<a;c++)l.push("$"+c);var u=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(s);if(e.prototype){var h=function(){};h.prototype=e.prototype,u.prototype=new h,h.prototype=null}return u}},{}],49:[function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Array.prototype.slice,s=t("./isArguments"),a=!{toString:null}.propertyIsEnumerable("toString"),l=function(){}.propertyIsEnumerable("prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(t){var e=t.constructor;return e&&e.prototype===t},h={$console:!0,$frame:!0,$frameElement:!0,$frames:!0,$parent:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&n.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{u(window[t])}catch(t){return!0}}catch(t){return!0}return!1}(),d=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===r.call(t),o=s(t),h=e&&"[object String]"===r.call(t),d=[];if(!e&&!i&&!o)throw new TypeError("Object.keys called on a non-object");var p=l&&i;if(h&&t.length>0&&!n.call(t,0))for(var g=0;g<t.length;++g)d.push(String(g));if(o&&t.length>0)for(var m=0;m<t.length;++m)d.push(String(m));else for(var v in t)p&&"prototype"===v||!n.call(t,v)||d.push(String(v));if(a)for(var y=function(t){if("undefined"==typeof window||!f)return u(t);try{return u(t)}catch(t){return!1}}(t),_=0;_<c.length;++_)y&&"constructor"===c[_]||!n.call(t,c[_])||d.push(c[_]);return d};d.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var t=Object.keys;Object.keys=function(e){return s(e)?t(o.call(e)):t(e)}}}else Object.keys=d;return Object.keys||d},e.exports=d},{"./isArguments":50}],50:[function(t,e,i){"use strict";var n=Object.prototype.toString;e.exports=function(t){var e=n.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),i}},{}],51:[function(t,e,i){"use strict";var n=t("./implementation");e.exports=function(){return!Object.assign||function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(e){return"y"===t[1]}}()?n:Object.assign}},{"./implementation":44}],52:[function(t,e,i){"use strict";var n=t("define-properties"),r=t("./polyfill");e.exports=function(){var t=r();return Object.assign!==t&&n(Object,{assign:t}),t}},{"./polyfill":51,"define-properties":46}],53:[function(t,e,i){e.exports=function(t,e){var i,n=null;try{i=JSON.parse(t,e)}catch(t){n=t}return[n,i]}},{}],54:[function(t,e,i){function n(t){return t.replace(/\n\r?\s*/g,"")}e.exports=function(t){for(var e="",i=0;i<arguments.length;i++)e+=n(t[i])+(arguments[i+1]||"");return e}},{}],55:[function(t,e,i){"use strict";var n=t("global/window"),r=t("once"),o=t("parse-headers");function s(t,e){function i(){var t=void 0;if(h.response?t=h.response:"text"!==h.responseType&&h.responseType||(t=h.responseText||h.responseXML),y)try{t=JSON.parse(t)}catch(t){}return t}var n={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:h};function a(t){clearTimeout(f),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,e(t,n)}function l(){if(!u){var r;clearTimeout(f),r=t.useXDR&&void 0===h.status?200:1223===h.status?204:h.status;var s=n,a=null;0!==r?(s={body:i(),statusCode:r,method:p,headers:{},url:d,rawRequest:h},h.getAllResponseHeaders&&(s.headers=o(h.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),e(a,s,s.body)}}if("string"==typeof t&&(t={uri:t}),t=t||{},void 0===e)throw new Error("callback argument missing");e=r(e);var c,u,h=t.xhr||null;h||(h=t.cors||t.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var f,d=h.url=t.uri||t.url,p=h.method=t.method||"GET",g=t.body||t.data,m=h.headers=t.headers||{},v=!!t.sync,y=!1;if("json"in t&&(y=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),g=JSON.stringify(t.json))),h.onreadystatechange=function(){4===h.readyState&&l()},h.onload=l,h.onerror=a,h.onprogress=function(){},h.ontimeout=a,h.open(p,d,!v,t.username,t.password),v||(h.withCredentials=!!t.withCredentials),!v&&t.timeout>0&&(f=setTimeout((function(){u=!0,h.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",a(t)}),t.timeout)),h.setRequestHeader)for(c in m)m.hasOwnProperty(c)&&h.setRequestHeader(c,m[c]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(h),h.send(g),h}e.exports=s,s.XMLHttpRequest=n.XMLHttpRequest||function(){},s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:n.XDomainRequest},{"global/window":2,once:56,"parse-headers":60}],56:[function(t,e,i){function n(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}e.exports=n,n.proto=n((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})}))},{}],57:[function(t,e,i){var n=t("is-function");e.exports=function(t,e,i){if(!n(e))throw new TypeError("iterator must be a function");arguments.length<3&&(i=this),"[object Array]"===r.call(t)?function(t,e,i){for(var n=0,r=t.length;n<r;n++)o.call(t,n)&&e.call(i,t[n],n,t)}(t,e,i):"string"==typeof t?function(t,e,i){for(var n=0,r=t.length;n<r;n++)e.call(i,t.charAt(n),n,t)}(t,e,i):function(t,e,i){for(var n in t)o.call(t,n)&&e.call(i,t[n],n,t)}(t,e,i)};var r=Object.prototype.toString,o=Object.prototype.hasOwnProperty},{"is-function":58}],58:[function(t,e,i){e.exports=function(t){var e=n.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)};var n=Object.prototype.toString},{}],59:[function(t,e,i){(i=e.exports=function(t){return t.replace(/^\s*|\s*$/g,"")}).left=function(t){return t.replace(/^\s*/,"")},i.right=function(t){return t.replace(/\s*$/,"")}},{}],60:[function(t,e,i){var n=t("trim"),r=t("for-each");e.exports=function(t){if(!t)return{};var e={};return r(n(t).split("\n"),(function(t){var i,r=t.indexOf(":"),o=n(t.slice(0,r)).toLowerCase(),s=n(t.slice(r+1));void 0===e[o]?e[o]=s:(i=e[o],"[object Array]"===Object.prototype.toString.call(i)?e[o].push(s):e[o]=[e[o],s])})),e}},{"for-each":57,trim:59}],61:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./button.js")),o=n(t("./component.js")),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(){this.player_.play()},e}(r.default);s.prototype.controlText_="Play Video",o.default.registerComponent("BigPlayButton",s),i.default=s,e.exports=i.default},{"./button.js":62,"./component.js":63}],62:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./component")),s=n(t("./utils/dom.js")),a=n(t("./utils/events.js")),l=n(t("./utils/fn.js")),c=r(t("global/document")),u=r(t("object.assign")),h=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.emitTapEvents(),this.on("tap",this.handleClick),this.on("click",this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=arguments.length<=0||void 0===arguments[0]?"button":arguments[0],i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];i=u.default({className:this.buildCSSClass(),tabIndex:0},i),n=u.default({role:"button",type:"button","aria-live":"polite"},n);var r=t.prototype.createEl.call(this,e,i,n);return this.controlTextEl_=s.createEl("span",{className:"vjs-control-text"}),r.appendChild(this.controlTextEl_),this.controlText(this.controlText_),r},e.prototype.controlText=function(t){return t?(this.controlText_=t,this.controlTextEl_.innerHTML=this.localize(this.controlText_),this):this.controlText_||"Need Text"},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){},e.prototype.handleFocus=function(){a.on(c.default,"keydown",l.bind(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(t){32!==t.which&&13!==t.which||(t.preventDefault(),this.handleClick(t))},e.prototype.handleBlur=function(){a.off(c.default,"keydown",l.bind(this,this.handleKeyPress))},e}(o.default);o.default.registerComponent("Button",h),i.default=h,e.exports=i.default},{"./component":63,"./utils/dom.js":123,"./utils/events.js":124,"./utils/fn.js":125,"global/document":1,"object.assign":45}],63:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("global/window")),s=n(t("./utils/dom.js")),a=n(t("./utils/fn.js")),l=n(t("./utils/guid.js")),c=n(t("./utils/events.js")),u=r(t("./utils/log.js")),h=r(t("./utils/to-title-case.js")),f=r(t("object.assign")),d=r(t("./utils/merge-options.js")),p=function(){function t(e,i,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=d.default({},this.options_),i=this.options_=d.default(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+l.newGUID()}this.name_=i.name||null,i.el?this.el_=i.el:!1!==i.createEl&&(this.el_=this.createEl()),this.children_=[],this.childIndex_={},this.childNameIndex_={},!1!==i.initChildren&&this.initChildren(),this.ready(n),!1!==i.reportTouchActivity&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),s.removeElData(this.el_),this.el_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return u.default.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=d.default(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,i){return s.createEl(t,e,i)},t.prototype.localize=function(t){var e=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages();if(!e||!i)return t;var n=i[e];if(n&&n[t])return n[t];var r=i[e.split("-")[0]];return r&&r[t]?r[t]:t},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){return this.childNameIndex_[t]},t.prototype.addChild=function(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=void 0,r=void 0;if("string"==typeof e){r=e,i||(i={}),!0===i&&(u.default.warn("Initializing a child component with `true` is deprecated. Children should be defined in an array when possible, but if necessary use an object instead of `true`."),i={});var o=i.componentClass||h.default(r);i.name=r;var s=t.getComponent(o);n=new s(this.player_||this,i)}else n=e;return this.children_.push(n),"function"==typeof n.id&&(this.childIndex_[n.id()]=n),(r=r||n.name&&n.name())&&(this.childNameIndex_[r]=n),"function"==typeof n.el&&n.el()&&this.contentEl().appendChild(n.el()),n},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===t){e=!0,this.children_.splice(i,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var n=t.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var t=this,e=this.options_.children;e&&function(){var i=t.options_,n=function(e,n){void 0!==i[e]&&(n=i[e]),!1!==n&&(!0===n&&(n={}),n.playerOptions=t.options_.playerOptions,t[e]=t.addChild(e,n))};if(Array.isArray(e))for(var r=0;r<e.length;r++){var o=e[r],s=void 0,a=void 0;"string"==typeof o?(s=o,a={}):(s=o.name,a=o),n(s,a)}else Object.getOwnPropertyNames(e).forEach((function(t){n(t,e[t])}))}()},t.prototype.buildCSSClass=function(){return""},t.prototype.on=function(t,e,i){var n=this;return"string"==typeof t||Array.isArray(t)?c.on(this.el_,t,a.bind(this,e)):function(){var r=t,o=e,s=a.bind(n,i),l=function(){return n.off(r,o,s)};l.guid=s.guid,n.on("dispose",l);var u=function(){return n.off("dispose",l)};u.guid=s.guid,t.nodeName?(c.on(r,o,s),c.on(r,"dispose",u)):"function"==typeof t.on&&(r.on(o,s),r.on("dispose",u))}(),this},t.prototype.off=function(t,e,i){if(!t||"string"==typeof t||Array.isArray(t))c.off(this.el_,t,e);else{var n=t,r=e,o=a.bind(this,i);this.off("dispose",o),t.nodeName?(c.off(n,r,o),c.off(n,"dispose",o)):(n.off(r,o),n.off("dispose",o))}return this},t.prototype.one=function(t,e,i){var n,r,o,s,l=this,u=arguments;return"string"==typeof t||Array.isArray(t)?c.one(this.el_,t,a.bind(this,e)):(n=t,r=e,o=a.bind(l,i),(s=function t(){l.off(n,r,t),o.apply(null,u)}).guid=o.guid,l.on(n,r,s)),this},t.prototype.trigger=function(t,e){return c.trigger(this.el_,t,e),this},t.prototype.ready=function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return t&&(this.isReady_?e?t.call(this):this.setTimeout(t,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(t))),this},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout((function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach((function(t){t.call(this)}),this),this.trigger("ready")}),1)},t.prototype.hasClass=function(t){return s.hasElClass(this.el_,t)},t.prototype.addClass=function(t){return s.addElClass(this.el_,t),this},t.prototype.removeClass=function(t){return s.removeElClass(this.el_,t),this},t.prototype.show=function(){return this.removeClass("vjs-hidden"),this},t.prototype.hide=function(){return this.addClass("vjs-hidden"),this},t.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},t.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){return this.width(t,!0).height(e)},t.prototype.dimension=function(t,e,i){if(void 0!==e)return null!==e&&e==e||(e=0),-1!==(""+e).indexOf("%")||-1!==(""+e).indexOf("px")?this.el_.style[t]=e:this.el_.style[t]="auto"===e?"":e+"px",i||this.trigger("resize"),this;if(!this.el_)return 0;var n=this.el_.style[t],r=n.indexOf("px");return-1!==r?parseInt(n.slice(0,r),10):parseInt(this.el_["offset"+h.default(t)],10)},t.prototype.emitTapEvents=function(){var t=0,e=null,i=void 0;this.on("touchstart",(function(n){1===n.touches.length&&(e=f.default({},n.touches[0]),t=(new Date).getTime(),i=!0)})),this.on("touchmove",(function(t){if(t.touches.length>1)i=!1;else if(e){var n=t.touches[0].pageX-e.pageX,r=t.touches[0].pageY-e.pageY;Math.sqrt(n*n+r*r)>10&&(i=!1)}}));var n=function(){i=!1};this.on("touchleave",n),this.on("touchcancel",n),this.on("touchend",(function(n){e=null,!0===i&&(new Date).getTime()-t<200&&(n.preventDefault(),this.trigger("tap"))}))},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=a.bind(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",(function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}));var i=function(i){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},t.prototype.setTimeout=function(t,e){t=a.bind(this,t);var i=o.default.setTimeout(t,e),n=function(){this.clearTimeout(i)};return n.guid="vjs-timeout-"+i,this.on("dispose",n),i},t.prototype.clearTimeout=function(t){o.default.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){t=a.bind(this,t);var i=o.default.setInterval(t,e),n=function(){this.clearInterval(i)};return n.guid="vjs-interval-"+i,this.on("dispose",n),i},t.prototype.clearInterval=function(t){o.default.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.registerComponent=function(e,i){return t.components_||(t.components_={}),t.components_[e]=i,i},t.getComponent=function(e){return t.components_&&t.components_[e]?t.components_[e]:o.default&&o.default.videojs&&o.default.videojs[e]?(u.default.warn("The "+e+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)"),o.default.videojs[e]):void 0},t.extend=function(e){e=e||{},u.default.warn("Component.extend({}) has been deprecated, use videojs.extend(Component, {}) instead");var i=e.init||e.init||this.prototype.init||this.prototype.init||function(){},n=function(){i.apply(this,arguments)};for(var r in(n.prototype=Object.create(this.prototype)).constructor=n,n.extend=t.extend,e)e.hasOwnProperty(r)&&(n.prototype[r]=e[r]);return n},t}();p.registerComponent("Component",p),i.default=p,e.exports=i.default},{"./utils/dom.js":123,"./utils/events.js":124,"./utils/fn.js":125,"./utils/guid.js":127,"./utils/log.js":128,"./utils/merge-options.js":129,"./utils/to-title-case.js":132,"global/window":2,"object.assign":45}],64:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../component.js")),o=(n(t("./play-toggle.js")),n(t("./time-controls/current-time-display.js")),n(t("./time-controls/duration-display.js")),n(t("./time-controls/time-divider.js")),n(t("./time-controls/remaining-time-display.js")),n(t("./live-display.js")),n(t("./progress-control/progress-control.js")),n(t("./fullscreen-toggle.js")),n(t("./volume-control/volume-control.js")),n(t("./volume-menu-button.js")),n(t("./mute-toggle.js")),n(t("./text-track-controls/chapters-button.js")),n(t("./text-track-controls/subtitles-button.js")),n(t("./text-track-controls/captions-button.js")),n(t("./playback-rate-menu/playback-rate-menu-button.js")),n(t("./spacer-controls/custom-control-spacer.js")),function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar"})},e}(r.default));o.prototype.options_={loadEvent:"play",children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","subtitlesButton","captionsButton","fullscreenToggle"]},r.default.registerComponent("ControlBar",o),i.default=o,e.exports=i.default},{"../component.js":63,"./fullscreen-toggle.js":65,"./live-display.js":66,"./mute-toggle.js":67,"./play-toggle.js":68,"./playback-rate-menu/playback-rate-menu-button.js":69,"./progress-control/progress-control.js":74,"./spacer-controls/custom-control-spacer.js":76,"./text-track-controls/captions-button.js":79,"./text-track-controls/chapters-button.js":80,"./text-track-controls/subtitles-button.js":83,"./time-controls/current-time-display.js":86,"./time-controls/duration-display.js":87,"./time-controls/remaining-time-display.js":88,"./time-controls/time-divider.js":89,"./volume-control/volume-control.js":91,"./volume-menu-button.js":93}],65:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../button.js")),o=n(t("../component.js")),s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText("Fullscreen")):(this.player_.requestFullscreen(),this.controlText("Non-Fullscreen"))},e}(r.default);s.prototype.controlText_="Fullscreen",o.default.registerComponent("FullscreenToggle",s),i.default=s,e.exports=i.default},{"../button.js":62,"../component.js":63}],66:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../component"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/dom.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.updateShowing(),this.on(this.player(),"durationchange",this.updateShowing)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=s.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateShowing=function(){this.player().duration()===1/0?this.show():this.hide()},e}(o.default);o.default.registerComponent("LiveDisplay",a),i.default=a,e.exports=i.default},{"../component":63,"../utils/dom.js":123}],67:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../button")),o=n(t("../component")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/dom.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"volumechange",this.update),i.tech_&&!1===i.tech_.featuresVolumeControl&&this.addClass("vjs-hidden"),this.on(i,"loadstart",(function(){this.update(),!1===i.tech_.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.muted(!this.player_.muted())},e.prototype.update=function(){var t=this.player_.volume(),e=3;0===t||this.player_.muted()?e=0:t<.33?e=1:t<.67&&(e=2);var i=this.player_.muted()?"Unmute":"Mute",n=this.localize(i);this.controlText()!==n&&this.controlText(n);for(var r=0;r<4;r++)s.removeElClass(this.el_,"vjs-vol-"+r);s.addElClass(this.el_,"vjs-vol-"+e)},e}(r.default);a.prototype.controlText_="Mute",o.default.registerComponent("MuteToggle",a),i.default=a,e.exports=i.default},{"../button":62,"../component":63,"../utils/dom.js":123}],68:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../button.js")),o=n(t("../component.js")),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"play",this.handlePlay),this.on(i,"pause",this.handlePause)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handlePlay=function(){this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},e.prototype.handlePause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},e}(r.default);s.prototype.controlText_="Play",o.default.registerComponent("PlayToggle",s),i.default=s,e.exports=i.default},{"../button.js":62,"../component.js":63}],69:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../menu/menu-button.js")),o=n(t("../../menu/menu.js")),s=n(t("./playback-rate-menu-item.js")),a=n(t("../../component.js")),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/dom.js")),c=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.updateVisibility(),this.updateLabel(),this.on(i,"loadstart",this.updateVisibility),this.on(i,"ratechange",this.updateLabel)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=l.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),e.appendChild(this.labelEl_),e},e.prototype.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},e.prototype.createMenu=function(){var t=new o.default(this.player()),e=this.playbackRates();if(e)for(var i=e.length-1;i>=0;i--)t.addChild(new s.default(this.player(),{rate:e[i]+"x"}));return t},e.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},e.prototype.handleClick=function(){for(var t=this.player().playbackRate(),e=this.playbackRates(),i=e[0],n=0;n<e.length;n++)if(e[n]>t){i=e[n];break}this.player().playbackRate(i)},e.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},e.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},e.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},e.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(r.default);c.prototype.controlText_="Playback Rate",a.default.registerComponent("PlaybackRateMenuButton",c),i.default=c,e.exports=i.default},{"../../component.js":63,"../../menu/menu-button.js":100,"../../menu/menu.js":102,"../../utils/dom.js":123,"./playback-rate-menu-item.js":70}],70:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../menu/menu-item.js")),o=n(t("../../component.js")),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.rate,o=parseFloat(r,10);n.label=r,n.selected=1===o,t.call(this,i,n),this.label=r,this.rate=o,this.on(i,"ratechange",this.update)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},e.prototype.update=function(){this.selected(this.player().playbackRate()===this.rate)},e}(r.default);s.prototype.contentElType="button",o.default.registerComponent("PlaybackRateMenuItem",s),i.default=s,e.exports=i.default},{"../../component.js":63,"../../menu/menu-item.js":101}],71:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../component.js"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/dom.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"progress",this.update)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},e.prototype.update=function(){var t=this.player_.buffered(),e=this.player_.duration(),i=this.player_.bufferedEnd(),n=this.el_.children,r=function(t,e){var i=t/e||0;return 100*(i>=1?1:i)+"%"};this.el_.style.width=r(i,e);for(var o=0;o<t.length;o++){var a=t.start(o),l=t.end(o),c=n[o];c||(c=this.el_.appendChild(s.createEl())),c.style.left=r(a,i),c.style.width=r(l-a,i)}for(o=n.length;o>t.length;o--)this.el_.removeChild(n[o-1])},e}(o.default);o.default.registerComponent("LoadProgressBar",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../utils/dom.js":123}],72:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("../../component.js")),s=n(t("../../utils/dom.js")),a=n(t("../../utils/fn.js")),l=r(t("../../utils/format-time.js")),c=r(t("lodash-compat/function/throttle")),u=function(t){function e(i,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.update(0,0),i.on("ready",(function(){r.on(i.controlBar.progressControl.el(),"mousemove",c.default(a.bind(r,r.handleMouseMove),25))}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.prototype.handleMouseMove=function(t){var e=this.player_.duration(),i=this.calculateDistance(t)*e,n=t.pageX-s.findElPosition(this.el().parentNode).left;this.update(i,n)},e.prototype.update=function(t,e){var i=l.default(t,this.player_.duration());this.el().style.left=e+"px",this.el().setAttribute("data-current-time",i)},e.prototype.calculateDistance=function(t){return s.getPointerPosition(this.el().parentNode,t).x},e}(o.default);o.default.registerComponent("MouseTimeDisplay",u),i.default=u,e.exports=i.default},{"../../component.js":63,"../../utils/dom.js":123,"../../utils/fn.js":125,"../../utils/format-time.js":126,"lodash-compat/function/throttle":7}],73:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js")),s=n(t("../../utils/format-time.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.updateDataAttr(),this.on(i,"timeupdate",this.updateDataAttr),i.ready(o.bind(this,this.updateDataAttr))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},e.prototype.updateDataAttr=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",s.default(t,this.player_.duration()))},e}(r.default);r.default.registerComponent("PlayProgressBar",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../utils/fn.js":125,"../../utils/format-time.js":126}],74:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=(n(t("./seek-bar.js")),n(t("./mouse-time-display.js")),function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},e}(r.default));o.prototype.options_={children:["seekBar"]},r.default.registerComponent("ProgressControl",o),i.default=o,e.exports=i.default},{"../../component.js":63,"./mouse-time-display.js":72,"./seek-bar.js":75}],75:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../slider/slider.js")),o=n(t("../../component.js")),s=(n(t("./load-progress-bar.js")),n(t("./play-progress-bar.js")),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js"))),a=n(t("../../utils/format-time.js")),l=(n(t("object.assign")),function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"timeupdate",this.updateARIAAttributes),i.ready(s.bind(this,this.updateARIAAttributes))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"video progress bar"})},e.prototype.updateARIAAttributes=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",(100*this.getPercent()).toFixed(2)),this.el_.setAttribute("aria-valuetext",a.default(t,this.player_.duration()))},e.prototype.getPercent=function(){var t=this.player_.currentTime()/this.player_.duration();return t>=1?1:t},e.prototype.handleMouseDown=function(e){t.prototype.handleMouseDown.call(this,e),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},e.prototype.handleMouseMove=function(t){var e=this.calculateDistance(t)*this.player_.duration();e===this.player_.duration()&&(e-=.1),this.player_.currentTime(e)},e.prototype.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),this.player_.scrubbing(!1),this.videoWasPlaying&&this.player_.play()},e.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},e.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},e}(r.default));l.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"},l.prototype.playerEvent="timeupdate",o.default.registerComponent("SeekBar",l),i.default=l,e.exports=i.default},{"../../component.js":63,"../../slider/slider.js":107,"../../utils/fn.js":125,"../../utils/format-time.js":126,"./load-progress-bar.js":71,"./play-progress-bar.js":73,"object.assign":45}],76:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./spacer.js")),o=n(t("../../component.js")),s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="&nbsp;",e},e}(r.default);o.default.registerComponent("CustomControlSpacer",s),i.default=s,e.exports=i.default},{"../../component.js":63,"./spacer.js":77}],77:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../component.js"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e}(o.default);o.default.registerComponent("Spacer",s),i.default=s,e.exports=i.default},{"../../component.js":63}],78:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./text-track-menu-item.js")),o=n(t("../../component.js")),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n.track={kind:n.kind,player:i,label:n.kind+" settings",default:!1,mode:"disabled"},t.call(this,i,n),this.addClass("vjs-texttrack-settings")}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(){this.player().getChild("textTrackSettings").show()},e}(r.default);o.default.registerComponent("CaptionSettingsMenuItem",s),i.default=s,e.exports=i.default},{"../../component.js":63,"./text-track-menu-item.js":85}],79:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./text-track-button.js")),o=n(t("../../component.js")),s=n(t("./caption-settings-menu-item.js")),a=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n,r),this.el_.setAttribute("aria-label","Captions Menu")}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.update=function(){var e=2;t.prototype.update.call(this),this.player().tech_&&this.player().tech_.featuresNativeTextTracks&&(e=1),this.items&&this.items.length>e?this.show():this.hide()},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||e.push(new s.default(this.player_,{kind:this.kind_})),t.prototype.createItems.call(this,e)},e}(r.default);a.prototype.kind_="captions",a.prototype.controlText_="Captions",o.default.registerComponent("CaptionsButton",a),i.default=a,e.exports=i.default},{"../../component.js":63,"./caption-settings-menu-item.js":78,"./text-track-button.js":84}],80:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./text-track-button.js")),s=r(t("../../component.js")),a=r(t("./text-track-menu-item.js")),l=r(t("./chapters-track-menu-item.js")),c=r(t("../../menu/menu.js")),u=n(t("../../utils/dom.js")),h=n(t("../../utils/fn.js")),f=r(t("../../utils/to-title-case.js")),d=r(t("global/window")),p=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n,r),this.el_.setAttribute("aria-label","Chapters Menu")}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},e.prototype.createItems=function(){var t=[],e=this.player_.textTracks();if(!e)return t;for(var i=0;i<e.length;i++){var n=e[i];n.kind===this.kind_&&t.push(new a.default(this.player_,{track:n}))}return t},e.prototype.createMenu=function(){for(var t=this.player_.textTracks()||[],e=void 0,i=this.items=[],n=0,r=t.length;n<r;n++){var o=t[n];if(o.kind===this.kind_){if(o.cues){e=o;break}o.mode="hidden",d.default.setTimeout(h.bind(this,(function(){this.createMenu()})),100)}}var s=this.menu;if(void 0===s&&(s=new c.default(this.player_)).contentEl().appendChild(u.createEl("li",{className:"vjs-menu-title",innerHTML:f.default(this.kind_),tabIndex:-1})),e){var a=e.cues,p=void 0;for(n=0,r=a.length;n<r;n++){p=a[n];var g=new l.default(this.player_,{track:e,cue:p});i.push(g),s.addChild(g)}this.addChild(s)}return this.items.length>0&&this.show(),s},e}(o.default);p.prototype.kind_="chapters",p.prototype.controlText_="Chapters",s.default.registerComponent("ChaptersButton",p),i.default=p,e.exports=i.default},{"../../component.js":63,"../../menu/menu.js":102,"../../utils/dom.js":123,"../../utils/fn.js":125,"../../utils/to-title-case.js":132,"./chapters-track-menu-item.js":81,"./text-track-button.js":84,"./text-track-menu-item.js":85,"global/window":2}],81:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../menu/menu-item.js")),o=n(t("../../component.js")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.track,o=n.cue,a=i.currentTime();n.label=o.text,n.selected=o.startTime<=a&&a<o.endTime,t.call(this,i,n),this.track=r,this.cue=o,r.addEventListener("cuechange",s.bind(this,this.update))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},e.prototype.update=function(){var t=this.cue,e=this.player_.currentTime();this.selected(t.startTime<=e&&e<t.endTime)},e}(r.default);o.default.registerComponent("ChaptersTrackMenuItem",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../menu/menu-item.js":101,"../../utils/fn.js":125}],82:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./text-track-menu-item.js")),o=n(t("../../component.js")),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n.track={kind:n.kind,player:i,label:n.kind+" off",default:!1,mode:"disabled"},t.call(this,i,n),this.selected(!0)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),i=!0,n=0,r=e.length;n<r;n++){var o=e[n];if(o.kind===this.track.kind&&"showing"===o.mode){i=!1;break}}this.selected(i)},e}(r.default);o.default.registerComponent("OffTextTrackMenuItem",s),i.default=s,e.exports=i.default},{"../../component.js":63,"./text-track-menu-item.js":85}],83:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("./text-track-button.js")),o=n(t("../../component.js")),s=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n,r),this.el_.setAttribute("aria-label","Subtitles Menu")}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},e}(r.default);s.prototype.kind_="subtitles",s.prototype.controlText_="Subtitles",o.default.registerComponent("SubtitlesButton",s),i.default=s,e.exports=i.default},{"../../component.js":63,"./text-track-button.js":84}],84:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../menu/menu-button.js")),o=n(t("../../component.js")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js")),a=n(t("./text-track-menu-item.js")),l=n(t("./off-text-track-menu-item.js")),c=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n);var r=this.player_.textTracks();if(this.items.length<=1&&this.hide(),r){var o=s.bind(this,this.update);r.addEventListener("removetrack",o),r.addEventListener("addtrack",o),this.player_.on("dispose",(function(){r.removeEventListener("removetrack",o),r.removeEventListener("addtrack",o)}))}}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createItems=function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];t.push(new l.default(this.player_,{kind:this.kind_}));var e=this.player_.textTracks();if(!e)return t;for(var i=0;i<e.length;i++){var n=e[i];n.kind===this.kind_&&t.push(new a.default(this.player_,{track:n}))}return t},e}(r.default);o.default.registerComponent("TextTrackButton",c),i.default=c,e.exports=i.default},{"../../component.js":63,"../../menu/menu-button.js":100,"../../utils/fn.js":125,"./off-text-track-menu-item.js":82,"./text-track-menu-item.js":85}],85:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../menu/menu-item.js")),o=n(t("../../component.js")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js")),a=n(t("global/window")),l=n(t("global/document")),c=function(t){function e(i,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o,c,u=n.track,h=i.textTracks();n.label=u.label||u.language||"Unknown",n.selected=u.default||"showing"===u.mode,t.call(this,i,n),this.track=u,h&&(o=s.bind(r,r.handleTracksChange),h.addEventListener("change",o),r.on("dispose",(function(){h.removeEventListener("change",o)}))),h&&void 0===h.onchange&&(c=void 0,r.on(["tap","click"],(function(){if("object"!=typeof a.default.Event)try{c=new a.default.Event("change")}catch(t){}c||(c=l.default.createEvent("Event")).initEvent("change",!0,!0),h.dispatchEvent(c)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(e){var i=this.track.kind,n=this.player_.textTracks();if(t.prototype.handleClick.call(this,e),n)for(var r=0;r<n.length;r++){var o=n[r];o.kind===i&&(o===this.track?o.mode="showing":o.mode="disabled")}},e.prototype.handleTracksChange=function(t){this.selected("showing"===this.track.mode)},e}(r.default);o.default.registerComponent("TextTrackMenuItem",c),i.default=c,e.exports=i.default},{"../../component.js":63,"../../menu/menu-item.js":101,"../../utils/fn.js":125,"global/document":1,"global/window":2}],86:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/dom.js")),s=n(t("../../utils/format-time.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"timeupdate",this.updateContent)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});return this.contentEl_=o.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00'},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),e=this.localize("Current Time"),i=s.default(t,this.player_.duration());this.contentEl_.innerHTML='<span class="vjs-control-text">'+e+"</span> "+i},e}(r.default);r.default.registerComponent("CurrentTimeDisplay",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../utils/dom.js":123,"../../utils/format-time.js":126}],87:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/dom.js")),s=n(t("../../utils/format-time.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"timeupdate",this.updateContent),this.on(i,"loadedmetadata",this.updateContent)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});return this.contentEl_=o.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){var t=this.player_.duration();if(t){var e=this.localize("Duration Time"),i=s.default(t);this.contentEl_.innerHTML='<span class="vjs-control-text">'+e+"</span> "+i}},e}(r.default);r.default.registerComponent("DurationDisplay",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../utils/dom.js":123,"../../utils/format-time.js":126}],88:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/dom.js")),s=n(t("../../utils/format-time.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"timeupdate",this.updateContent)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});return this.contentEl_=o.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){if(this.player_.duration()){var t=this.localize("Remaining Time"),e=s.default(this.player_.remainingTime());this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span> -"+e}},e}(r.default);r.default.registerComponent("RemainingTimeDisplay",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../utils/dom.js":123,"../../utils/format-time.js":126}],89:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../component.js"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},e}(o.default);o.default.registerComponent("TimeDivider",s),i.default=s,e.exports=i.default},{"../../component.js":63}],90:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../slider/slider.js")),o=n(t("../../component.js")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../utils/fn.js")),a=(n(t("./volume-level.js")),function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.on(i,"volumechange",this.updateARIAAttributes),i.ready(s.bind(this,this.updateARIAAttributes))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"})},e.prototype.handleMouseMove=function(t){this.player_.muted()&&this.player_.muted(!1),this.player_.volume(this.calculateDistance(t))},e.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},e.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},e.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},e.prototype.updateARIAAttributes=function(){var t=(100*this.player_.volume()).toFixed(2);this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},e}(r.default));a.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},a.prototype.playerEvent="volumechange",o.default.registerComponent("VolumeBar",a),i.default=a,e.exports=i.default},{"../../component.js":63,"../../slider/slider.js":107,"../../utils/fn.js":125,"./volume-level.js":92}],91:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../../component.js")),o=(n(t("./volume-bar.js")),function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),i.tech_&&!1===i.tech_.featuresVolumeControl&&this.addClass("vjs-hidden"),this.on(i,"loadstart",(function(){!1===i.tech_.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},e}(r.default));o.prototype.options_={children:["volumeBar"]},r.default.registerComponent("VolumeControl",o),i.default=o,e.exports=i.default},{"../../component.js":63,"./volume-bar.js":90}],92:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../component.js"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},e}(o.default);o.default.registerComponent("VolumeLevel",s),i.default=s,e.exports=i.default},{"../../component.js":63}],93:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,n(t("../button.js"));var r=n(t("../component.js")),o=n(t("../menu/menu.js")),s=n(t("../menu/menu-button.js")),a=n(t("./mute-toggle.js")),l=n(t("./volume-control/volume-bar.js")),c=function(t){function e(i){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];function r(){i.tech_&&!1===i.tech_.featuresVolumeControl?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===n.inline&&(n.inline=!0),void 0===n.vertical&&(n.inline?n.vertical=!1:n.vertical=!0),n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=!!n.vertical,t.call(this,i,n),this.on(i,"volumechange",this.volumeUpdate),this.on(i,"loadstart",this.volumeUpdate),r.call(this),this.on(i,"loadstart",r),this.on(this.volumeBar,["slideractive","focus"],(function(){this.addClass("vjs-slider-active")})),this.on(this.volumeBar,["sliderinactive","blur"],(function(){this.removeClass("vjs-slider-active")}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.buildCSSClass=function(){var e="";return e=this.options_.vertical?"vjs-volume-menu-button-vertical":"vjs-volume-menu-button-horizontal","vjs-volume-menu-button "+t.prototype.buildCSSClass.call(this)+" "+e},e.prototype.createMenu=function(){var t=new o.default(this.player_,{contentElType:"div"}),e=new l.default(this.player_,this.options_.volumeBar);return t.addChild(e),this.volumeBar=e,t},e.prototype.handleClick=function(){a.default.prototype.handleClick.call(this),t.prototype.handleClick.call(this)},e}(s.default);c.prototype.volumeUpdate=a.default.prototype.update,c.prototype.controlText_="Mute",r.default.registerComponent("VolumeMenuButton",c),i.default=c,e.exports=i.default},{"../button.js":62,"../component.js":63,"../menu/menu-button.js":100,"../menu/menu.js":102,"./mute-toggle.js":67,"./volume-control/volume-bar.js":90}],94:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./component"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./utils/dom.js")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.update(),this.on(i,"error",this.update)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-error-display"});return this.contentEl_=s.createEl("div"),e.appendChild(this.contentEl_),e},e.prototype.update=function(){this.player().error()&&(this.contentEl_.innerHTML=this.localize(this.player().error().message))},e}(o.default);o.default.registerComponent("ErrorDisplay",a),i.default=a,e.exports=i.default},{"./component":63,"./utils/dom.js":123}],95:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./utils/events.js")),r=function(){};r.prototype.allowedEvents_={},r.prototype.on=function(t,e){var i=this.addEventListener;this.addEventListener=Function.prototype,n.on(this,t,e),this.addEventListener=i},r.prototype.addEventListener=r.prototype.on,r.prototype.off=function(t,e){n.off(this,t,e)},r.prototype.removeEventListener=r.prototype.off,r.prototype.one=function(t,e){n.one(this,t,e)},r.prototype.trigger=function(t){var e=t.type||t;"string"==typeof t&&(t={type:e}),t=n.fixEvent(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),n.trigger(this,t)},r.prototype.dispatchEvent=r.prototype.trigger,i.default=r,e.exports=i.default},{"./utils/events.js":124}],96:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./utils/log"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)};i.default=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=function(){t.apply(this,arguments)},n={};for(var r in"object"==typeof e?("function"==typeof e.init&&(o.default.warn("Constructor logic via init() is deprecated; please use constructor() instead."),e.constructor=e.init),e.constructor!==Object.prototype.constructor&&(i=e.constructor),n=e):"function"==typeof e&&(i=e),s(i,t),n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i},e.exports=i.default},{"./utils/log":128}],97:[function(t,e,i){"use strict";i.__esModule=!0;for(var n,r=t("global/document"),o=(n=r)&&n.__esModule?n:{default:n},s={},a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],l=a[0],c=void 0,u=0;u<a.length;u++)if(a[u][1]in o.default){c=a[u];break}if(c)for(u=0;u<c.length;u++)s[l[u]]=c[u];i.default=s,e.exports=i.default},{"global/document":1}],98:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./component"),o=(n=r)&&n.__esModule?n:{default:n},s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},e}(o.default);o.default.registerComponent("LoadingSpinner",s),i.default=s,e.exports=i.default},{"./component":63}],99:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("object.assign"),o=(n=r)&&n.__esModule?n:{default:n},s=function t(e){"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:"object"==typeof e&&o.default(this,e),this.message||(this.message=t.defaultMessages[this.code]||"")};s.prototype.code=0,s.prototype.message="",s.prototype.status=null,s.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],s.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var a=0;a<s.errorTypes.length;a++)s[s.errorTypes[a]]=a,s.prototype[s.errorTypes[a]]=a;i.default=s,e.exports=i.default},{"object.assign":45}],100:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("../button.js")),s=r(t("../component.js")),a=r(t("./menu.js")),l=n(t("../utils/dom.js")),c=n(t("../utils/fn.js")),u=r(t("../utils/to-title-case.js")),h=function(t){function e(i){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.update(),this.on("keydown",this.handleKeyPress),this.el_.setAttribute("aria-haspopup",!0),this.el_.setAttribute("role","button")}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){var t=this.createMenu();this.menu&&this.removeChild(this.menu),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},e.prototype.createMenu=function(){var t=new a.default(this.player_);if(this.options_.title&&t.contentEl().appendChild(l.createEl("li",{className:"vjs-menu-title",innerHTML:u.default(this.options_.title),tabIndex:-1})),this.items=this.createItems(),this.items)for(var e=0;e<this.items.length;e++)t.addItem(this.items[e]);return t},e.prototype.createItems=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e.prototype.handleFocus=function(){},e.prototype.handleBlur=function(){},e.prototype.handleClick=function(){this.one("mouseout",c.bind(this,(function(){this.menu.unlockShowing(),this.el_.blur()}))),this.buttonPressed_?this.unpressButton():this.pressButton()},e.prototype.handleKeyPress=function(t){32===t.which||13===t.which?(this.buttonPressed_?this.unpressButton():this.pressButton(),t.preventDefault()):27===t.which&&(this.buttonPressed_&&this.unpressButton(),t.preventDefault())},e.prototype.pressButton=function(){this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-pressed",!0),this.items&&this.items.length>0&&this.items[0].el().focus()},e.prototype.unpressButton=function(){this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-pressed",!1)},e}(o.default);s.default.registerComponent("MenuButton",h),i.default=h,e.exports=i.default},{"../button.js":62,"../component.js":63,"../utils/dom.js":123,"../utils/fn.js":125,"../utils/to-title-case.js":132,"./menu.js":102}],101:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../button.js")),o=n(t("../component.js")),s=n(t("object.assign")),a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.selected(n.selected)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(e,i,n){return t.prototype.createEl.call(this,"li",s.default({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label)},i),n)},e.prototype.handleClick=function(){this.selected(!0)},e.prototype.selected=function(t){t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},e}(r.default);o.default.registerComponent("MenuItem",a),i.default=a,e.exports=i.default},{"../button.js":62,"../component.js":63,"object.assign":45}],102:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}i.__esModule=!0;var r,o=t("../component.js"),s=(r=o)&&r.__esModule?r:{default:r},a=n(t("../utils/dom.js")),l=n(t("../utils/fn.js")),c=n(t("../utils/events.js")),u=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.apply(this,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addItem=function(t){this.addChild(t),t.on("click",l.bind(this,(function(){this.unlockShowing()})))},e.prototype.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=a.createEl(e,{className:"vjs-menu-content"});var i=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),c.on(i,"click",(function(t){t.preventDefault(),t.stopImmediatePropagation()})),i},e}(s.default);s.default.registerComponent("Menu",u),i.default=u,e.exports=i.default},{"../component.js":63,"../utils/dom.js":123,"../utils/events.js":124,"../utils/fn.js":125}],103:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./component.js")),s=r(t("global/document")),a=r(t("global/window")),l=n(t("./utils/events.js")),c=n(t("./utils/dom.js")),u=n(t("./utils/fn.js")),h=n(t("./utils/guid.js")),f=(n(t("./utils/browser.js")),r(t("./utils/log.js"))),d=r(t("./utils/to-title-case.js")),p=t("./utils/time-ranges.js"),g=t("./utils/buffer.js"),m=n(t("./utils/stylesheet.js")),v=r(t("./fullscreen-api.js")),y=r(t("./media-error.js")),_=r(t("safe-json-parse/tuple")),b=r(t("object.assign")),w=r(t("./utils/merge-options.js")),x=r(t("./tracks/text-track-list-converter.js")),C=(r(t("./tech/loader.js")),r(t("./poster-image.js")),r(t("./tracks/text-track-display.js")),r(t("./loading-spinner.js")),r(t("./big-play-button.js")),r(t("./control-bar/control-bar.js")),r(t("./error-display.js")),r(t("./tracks/text-track-settings.js")),r(t("./tech/html5.js")),function(t){function e(i,n,r){var o,s=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i.id=i.id||"vjs_video_"+h.newGUID(),(n=b.default(e.getTagSettings(i),n)).initChildren=!1,n.createEl=!1,n.reportTouchActivity=!1,t.call(this,null,n,r),!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");this.tag=i,this.tagAttributes=i&&c.getElAttributes(i),this.language(this.options_.language),n.languages?(o={},Object.getOwnPropertyNames(n.languages).forEach((function(t){o[t.toLowerCase()]=n.languages[t]})),s.languages_=o):this.languages_=e.prototype.options_.languages,this.cache_={},this.poster_=n.poster||"",this.controls_=!!n.controls,i.controls=!1,this.scrubbing_=!1,this.el_=this.createEl();var a,l=w.default(this.options_);n.plugins&&(a=n.plugins,Object.getOwnPropertyNames(a).forEach((function(t){"function"==typeof this[t]?this[t](a[t]):f.default.error("Unable to find plugin:",t)}),s)),this.options_.playerOptions=l,this.initChildren(),this.isAudio("audio"===i.nodeName.toLowerCase()),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.isAudio()&&this.addClass("vjs-audio"),this.flexNotSupported_()&&this.addClass("vjs-no-flex"),e.players[this.id_]=this,this.userActive(!0),this.reportUserActivity(),this.listenForUserActivity_(),this.on("fullscreenchange",this.handleFullscreenChange_),this.on("stageclick",this.handleStageClick_)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode.removeChild(this.styleEl_),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&this.tech_.dispose(),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.el_=t.prototype.createEl.call(this,"div"),i=this.tag;i.removeAttribute("width"),i.removeAttribute("height");var n=c.getElAttributes(i);Object.getOwnPropertyNames(n).forEach((function(t){"class"===t?e.className=n[t]:e.setAttribute(t,n[t])})),i.id+="_html5_api",i.className="vjs-tech",i.player=e.player=this,this.addClass("vjs-paused"),this.styleEl_=m.createStyleElement("vjs-styles-dimensions");var r=s.default.querySelector(".vjs-styles-defaults"),o=s.default.querySelector("head");return o.insertBefore(this.styleEl_,r?r.nextSibling:o.firstChild),this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),i.initNetworkState_=i.networkState,i.parentNode&&i.parentNode.insertBefore(e,i),c.insertElFirst(i,e),this.el_=e,e},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var i=t+"_";if(void 0===e)return this[i]||0;if(""===e)this[i]=void 0;else{var n=parseFloat(e);if(isNaN(n))return f.default.error('Improper value "'+e+'" supplied for for '+t),this;this[i]=n}return this.updateStyleEl_(),this},e.prototype.fluid=function(t){if(void 0===t)return!!this.fluid_;this.fluid_=!!t,t?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid")},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){var t=void 0,e=void 0,i=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),n=i[1]/i[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/n:this.videoWidth()||300,e=void 0!==this.height_?this.height_:t*n;var r=this.id()+"-dimensions";this.addClass(r),m.setTextContent(this.styleEl_,"\n      ."+r+" {\n        width: "+t+"px;\n        height: "+e+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*n+"%;\n      }\n    ")},e.prototype.loadTech_=function(t,e){this.tech_&&this.unloadTech_(),"Html5"!==t&&this.tag&&(o.default.getComponent("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=t,this.isReady_=!1;var i=b.default({nativeControlsForTouch:this.options_.nativeControlsForTouch,source:e,playerId:this.id(),techId:this.id()+"_"+t+"_api",textTracks:this.textTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),"vtt.js":this.options_["vtt.js"]},this.options_[t.toLowerCase()]);this.tag&&(i.tag=this.tag),e&&(this.currentType_=e.type,e.src===this.cache_.src&&this.cache_.currentTime>0&&(i.startTime=this.cache_.currentTime),this.cache_.src=e.src);var n=o.default.getComponent(t);this.tech_=new n(i),this.tech_.ready(u.bind(this,this.handleTechReady_),!0),x.default.jsonToTextTracks(this.textTracksJson_||[],this.tech_),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"canplay",this.handleTechCanPlay_),this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_),this.on(this.tech_,"playing",this.handleTechPlaying_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"seeked",this.handleTechSeeked_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"progress",this.handleTechProgress_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"suspend",this.handleTechSuspend_),this.on(this.tech_,"abort",this.handleTechAbort_),this.on(this.tech_,"emptied",this.handleTechEmptied_),this.on(this.tech_,"stalled",this.handleTechStalled_),this.on(this.tech_,"loadedmetadata",this.handleTechLoadedMetaData_),this.on(this.tech_,"loadeddata",this.handleTechLoadedData_),this.on(this.tech_,"timeupdate",this.handleTechTimeUpdate_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.on(this.tech_,"volumechange",this.handleTechVolumeChange_),this.on(this.tech_,"texttrackchange",this.handleTechTextTrackChange_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"firstbufferinfo",this.firstBufferInfo_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===t&&this.tag||c.insertElFirst(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){this.textTracks_=this.textTracks(),this.textTracksJson_=x.default.textTracksToJson(this),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))},e.prototype.hasStarted=function(t){return void 0!==t?(this.hasStarted_!==t&&(this.hasStarted_=t,t?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):!!this.hasStarted_},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechWaiting_=function(){this.addClass("vjs-waiting"),this.trigger("waiting")},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechProgress_=function(){this.trigger("progress")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){0===t.button&&this.controls()&&(this.paused()?this.play():this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t&&t.code)},e.prototype.handleTechSuspend_=function(){this.trigger("suspend")},e.prototype.handleTechAbort_=function(){this.trigger("abort")},e.prototype.handleTechEmptied_=function(){this.trigger("emptied")},e.prototype.handleTechStalled_=function(){this.trigger("stalled")},e.prototype.handleTechLoadedMetaData_=function(){this.trigger("loadedmetadata")},e.prototype.handleTechLoadedData_=function(){this.trigger("loadeddata")},e.prototype.handleTechTimeUpdate_=function(){this.trigger("timeupdate")},e.prototype.handleTechRateChange_=function(){this.trigger("ratechange")},e.prototype.handleTechVolumeChange_=function(){this.trigger("volumechange")},e.prototype.handleTechTextTrackChange_=function(){this.trigger("texttrackchange")},e.prototype.firstBufferInfo_=function(){var t=this.techGet_("firstbufferinfo");return this.trigger("firstbufferinfo",t),t},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){if(this.tech_&&!this.tech_.isReady_)this.tech_.ready((function(){this[t](e)}),!0);else try{this.tech_[t](e)}catch(t){throw f.default(t),t}},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_)try{return this.tech_[t]()}catch(e){throw void 0===this.tech_[t]?f.default("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e):"TypeError"===e.name?(f.default("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1):f.default(e),e}},e.prototype.play=function(){return this.techCall_("play"),this},e.prototype.pause=function(){return this.techCall_("pause"),this},e.prototype.paused=function(){return!1!==this.techGet_("paused")},e.prototype.scrubbing=function(t){return void 0!==t?(this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing"),this):this.scrubbing_},e.prototype.currentTime=function(t){return void 0!==t?(this.techCall_("setCurrentTime",t),this):this.cache_.currentTime=this.techGet_("currentTime")||0},e.prototype.duration=function(t){return void 0===t?this.cache_.duration||0:((t=parseFloat(t)||0)<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange")),this)},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.buffered=function(){var t=this.techGet_("buffered");return t&&t.length||(t=p.createTimeRange(0,0)),t},e.prototype.bufferedPercent=function(){return g.bufferedPercent(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),i=t.end(t.length-1);return i>e&&(i=e),i},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),this):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){return void 0!==t?(this.techCall_("setMuted",t),this):this.techGet_("muted")||!1},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){return void 0!==t?(this.isFullscreen_=!!t,this):!!this.isFullscreen_},e.prototype.requestFullscreen=function(){var t=v.default;return this.isFullscreen(!0),t.requestFullscreen?(l.on(s.default,t.fullscreenchange,u.bind(this,(function e(i){this.isFullscreen(s.default[t.fullscreenElement]),!1===this.isFullscreen()&&l.off(s.default,t.fullscreenchange,e),this.trigger("fullscreenchange")}))),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.exitFullscreen=function(){var t=v.default;return this.isFullscreen(!1),t.requestFullscreen?s.default[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=s.default.documentElement.style.overflow,l.on(s.default,"keydown",u.bind(this,this.fullWindowOnEscKey)),s.default.documentElement.style.overflow="hidden",c.addElClass(s.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,l.off(s.default,"keydown",this.fullWindowOnEscKey),s.default.documentElement.style.overflow=this.docOrigOverflow,c.removeElClass(s.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.selectSource=function(t){for(var e=0,i=this.options_.techOrder;e<i.length;e++){var n=d.default(i[e]),r=o.default.getComponent(n);if(r){if(r.isSupported())for(var s=0,a=t;s<a.length;s++){var l=a[s];if(r.canPlaySource(l))return{source:l,tech:n}}}else f.default.error('The "'+n+'" tech is undefined. Skipped browser support check for that tech.')}return!1},e.prototype.src=function(t){if(void 0===t)return this.techGet_("src");var e=o.default.getComponent(this.techName_);return Array.isArray(t)?this.sourceList_(t):"string"==typeof t?this.src({src:t}):t instanceof Object&&(t.type&&!e.canPlaySource(t)?this.sourceList_([t]):(this.cache_.src=t.src,this.currentType_=t.type||"",this.ready((function(){e.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),"auto"===this.options_.preload&&this.load(),this.options_.autoplay&&this.play()}),!0))),this},e.prototype.sourceList_=function(t){var e=this.selectSource(t);e?e.tech===this.techName_?this.src(e.source):this.loadTech_(e.tech,e.source):(this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0),this.triggerReady())},e.prototype.load=function(){return this.techCall_("load"),this},e.prototype.currentSrc=function(){return this.techGet_("currentSrc")||this.cache_.src||""},e.prototype.currentType=function(){return this.currentType_||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),this.options_.preload=t,this):this.techGet_("preload")},e.prototype.autoplay=function(t){return void 0!==t?(this.techCall_("setAutoplay",t),this.options_.autoplay=t,this):this.techGet_("autoplay",t)},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),this.options_.loop=t,this):this.techGet_("loop")},e.prototype.poster=function(t){return void 0===t?this.poster_:(t||(t=""),this.poster_=t,this.techCall_("setPoster",t),this.trigger("posterchange"),this)},e.prototype.handleTechPosterChange_=function(){!this.poster_&&this.tech_&&this.tech_.poster&&(this.poster_=this.tech_.poster()||"",this.trigger("posterchange"))},e.prototype.controls=function(t){return void 0!==t?(t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),t?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_())),this):!!this.controls_},e.prototype.usingNativeControls=function(t){return void 0!==t?(t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,t?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):!!this.usingNativeControls_},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),this):(t instanceof y.default?this.error_=t:this.error_=new y.default(t),this.trigger("error"),this.addClass("vjs-error"),f.default.error("(CODE:"+this.error_.code+" "+y.default.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this)},e.prototype.ended=function(){return this.techGet_("ended")},e.prototype.seeking=function(){return this.techGet_("seeking")},e.prototype.seekable=function(){return this.techGet_("seekable")},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){return void 0!==t?((t=!!t)!==this.userActive_&&(this.userActive_=t,t?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech_&&this.tech_.one("mousemove",(function(t){t.stopPropagation(),t.preventDefault()})),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,i=void 0,n=u.bind(this,this.reportUserActivity);this.on("mousedown",(function(){n(),this.clearInterval(t),t=this.setInterval(n,250)})),this.on("mousemove",(function(t){t.screenX===e&&t.screenY===i||(e=t.screenX,i=t.screenY,n())})),this.on("mouseup",(function(e){n(),this.clearInterval(t)})),this.on("keydown",n),this.on("keyup",n);var r=void 0;this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(r);var t=this.options_.inactivityTimeout;t>0&&(r=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),t))}}),250)},e.prototype.playbackRate=function(t){return void 0!==t?(this.techCall_("setPlaybackRate",t),this):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1},e.prototype.isAudio=function(t){return void 0!==t?(this.isAudio_=!!t,this):!!this.isAudio_},e.prototype.networkState=function(){return this.techGet_("networkState")},e.prototype.readyState=function(){return this.techGet_("readyState")},e.prototype.textTracks=function(){return this.tech_&&this.tech_.textTracks()},e.prototype.remoteTextTracks=function(){return this.tech_&&this.tech_.remoteTextTracks()},e.prototype.addTextTrack=function(t,e,i){return this.tech_&&this.tech_.addTextTrack(t,e,i)},e.prototype.addRemoteTextTrack=function(t){return this.tech_&&this.tech_.addRemoteTextTrack(t)},e.prototype.removeRemoteTextTrack=function(t){this.tech_&&this.tech_.removeRemoteTextTrack(t)},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){return void 0===t?this.language_:(this.language_=(""+t).toLowerCase(),this)},e.prototype.languages=function(){return w.default(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=w.default(this.options_),e=t.tracks;t.tracks=[];for(var i=0;i<e.length;i++){var n=e[i];(n=w.default(n)).player=void 0,t.tracks[i]=n}return t},e.getTagSettings=function(t){var e={sources:[],tracks:[]},i=c.getElAttributes(t),n=i["data-setup"];if(null!==n){var r=_.default(n||"{}"),o=r[0],s=r[1];o&&f.default.error(o),b.default(i,s)}if(b.default(e,i),t.hasChildNodes())for(var a=t.childNodes,l=0,u=a.length;l<u;l++){var h=a[l],d=h.nodeName.toLowerCase();"source"===d?e.sources.push(c.getElAttributes(h)):"track"===d&&e.tracks.push(c.getElAttributes(h))}return e},e}(o.default));C.players={};var T=a.default.navigator;C.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:s.default.getElementsByTagName("html")[0].getAttribute("lang")||T.languages&&T.languages[0]||T.userLanguage||T.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."},C.prototype.handleLoadedMetaData_,C.prototype.handleLoadedData_,C.prototype.handleUserActive_,C.prototype.handleUserInactive_,C.prototype.handleTimeUpdate_,C.prototype.handleVolumeChange_,C.prototype.handleError_,C.prototype.flexNotSupported_=function(){var t=s.default.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},o.default.registerComponent("Player",C),i.default=C,e.exports=i.default},{"./big-play-button.js":61,"./component.js":63,"./control-bar/control-bar.js":64,"./error-display.js":94,"./fullscreen-api.js":97,"./loading-spinner.js":98,"./media-error.js":99,"./poster-image.js":105,"./tech/html5.js":110,"./tech/loader.js":111,"./tracks/text-track-display.js":114,"./tracks/text-track-list-converter.js":116,"./tracks/text-track-settings.js":118,"./utils/browser.js":120,"./utils/buffer.js":121,"./utils/dom.js":123,"./utils/events.js":124,"./utils/fn.js":125,"./utils/guid.js":127,"./utils/log.js":128,"./utils/merge-options.js":129,"./utils/stylesheet.js":130,"./utils/time-ranges.js":131,"./utils/to-title-case.js":132,"global/document":1,"global/window":2,"object.assign":45,"safe-json-parse/tuple":53}],104:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./player.js"),o=(n=r)&&n.__esModule?n:{default:n};i.default=function(t,e){o.default.prototype[t]=e},e.exports=i.default},{"./player.js":103}],105:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./button.js")),s=r(t("./component.js")),a=n(t("./utils/fn.js")),l=n(t("./utils/dom.js")),c=n(t("./utils/browser.js")),u=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.update(),i.on("posterchange",a.bind(this,this.update))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=l.createEl("div",{className:"video-poster",tabIndex:-1});return c.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=l.createEl("img"),t.appendChild(this.fallbackImg_)),t},e.prototype.update=function(){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},e.prototype.setSrc=function(t){if(this.fallbackImg_)this.fallbackImg_.src=t;else{var e="";t&&(e='url("'+t+'")'),this.el_.style.backgroundImage=e}},e.prototype.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},e}(o.default);s.default.registerComponent("PosterImage",u),i.default=u,e.exports=i.default},{"./button.js":62,"./component.js":63,"./utils/browser.js":120,"./utils/dom.js":123,"./utils/fn.js":125}],106:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./utils/events.js")),o=n(t("global/document")),s=n(t("global/window")),a=!1,l=void 0,c=function(){var t=o.default.getElementsByTagName("video"),e=o.default.getElementsByTagName("audio"),i=[];if(t&&t.length>0)for(var n=0,r=t.length;n<r;n++)i.push(t[n]);if(e&&e.length>0)for(n=0,r=e.length;n<r;n++)i.push(e[n]);if(i&&i.length>0)for(n=0,r=i.length;n<r;n++){var s=i[n];if(!s||!s.getAttribute){u(1);break}void 0===s.player&&null!==s.getAttribute("data-setup")&&l(s)}else a||u(1)},u=function(t,e){l=e,setTimeout(c,t)};"complete"===o.default.readyState?a=!0:r.one(s.default,"load",(function(){a=!0})),i.autoSetup=c,i.autoSetupTimeout=u,i.hasLoaded=function(){return a}},{"./utils/events.js":124,"global/document":1,"global/window":2}],107:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../component.js")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/dom.js")),s=n(t("global/document")),a=n(t("object.assign")),l=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(i,"controlsvisible",this.update),this.on(i,this.playerEvent,this.update)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return i.className=i.className+" vjs-slider",i=a.default({tabIndex:0},i),n=a.default({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),t.prototype.createEl.call(this,e,i,n)},e.prototype.handleMouseDown=function(t){t.preventDefault(),o.blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(s.default,"mousemove",this.handleMouseMove),this.on(s.default,"mouseup",this.handleMouseUp),this.on(s.default,"touchmove",this.handleMouseMove),this.on(s.default,"touchend",this.handleMouseUp),this.handleMouseMove(t)},e.prototype.handleMouseMove=function(){},e.prototype.handleMouseUp=function(){o.unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(s.default,"mousemove",this.handleMouseMove),this.off(s.default,"mouseup",this.handleMouseUp),this.off(s.default,"touchmove",this.handleMouseMove),this.off(s.default,"touchend",this.handleMouseUp),this.update()},e.prototype.update=function(){if(this.el_){var t=this.getPercent(),e=this.bar;if(e){("number"!=typeof t||t!=t||t<0||t===1/0)&&(t=0);var i=(100*t).toFixed(2)+"%";this.vertical()?e.el().style.height=i:e.el().style.width=i}}},e.prototype.calculateDistance=function(t){var e=o.getPointerPosition(this.el_,t);return this.vertical()?e.y:e.x},e.prototype.handleFocus=function(){this.on(s.default,"keydown",this.handleKeyPress)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepBack()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepForward())},e.prototype.handleBlur=function(){this.off(s.default,"keydown",this.handleKeyPress)},e.prototype.handleClick=function(t){t.stopImmediatePropagation(),t.preventDefault()},e.prototype.vertical=function(t){return void 0===t?this.vertical_||!1:(this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal"),this)},e}(r.default);r.default.registerComponent("Slider",l),i.default=l,e.exports=i.default},{"../component.js":63,"../utils/dom.js":123,"global/document":1,"object.assign":45}],108:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){return t.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},t.streamFromParts=function(t,e){return t+"&"+e},t.streamToParts=function(t){var e={connection:"",stream:""};if(!t)return e;var i=t.indexOf("&"),n=void 0;return-1!==i?n=i+1:0===(i=n=t.lastIndexOf("/")+1)&&(i=n=t.length),e.connection=t.substring(0,i),e.stream=t.substring(n,t.length),e},t.isStreamingType=function(e){return e in t.streamingFormats},t.RTMP_RE=/^rtmp[set]?:\/\//i,t.isStreamingSrc=function(e){return t.RTMP_RE.test(e)},t.rtmpSourceHandler={},t.rtmpSourceHandler.canHandleSource=function(e){return t.isStreamingType(e.type)||t.isStreamingSrc(e.src)?"maybe":""},t.rtmpSourceHandler.handleSource=function(e,i){var n=t.streamToParts(e.src);i.setRtmpConnection(n.connection),i.setRtmpStream(n.stream)},t.registerSourceHandler(t.rtmpSourceHandler),t},e.exports=i.default},{}],109:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./tech")),s=n(t("../utils/dom.js")),a=n(t("../utils/url.js")),l=t("../utils/time-ranges.js"),c=r(t("./flash-rtmp")),u=r(t("../component")),h=r(t("global/window")),f=r(t("object.assign")),d=h.default.navigator,p=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),i.source&&this.ready((function(){this.setSource(i.source)}),!0),i.startTime&&this.ready((function(){this.load(),this.play(),this.currentTime(i.startTime)}),!0),h.default.videojs=h.default.videojs||{},h.default.videojs.Flash=h.default.videojs.Flash||{},h.default.videojs.Flash.onReady=e.onReady,h.default.videojs.Flash.onEvent=e.onEvent,h.default.videojs.Flash.onError=e.onError,this.on("seeked",(function(){this.lastSeekTarget_=void 0}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){var t=this.options_;t.swf||(t.swf="//"+__vodPlayerUrl__);var i=t.techId,n=f.default({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:t.autoplay,preload:t.preload,loop:t.loop,muted:t.muted},t.flashVars),r=f.default({wmode:"transparent"},t.params),o=f.default({id:i,name:i,class:"vjs-tech"},t.attributes);return this.el_=e.embed(t.swf,n,r,o),this.el_.tech=this,this.el_},e.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},e.prototype.pause=function(){this.el_.vjs_pause()},e.prototype.src=function(t){return void 0===t?this.currentSrc():this.setSrc(t)},e.prototype.setSrc=function(t){if(t=a.getAbsoluteURL(t),this.el_.vjs_src(t),this.autoplay()){var e=this;this.setTimeout((function(){e.play()}),0)}},e.prototype.seeking=function(){return void 0!==this.lastSeekTarget_},e.prototype.setCurrentTime=function(e){var i=this.seekable();i.length&&(e=(e=e>i.start(0)?e:i.start(0))<i.end(i.length-1)?e:i.end(i.length-1),this.lastSeekTarget_=e,this.trigger("seeking"),this.el_.vjs_setProperty("currentTime",e),t.prototype.setCurrentTime.call(this))},e.prototype.currentTime=function(t){return this.seeking(),this.el_.vjs_getProperty("currentTime")},e.prototype.firstbufferinfo=function(){return this.el_.vjs_getProperty("firstbufferinfo")},e.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},e.prototype.load=function(){this.el_.vjs_load()},e.prototype.poster=function(){this.el_.vjs_getProperty("poster")},e.prototype.setPoster=function(){},e.prototype.seekable=function(){var t=this.duration();return 0===t?l.createTimeRange():l.createTimeRange(0,t)},e.prototype.buffered=function(){var t=this.el_.vjs_getProperty("buffered");return 0===t.length?l.createTimeRange():l.createTimeRange(t[0][0],t[0][1])},e.prototype.supportsFullScreen=function(){return!1},e.prototype.enterFullScreen=function(){return!1},e}(o.default),g=p.prototype,m="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),v="networkState,readyState,initialTime,duration,startOffsetTime,paused,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(",");function y(t){var e=t.charAt(0).toUpperCase()+t.slice(1);g["set"+e]=function(e){return this.el_.vjs_setProperty(t,e)}}function _(t){g[t]=function(){return this.el_.vjs_getProperty(t)}}for(var b=0;b<m.length;b++)_(m[b]),y(m[b]);for(b=0;b<v.length;b++)_(v[b]);p.isSupported=function(){return p.version()[0]>=10},o.default.withSourceHandlers(p),p.nativeSourceHandler={},p.nativeSourceHandler.canHandleSource=function(t){var e,i,n;return t.type?e=t.type.replace(/;.*/,"").toLowerCase():(i=t.src,e=(n=a.getFileExtension(i))?"video/"+n:""),e in p.formats?"maybe":""},p.nativeSourceHandler.handleSource=function(t,e){e.setSrc(t.src)},p.nativeSourceHandler.dispose=function(){},p.registerSourceHandler(p.nativeSourceHandler),p.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},p.onReady=function(t){var e=s.getEl(t),i=e&&e.tech;i&&i.el()&&p.checkReady(i)},p.checkReady=function(t){t.el()&&(t.el().vjs_getProperty?t.triggerReady():this.setTimeout((function(){p.checkReady(t)}),50))},p.onEvent=function(t,e){s.getEl(t).tech.trigger(e)},p.onError=function(t,e){var i=s.getEl(t).tech;if("srcnotfound"===e)return i.error(4);i.error("FLASH: "+e)},p.version=function(){var t="0,0,0";try{t=new h.default.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{d.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(t=(d.plugins["Shockwave Flash 2.0"]||d.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(t){}}return t.split(",")},p.embed=function(t,e,i,n){var r=p.getEmbedCode(t,e,i,n);return s.createEl("div",{innerHTML:r}).childNodes[0]},p.getEmbedCode=function(t,e,i,n){var r="",o="",s="";return e&&Object.getOwnPropertyNames(e).forEach((function(t){r+=t+"="+e[t]+"&amp;"})),i=f.default({movie:t,allowfullscreen:"true",flashvars:r,allowScriptAccess:"always",allowNetworking:"all"},i),Object.getOwnPropertyNames(i).forEach((function(t){o+='<param name="'+t+'" value="'+i[t]+'" />'})),n=f.default({data:t,width:"100%",height:"100%"},n),Object.getOwnPropertyNames(n).forEach((function(t){s+=t+'="'+n[t]+'" '})),'<object type="application/x-shockwave-flash" '+s+">"+o+"</object>"},c.default(p),u.default.registerComponent("Flash",p),i.default=p,e.exports=i.default},{"../component":63,"../utils/dom.js":123,"../utils/time-ranges.js":131,"../utils/url.js":133,"./flash-rtmp":108,"./tech":112,"global/window":2,"object.assign":45}],110:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./tech.js")),s=r(t("../component")),a=n(t("../utils/dom.js")),l=n(t("../utils/url.js")),c=n(t("../utils/fn.js")),u=r(t("../utils/log.js")),h=n(t("../utils/browser.js")),f=r(t("global/document")),d=r(t("global/window")),p=r(t("object.assign")),g=r(t("../utils/merge-options.js")),m=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n);var r=i.source;if(r&&(this.el_.currentSrc!==r.src||i.tag&&3===i.tag.initNetworkState_)?this.setSource(r):this.handleLateInit_(this.el_),this.el_.hasChildNodes()){for(var o=this.el_.childNodes,s=o.length,a=[];s--;){var l=o[s];"track"===l.nodeName.toLowerCase()&&(this.featuresNativeTextTracks?this.remoteTextTracks().addTrack_(l.track):a.push(l))}for(var u=0;u<a.length;u++)this.el_.removeChild(a[u])}this.featuresNativeTextTracks&&(this.handleTextTrackChange_=c.bind(this,this.handleTextTrackChange),this.handleTextTrackAdd_=c.bind(this,this.handleTextTrackAdd),this.handleTextTrackRemove_=c.bind(this,this.handleTextTrackRemove),this.proxyNativeTextTracks_()),(h.TOUCH_ENABLED&&!0===i.nativeControlsForTouch||h.IS_IPHONE||h.IS_NATIVE_ANDROID)&&this.setControls(!0),this.triggerReady()}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){var i=this.el().textTracks,n=this.textTracks();i&&i.removeEventListener&&(i.removeEventListener("change",this.handleTextTrackChange_),i.removeEventListener("addtrack",this.handleTextTrackAdd_),i.removeEventListener("removetrack",this.handleTextTrackRemove_));for(var r=n.length;r--;)n.removeTrack_(n[r]);e.disposeMediaElement(this.el_),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=this.options_.tag;if(!t||!1===this.movingMediaElementInDOM)if(t){var i=t.cloneNode(!0);t.parentNode.insertBefore(i,t),e.disposeMediaElement(t),t=i}else{t=f.default.createElement("video");var n=this.options_.tag&&a.getElAttributes(this.options_.tag),r=g.default({},n);h.TOUCH_ENABLED&&!0===this.options_.nativeControlsForTouch||delete r.controls,a.setElAttributes(t,p.default(r,{id:this.options_.techId,class:"vjs-tech"}))}for(var o=["autoplay","preload","loop","muted"],s=o.length-1;s>=0;s--){var l=o[s],c={};void 0!==this.options_[l]&&(c[l]=this.options_[l]),a.setElAttributes(t,c)}return t},e.prototype.handleLateInit_=function(t){var e=this;if(0!==t.networkState&&3!==t.networkState){if(0===t.readyState){var i=function(){var t=!1,i=function(){t=!0};e.on("loadstart",i);var n=function(){t||this.trigger("loadstart")};return e.on("loadedmetadata",n),e.ready((function(){this.off("loadstart",i),this.off("loadedmetadata",n),t||this.trigger("loadstart")})),{v:void 0}}();if("object"==typeof i)return i.v}var n=["loadstart"];n.push("loadedmetadata"),t.readyState>=2&&n.push("loadeddata"),t.readyState>=3&&n.push("canplay"),t.readyState>=4&&n.push("canplaythrough"),this.ready((function(){n.forEach((function(t){this.trigger(t)}),this)}))}},e.prototype.proxyNativeTextTracks_=function(){var t=this.el().textTracks;t&&t.addEventListener&&(t.addEventListener("change",this.handleTextTrackChange_),t.addEventListener("addtrack",this.handleTextTrackAdd_),t.addEventListener("removetrack",this.handleTextTrackRemove_))},e.prototype.handleTextTrackChange=function(t){var e=this.textTracks();this.textTracks().trigger({type:"change",target:e,currentTarget:e,srcElement:e})},e.prototype.handleTextTrackAdd=function(t){this.textTracks().addTrack_(t.track)},e.prototype.handleTextTrackRemove=function(t){this.textTracks().removeTrack_(t.track)},e.prototype.play=function(){this.el_.play()},e.prototype.pause=function(){this.el_.pause()},e.prototype.paused=function(){return this.el_.paused},e.prototype.currentTime=function(){return this.el_.currentTime},e.prototype.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(t){u.default(t,"Video is not ready. (Video.js)")}},e.prototype.duration=function(){return this.el_.duration||0},e.prototype.buffered=function(){return this.el_.buffered},e.prototype.volume=function(){return this.el_.volume},e.prototype.setVolume=function(t){this.el_.volume=t},e.prototype.muted=function(){return this.el_.muted},e.prototype.setMuted=function(t){this.el_.muted=t},e.prototype.width=function(){return this.el_.offsetWidth},e.prototype.height=function(){return this.el_.offsetHeight},e.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=d.default.navigator.userAgent;if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},e.prototype.enterFullScreen=function(){var t=this.el_;"webkitDisplayingFullscreen"in t&&this.one("webkitbeginfullscreen",(function(){this.one("webkitendfullscreen",(function(){this.trigger("fullscreenchange",{isFullscreen:!1})})),this.trigger("fullscreenchange",{isFullscreen:!0})})),t.paused&&t.networkState<=t.HAVE_METADATA?(this.el_.play(),this.setTimeout((function(){t.pause(),t.webkitEnterFullScreen()}),0)):t.webkitEnterFullScreen()},e.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.prototype.src=function(t){if(void 0===t)return this.el_.src;this.setSrc(t)},e.prototype.setSrc=function(t){this.el_.src=t},e.prototype.load=function(){this.el_.load()},e.prototype.currentSrc=function(){return this.el_.currentSrc},e.prototype.poster=function(){return this.el_.poster},e.prototype.setPoster=function(t){this.el_.poster=t},e.prototype.preload=function(){return this.el_.preload},e.prototype.setPreload=function(t){this.el_.preload=t},e.prototype.autoplay=function(){return this.el_.autoplay},e.prototype.setAutoplay=function(t){this.el_.autoplay=t},e.prototype.controls=function(){return this.el_.controls},e.prototype.setControls=function(t){this.el_.controls=!!t},e.prototype.loop=function(){return this.el_.loop},e.prototype.setLoop=function(t){this.el_.loop=t},e.prototype.error=function(){return this.el_.error},e.prototype.seeking=function(){return this.el_.seeking},e.prototype.seekable=function(){return this.el_.seekable},e.prototype.ended=function(){return this.el_.ended},e.prototype.defaultMuted=function(){return this.el_.defaultMuted},e.prototype.playbackRate=function(){return this.el_.playbackRate},e.prototype.played=function(){return this.el_.played},e.prototype.setPlaybackRate=function(t){this.el_.playbackRate=t},e.prototype.networkState=function(){return this.el_.networkState},e.prototype.readyState=function(){return this.el_.readyState},e.prototype.videoWidth=function(){return this.el_.videoWidth},e.prototype.videoHeight=function(){return this.el_.videoHeight},e.prototype.textTracks=function(){return t.prototype.textTracks.call(this)},e.prototype.addTextTrack=function(e,i,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,n):t.prototype.addTextTrack.call(this,e,i,n)},e.prototype.addRemoteTextTrack=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!this.featuresNativeTextTracks)return t.prototype.addRemoteTextTrack.call(this,e);var i=f.default.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),this.el().appendChild(i),this.remoteTextTracks().addTrack_(i.track),i},e.prototype.removeRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.removeRemoteTextTrack.call(this,e);var i,n;for(this.remoteTextTracks().removeTrack_(e),n=(i=this.el().querySelectorAll("track")).length;n--;)e!==i[n]&&e!==i[n].track||this.el().removeChild(i[n])},e}(o.default);m.TEST_VID=f.default.createElement("video");var v=f.default.createElement("track");v.kind="captions",v.srclang="en",v.label="English",m.TEST_VID.appendChild(v),m.isSupported=function(){try{m.TEST_VID.volume=.5}catch(t){return!1}return!!m.TEST_VID.canPlayType},o.default.withSourceHandlers(m),m.nativeSourceHandler={},m.nativeSourceHandler.canHandleSource=function(t){function e(t){try{return m.TEST_VID.canPlayType(t)}catch(t){return""}}return t.type?e(t.type):t.src?e("video/"+l.getFileExtension(t.src)):""},m.nativeSourceHandler.handleSource=function(t,e){e.setSrc(t.src)},m.nativeSourceHandler.dispose=function(){},m.registerSourceHandler(m.nativeSourceHandler),m.canControlVolume=function(){var t=m.TEST_VID.volume;return m.TEST_VID.volume=t/2+.1,t!==m.TEST_VID.volume},m.canControlPlaybackRate=function(){var t=m.TEST_VID.playbackRate;return m.TEST_VID.playbackRate=t/2+.1,t!==m.TEST_VID.playbackRate},m.supportsNativeTextTracks=function(){var t;return(t=!!m.TEST_VID.textTracks)&&m.TEST_VID.textTracks.length>0&&(t="number"!=typeof m.TEST_VID.textTracks[0].mode),t&&h.IS_FIREFOX&&(t=!1),!t||"onremovetrack"in m.TEST_VID.textTracks||(t=!1),t},m.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"],m.prototype.featuresVolumeControl=m.canControlVolume(),m.prototype.featuresPlaybackRate=m.canControlPlaybackRate(),m.prototype.movingMediaElementInDOM=!h.IS_IOS,m.prototype.featuresFullscreenResize=!0,m.prototype.featuresProgressEvents=!0,m.prototype.featuresNativeTextTracks=m.supportsNativeTextTracks();var y=void 0,_=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,b=/^video\/mp4/i;m.patchCanPlayType=function(){h.ANDROID_VERSION>=4&&(y||(y=m.TEST_VID.constructor.prototype.canPlayType),m.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&_.test(t)?"maybe":y.call(this,t)}),h.IS_OLD_ANDROID&&(y||(y=m.TEST_VID.constructor.prototype.canPlayType),m.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&b.test(t)?"maybe":y.call(this,t)})},m.unpatchCanPlayType=function(){var t=m.TEST_VID.constructor.prototype.canPlayType;return m.TEST_VID.constructor.prototype.canPlayType=y,y=null,t},m.patchCanPlayType(),m.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),"function"==typeof t.load&&function(){try{t.load()}catch(t){}}()}},s.default.registerComponent("Html5",m),i.default=m,e.exports=i.default},{"../component":63,"../utils/browser.js":120,"../utils/dom.js":123,"../utils/fn.js":125,"../utils/log.js":128,"../utils/merge-options.js":129,"../utils/url.js":133,"./tech.js":112,"global/document":1,"global/window":2,"object.assign":45}],111:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../component")),o=(n(t("global/window")),n(t("../utils/to-title-case.js"))),s=function(t){function e(i,n,s){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n,s),n.playerOptions.sources&&0!==n.playerOptions.sources.length)i.src(n.playerOptions.sources);else for(var a=0,l=n.playerOptions.techOrder;a<l.length;a++){var c=o.default(l[a]),u=r.default.getComponent(c);if(u&&u.isSupported()){i.loadTech_(c);break}}}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(r.default);r.default.registerComponent("MediaLoader",s),i.default=s,e.exports=i.default},{"../component":63,"../utils/to-title-case.js":132,"global/window":2}],112:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../component")),o=n(t("../tracks/text-track")),s=n(t("../tracks/text-track-list")),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/fn.js")),l=n(t("../utils/log.js")),c=t("../utils/time-ranges.js"),u=t("../utils/buffer.js"),h=n(t("../media-error.js")),f=n(t("global/window")),d=n(t("global/document")),p=function(t){function e(){var i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i.reportTouchActivity=!1,t.call(this,null,i,n),this.hasStarted_=!1,this.on("playing",(function(){this.hasStarted_=!0})),this.on("loadstart",(function(){this.hasStarted_=!1})),this.textTracks_=i.textTracks,this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),!1!==i.nativeCaptions&&!1!==i.nativeTextTracks||(this.featuresNativeTextTracks=!1),this.featuresNativeTextTracks||this.on("ready",this.emulateTextTracks),this.initTextTrackListeners(),this.emitTapEvents()}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.prototype.trackProgress=function(){this.stopTrackingProgress(),this.progressInterval=this.setInterval(a.bind(this,(function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,1===t&&this.stopTrackingProgress()})),500)},e.prototype.onDurationChange=function(){this.duration_=this.duration()},e.prototype.buffered=function(){return c.createTimeRange(0,0)},e.prototype.bufferedPercent=function(){return u.bufferedPercent(this.buffered(),this.duration_)},e.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},
/*! Time Tracking -------------------------------------------------------------- */
e.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)},e.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.dispose=function(){var e=this.textTracks();if(e)for(var i=e.length;i--;)this.removeRemoteTextTrack(e[i]);this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.prototype.error=function(t){return void 0!==t&&(t instanceof h.default?this.error_=t:this.error_=new h.default(t),this.trigger("error")),this.error_},e.prototype.played=function(){return this.hasStarted_?c.createTimeRange(0,0):c.createTimeRange()},e.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.initTextTrackListeners=function(){var t=a.bind(this,(function(){this.trigger("texttrackchange")})),e=this.textTracks();e&&(e.addEventListener("removetrack",t),e.addEventListener("addtrack",t),this.on("dispose",a.bind(this,(function(){e.removeEventListener("removetrack",t),e.removeEventListener("addtrack",t)}))))},e.prototype.emulateTextTracks=function(){if(!f.default.WebVTT&&null!=this.el().parentNode){var t=d.default.createElement("script");t.src=this.options_["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js",this.el().parentNode.appendChild(t),f.default.WebVTT=!0}var e=this.textTracks();if(e){var i=a.bind(this,(function(){var t=this,i=function(){return t.trigger("texttrackchange")};i();for(var n=0;n<e.length;n++){var r=e[n];r.removeEventListener("cuechange",i),"showing"===r.mode&&r.addEventListener("cuechange",i)}}));e.addEventListener("change",i),this.on("dispose",(function(){e.removeEventListener("change",i)}))}},e.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||new s.default,this.textTracks_},e.prototype.remoteTextTracks=function(){return this.remoteTextTracks_=this.remoteTextTracks_||new s.default,this.remoteTextTracks_},e.prototype.addTextTrack=function(t,e,i){if(!t)throw new Error("TextTrack kind is required but was not provided");return g(this,t,e,i)},e.prototype.addRemoteTextTrack=function(t){var e=g(this,t.kind,t.label,t.language,t);return this.remoteTextTracks().addTrack_(e),{track:e}},e.prototype.removeRemoteTextTrack=function(t){this.textTracks().removeTrack_(t),this.remoteTextTracks().removeTrack_(t)},e.prototype.setPoster=function(){},e}(r.default);p.prototype.textTracks_;var g=function(t,e,i,n){var r=arguments.length<=4||void 0===arguments[4]?{}:arguments[4],s=t.textTracks();r.kind=e,i&&(r.label=i),n&&(r.language=n),r.tech=t;var a=new o.default(r);return s.addTrack_(a),a};p.prototype.featuresVolumeControl=!0,p.prototype.featuresFullscreenResize=!1,p.prototype.featuresPlaybackRate=!1,p.prototype.featuresProgressEvents=!1,p.prototype.featuresTimeupdateEvents=!1,p.prototype.featuresNativeTextTracks=!1,p.withSourceHandlers=function(t){t.registerSourceHandler=function(e,i){var n=t.sourceHandlers;n||(n=t.sourceHandlers=[]),void 0===i&&(i=n.length),n.splice(i,0,e)},t.selectSourceHandler=function(e){for(var i=t.sourceHandlers||[],n=0;n<i.length;n++)if(i[n].canHandleSource(e))return i[n];return null},t.canPlaySource=function(e){var i=t.selectSourceHandler(e);return i?i.canHandleSource(e):""};var e=t.prototype.seekable;t.prototype.seekable=function(){return this.sourceHandler_&&this.sourceHandler_.seekable?this.sourceHandler_.seekable():e.call(this)},t.prototype.setSource=function(e){var i=t.selectSourceHandler(e);return i||(t.nativeSourceHandler?i=t.nativeSourceHandler:l.default.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),this.currentSource_=e,this.sourceHandler_=i.handleSource(e,this),this.on("dispose",this.disposeSourceHandler),this},t.prototype.disposeSourceHandler=function(){this.sourceHandler_&&this.sourceHandler_.dispose&&this.sourceHandler_.dispose()}},r.default.registerComponent("Tech",p),r.default.registerComponent("MediaTechController",p),i.default=p,e.exports=i.default},{"../component":63,"../media-error.js":99,"../tracks/text-track":119,"../tracks/text-track-list":117,"../utils/buffer.js":121,"../utils/fn.js":125,"../utils/log.js":128,"../utils/time-ranges.js":131,"global/document":1,"global/window":2}],113:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/browser.js")),o=t("global/document"),s=(n=o)&&n.__esModule?n:{default:n},a=function t(e){var i=this;if(r.IS_IE8)for(var n in i=s.default.createElement("custom"),t.prototype)i[n]=t.prototype[n];if(t.prototype.setCues_.call(i,e),Object.defineProperty(i,"length",{get:function(){return this.length_}}),r.IS_IE8)return i};a.prototype.setCues_=function(t){var e=this.length||0,i=0,n=t.length;this.cues_=t,this.length_=t.length;var r=function(t){""+t in this||Object.defineProperty(this,""+t,{get:function(){return this.cues_[t]}})};if(e<n)for(i=e;i<n;i++)r.call(this,i)},a.prototype.getCueById=function(t){for(var e=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===t){e=r;break}}return e},i.default=a,e.exports=i.default},{"../utils/browser.js":120,"global/document":1}],114:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("../component")),o=(n(t("../menu/menu.js")),n(t("../menu/menu-item.js")),n(t("../menu/menu-button.js")),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../utils/fn.js"))),s=(n(t("global/document")),n(t("global/window"))),a={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},l=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n,r),i.on("loadstart",o.bind(this,this.toggleDisplay)),i.on("texttrackchange",o.bind(this,this.updateDisplay)),i.ready(o.bind(this,(function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",o.bind(this,this.updateDisplay));for(var t=this.options_.playerOptions.tracks||[],e=0;e<t.length;e++){var n=t[e];this.player_.addRemoteTextTrack(n)}}})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},e.prototype.clearDisplay=function(){"function"==typeof s.default.WebVTT&&s.default.WebVTT.processCues(s.default,[],this.el_)},e.prototype.updateDisplay=function(){var t=this.player_.textTracks();if(this.clearDisplay(),t)for(var e=0;e<t.length;e++){var i=t[e];"showing"===i.mode&&this.updateForTrack(i)}},e.prototype.updateForTrack=function(t){if("function"==typeof s.default.WebVTT&&t.activeCues){for(var e=this.player_.textTrackSettings.getValues(),i=[],n=0;n<t.activeCues.length;n++)i.push(t.activeCues[n]);s.default.WebVTT.processCues(s.default,t.activeCues,this.el_);for(var r=i.length;r--;){var o=i[r].displayState;if(e.color&&(o.firstChild.style.color=e.color),e.textOpacity&&u(o.firstChild,"color",c(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(o.firstChild.style.backgroundColor=e.backgroundColor),e.backgroundOpacity&&u(o.firstChild,"backgroundColor",c(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(e.windowOpacity?u(o,"backgroundColor",c(e.windowColor,e.windowOpacity)):o.style.backgroundColor=e.windowColor),e.edgeStyle&&("dropshadow"===e.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===e.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===e.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===e.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),e.fontPercent&&1!==e.fontPercent){var l=s.default.parseFloat(o.style.fontSize);o.style.fontSize=l*e.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=a[e.fontFamily])}}},e}(r.default);function c(t,e){return"rgba("+parseInt(t[1]+t[1],16)+","+parseInt(t[2]+t[2],16)+","+parseInt(t[3]+t[3],16)+","+e+")"}function u(t,e,i){try{t.style[e]=i}catch(t){}}r.default.registerComponent("TextTrackDisplay",l),i.default=l,e.exports=i.default},{"../component":63,"../menu/menu-button.js":100,"../menu/menu-item.js":101,"../menu/menu.js":102,"../utils/fn.js":125,"global/document":1,"global/window":2}],115:[function(t,e,i){"use strict";i.__esModule=!0,i.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"},i.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"}},{}],116:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){return{kind:t.kind,label:t.label,language:t.language,id:t.id,inBandMetadataTrackDispatchType:t.inBandMetadataTrackDispatchType,mode:t.mode,cues:t.cues&&Array.prototype.map.call(t.cues,(function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})),src:t.src}};i.default={textTracksToJson:function(t){var e=t.el().querySelectorAll("track"),i=Array.prototype.map.call(e,(function(t){return t.track}));return Array.prototype.map.call(e,(function(t){var e=n(t.track);return e.src=t.src,e})).concat(Array.prototype.filter.call(t.textTracks(),(function(t){return-1===i.indexOf(t)})).map(n))},jsonToTextTracks:function(t,e){return t.forEach((function(t){var i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach((function(t){return i.addCue(t)}))})),e.textTracks()},trackToJson_:n},e.exports=i.default},{}],117:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("../event-target")),s=n(t("../utils/fn.js")),a=n(t("../utils/browser.js")),l=r(t("global/document")),c=function t(e){var i=this;if(a.IS_IE8)for(var n in i=l.default.createElement("custom"),t.prototype)i[n]=t.prototype[n];e=e||[],i.tracks_=[],Object.defineProperty(i,"length",{get:function(){return this.tracks_.length}});for(var r=0;r<e.length;r++)i.addTrack_(e[r]);if(a.IS_IE8)return i};for(var u in(c.prototype=Object.create(o.default.prototype)).constructor=c,c.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},c.prototype.allowedEvents_)c.prototype["on"+u]=null;c.prototype.addTrack_=function(t){var e=this.tracks_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.tracks_[e]}}),t.addEventListener("modechange",s.bind(this,(function(){this.trigger("change")}))),this.tracks_.push(t),this.trigger({type:"addtrack",track:t})},c.prototype.removeTrack_=function(t){for(var e=void 0,i=0,n=this.length;i<n;i++)if((e=this[i])===t){this.tracks_.splice(i,1);break}this.trigger({type:"removetrack",track:e})},c.prototype.getTrackById=function(t){for(var e=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===t){e=r;break}}return e},i.default=c,e.exports=i.default},{"../event-target":95,"../utils/browser.js":120,"../utils/fn.js":125,"global/document":1}],118:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("../component")),s=n(t("../utils/events.js")),a=n(t("../utils/fn.js")),l=r(t("../utils/log.js")),c=r(t("safe-json-parse/tuple")),u=r(t("global/window")),h=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,i,n),this.hide(),void 0===n.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),s.on(this.el().querySelector(".vjs-done-button"),"click",a.bind(this,(function(){this.saveSettings(),this.hide()}))),s.on(this.el().querySelector(".vjs-default-button"),"click",a.bind(this,(function(){this.el().querySelector(".vjs-fg-color > select").selectedIndex=0,this.el().querySelector(".vjs-bg-color > select").selectedIndex=0,this.el().querySelector(".window-color > select").selectedIndex=0,this.el().querySelector(".vjs-text-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-bg-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-window-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-edge-style select").selectedIndex=0,this.el().querySelector(".vjs-font-family select").selectedIndex=0,this.el().querySelector(".vjs-font-percent select").selectedIndex=2,this.updateDisplay()}))),s.on(this.el().querySelector(".vjs-fg-color > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-bg-color > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".window-color > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-text-opacity > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-bg-opacity > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-window-opacity > select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-font-percent select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-edge-style select"),"change",a.bind(this,this.updateDisplay)),s.on(this.el().querySelector(".vjs-font-family select"),"change",a.bind(this,this.updateDisplay)),this.options_.persistTextTrackSettings&&this.restoreSettings()}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:'<div class="vjs-tracksettings">\n      <div class="vjs-tracksettings-colors">\n        <div class="vjs-fg-color vjs-tracksetting">\n            <label class="vjs-label">Foreground</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-text-opacity vjs-opacity">\n              <select>\n                <option value="">---</option>\n                <option value="1">Opaque</option>\n                <option value="0.5">Semi-Opaque</option>\n              </select>\n            </span>\n        </div> \x3c!-- vjs-fg-color --\x3e\n        <div class="vjs-bg-color vjs-tracksetting">\n            <label class="vjs-label">Background</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-bg-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> \x3c!-- vjs-bg-color --\x3e\n        <div class="window-color vjs-tracksetting">\n            <label class="vjs-label">Window</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-window-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> \x3c!-- vjs-window-color --\x3e\n      </div> \x3c!-- vjs-tracksettings --\x3e\n      <div class="vjs-tracksettings-font">\n        <div class="vjs-font-percent vjs-tracksetting">\n          <label class="vjs-label">Font Size</label>\n          <select>\n            <option value="0.50">50%</option>\n            <option value="0.75">75%</option>\n            <option value="1.00" selected>100%</option>\n            <option value="1.25">125%</option>\n            <option value="1.50">150%</option>\n            <option value="1.75">175%</option>\n            <option value="2.00">200%</option>\n            <option value="3.00">300%</option>\n            <option value="4.00">400%</option>\n          </select>\n        </div> \x3c!-- vjs-font-percent --\x3e\n        <div class="vjs-edge-style vjs-tracksetting">\n          <label class="vjs-label">Text Edge Style</label>\n          <select>\n            <option value="none">None</option>\n            <option value="raised">Raised</option>\n            <option value="depressed">Depressed</option>\n            <option value="uniform">Uniform</option>\n            <option value="dropshadow">Dropshadow</option>\n          </select>\n        </div> \x3c!-- vjs-edge-style --\x3e\n        <div class="vjs-font-family vjs-tracksetting">\n          <label class="vjs-label">Font Family</label>\n          <select>\n            <option value="">Default</option>\n            <option value="monospaceSerif">Monospace Serif</option>\n            <option value="proportionalSerif">Proportional Serif</option>\n            <option value="monospaceSansSerif">Monospace Sans-Serif</option>\n            <option value="proportionalSansSerif">Proportional Sans-Serif</option>\n            <option value="casual">Casual</option>\n            <option value="script">Script</option>\n            <option value="small-caps">Small Caps</option>\n          </select>\n        </div> \x3c!-- vjs-font-family --\x3e\n      </div>\n    </div>\n    <div class="vjs-tracksettings-controls">\n      <button class="vjs-default-button">Defaults</button>\n      <button class="vjs-done-button">Done</button>\n    </div>'})},e.prototype.getValues=function(){var t=this.el(),e=f(t.querySelector(".vjs-edge-style select")),i=f(t.querySelector(".vjs-font-family select")),n=f(t.querySelector(".vjs-fg-color > select")),r=f(t.querySelector(".vjs-text-opacity > select")),o=f(t.querySelector(".vjs-bg-color > select")),s=f(t.querySelector(".vjs-bg-opacity > select")),a=f(t.querySelector(".window-color > select")),l={backgroundOpacity:s,textOpacity:r,windowOpacity:f(t.querySelector(".vjs-window-opacity > select")),edgeStyle:e,fontFamily:i,color:n,backgroundColor:o,windowColor:a,fontPercent:u.default.parseFloat(f(t.querySelector(".vjs-font-percent > select")))};for(var c in l)(""===l[c]||"none"===l[c]||"fontPercent"===c&&1===l[c])&&delete l[c];return l},e.prototype.setValues=function(t){var e=this.el();d(e.querySelector(".vjs-edge-style select"),t.edgeStyle),d(e.querySelector(".vjs-font-family select"),t.fontFamily),d(e.querySelector(".vjs-fg-color > select"),t.color),d(e.querySelector(".vjs-text-opacity > select"),t.textOpacity),d(e.querySelector(".vjs-bg-color > select"),t.backgroundColor),d(e.querySelector(".vjs-bg-opacity > select"),t.backgroundOpacity),d(e.querySelector(".window-color > select"),t.windowColor),d(e.querySelector(".vjs-window-opacity > select"),t.windowOpacity);var i=t.fontPercent;i&&(i=i.toFixed(2)),d(e.querySelector(".vjs-font-percent > select"),i)},e.prototype.restoreSettings=function(){var t=c.default(u.default.localStorage.getItem("vjs-text-track-settings")),e=t[0],i=t[1];e&&l.default.error(e),i&&this.setValues(i)},e.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.getOwnPropertyNames(t).length>0?u.default.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):u.default.localStorage.removeItem("vjs-text-track-settings")}catch(t){}}},e.prototype.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},e}(o.default);function f(t){var e=void 0;return t.selectedOptions?e=t.selectedOptions[0]:t.options&&(e=t.options[t.options.selectedIndex]),e.value}function d(t,e){if(e){var i=void 0;for(i=0;i<t.options.length&&t.options[i].value!==e;i++);t.selectedIndex=i}}o.default.registerComponent("TextTrackSettings",h),i.default=h,e.exports=i.default},{"../component":63,"../utils/events.js":124,"../utils/fn.js":125,"../utils/log.js":128,"global/window":2,"safe-json-parse/tuple":53}],119:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("./text-track-cue-list")),s=n(t("../utils/fn.js")),a=n(t("../utils/guid.js")),l=n(t("../utils/browser.js")),c=n(t("./text-track-enums")),u=r(t("../utils/log.js")),h=r(t("../event-target")),f=r(t("global/document")),d=r(t("global/window")),p=t("../utils/url.js"),g=r(t("xhr")),m=function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!e.tech)throw new Error("A tech was not provided.");var i=this;if(l.IS_IE8)for(var n in i=f.default.createElement("custom"),t.prototype)i[n]=t.prototype[n];i.tech_=e.tech;var r=c.TextTrackMode[e.mode]||"disabled",u=c.TextTrackKind[e.kind]||"subtitles",h=e.label||"",d=e.language||e.srclang||"",p=e.id||"vjs_text_track_"+a.newGUID();"metadata"!==u&&"chapters"!==u||(r="hidden"),i.cues_=[],i.activeCues_=[];var g=new o.default(i.cues_),m=new o.default(i.activeCues_),_=!1,b=s.bind(i,(function(){this.activeCues,_&&(this.trigger("cuechange"),_=!1)}));if("disabled"!==r&&i.tech_.on("timeupdate",b),Object.defineProperty(i,"kind",{get:function(){return u},set:Function.prototype}),Object.defineProperty(i,"label",{get:function(){return h},set:Function.prototype}),Object.defineProperty(i,"language",{get:function(){return d},set:Function.prototype}),Object.defineProperty(i,"id",{get:function(){return p},set:Function.prototype}),Object.defineProperty(i,"mode",{get:function(){return r},set:function(t){c.TextTrackMode[t]&&("showing"===(r=t)&&this.tech_.on("timeupdate",b),this.trigger("modechange"))}}),Object.defineProperty(i,"cues",{get:function(){return this.loaded_?g:null},set:Function.prototype}),Object.defineProperty(i,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return m;for(var t=this.tech_.currentTime(),e=[],i=0,n=this.cues.length;i<n;i++){var r=this.cues[i];r.startTime<=t&&r.endTime>=t?e.push(r):r.startTime===r.endTime&&r.startTime<=t&&r.startTime+.5>=t&&e.push(r)}if(_=!1,e.length!==this.activeCues_.length)_=!0;else for(i=0;i<e.length;i++)-1===y.call(this.activeCues_,e[i])&&(_=!0);return this.activeCues_=e,m.setCues_(this.activeCues_),m},set:Function.prototype}),e.src?(i.src=e.src,v(e.src,i)):i.loaded_=!0,l.IS_IE8)return i};(m.prototype=Object.create(h.default.prototype)).constructor=m,m.prototype.allowedEvents_={cuechange:"cuechange"},m.prototype.addCue=function(t){var e=this.tech_.textTracks();if(e)for(var i=0;i<e.length;i++)e[i]!==this&&e[i].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},m.prototype.removeCue=function(t){for(var e=!1,i=0,n=this.cues_.length;i<n;i++)this.cues_[i]===t&&(this.cues_.splice(i,1),e=!0);e&&this.cues.setCues_(this.cues_)};var v=function(t,e){var i={uri:t},n=p.isCrossOrigin(t);n&&(i.cors=n),g.default(i,s.bind(this,(function(t,i,n){if(t)return u.default.error(t,i);e.loaded_=!0,function t(e,i){if("function"!=typeof d.default.WebVTT)return d.default.setTimeout((function(){t(e,i)}),25);var n=new d.default.WebVTT.Parser(d.default,d.default.vttjs,d.default.WebVTT.StringDecoder());n.oncue=function(t){i.addCue(t)},n.onparsingerror=function(t){u.default.error(t)},n.parse(e),n.flush()}(n,e)})))},y=function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return-1;var r=+e||0;if(Math.abs(r)===1/0&&(r=0),r>=n)return-1;for(var o=Math.max(r>=0?r:n-Math.abs(r),0);o<n;){if(o in i&&i[o]===t)return o;o++}return-1};i.default=m,e.exports=i.default},{"../event-target":95,"../utils/browser.js":120,"../utils/fn.js":125,"../utils/guid.js":127,"../utils/log.js":128,"../utils/url.js":133,"./text-track-cue-list":113,"./text-track-enums":115,"global/document":1,"global/window":2,xhr:55}],120:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("global/document")),o=n(t("global/window")),s=o.default.navigator.userAgent,a=/AppleWebKit\/([\d.]+)/i.exec(s),l=a?parseFloat(a.pop()):null,c=/iPhone/i.test(s);i.IS_IPHONE=c;var u=/iPad/i.test(s);i.IS_IPAD=u;var h=/iPod/i.test(s);i.IS_IPOD=h;var f=c||u||h;i.IS_IOS=f;var d=function(){var t=s.match(/OS (\d+)_/i);if(t&&t[1])return t[1]}();i.IOS_VERSION=d;var p=/Android/i.test(s);i.IS_ANDROID=p;var g,m,v,y=(v=s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(g=v[1]&&parseFloat(v[1]),m=v[2]&&parseFloat(v[2]),g&&m?parseFloat(v[1]+"."+v[2]):g||null):null;i.ANDROID_VERSION=y;var _=p&&/webkit/i.test(s)&&y<2.3;i.IS_OLD_ANDROID=_;var b=p&&y<5&&l<537;i.IS_NATIVE_ANDROID=b;var w=/Firefox/i.test(s);i.IS_FIREFOX=w;var x=/Chrome/i.test(s);i.IS_CHROME=x;var C=/MSIE\s8\.0/.test(s);i.IS_IE8=C;var T=!!("ontouchstart"in o.default||o.default.DocumentTouch&&r.default instanceof o.default.DocumentTouch);i.TOUCH_ENABLED=T;var S="backgroundSize"in r.default.createElement("video").style;i.BACKGROUND_SIZE_SUPPORTED=S},{"global/document":1,"global/window":2}],121:[function(t,e,i){"use strict";i.__esModule=!0,i.bufferedPercent=function(t,e){var i,r,o=0;if(!e)return 0;t&&t.length||(t=n.createTimeRange(0,0));for(var s=0;s<t.length;s++)i=t.start(s),(r=t.end(s))>e&&(r=e),o+=r-i;return o/e};var n=t("./time-ranges.js")},{"./time-ranges.js":131}],122:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./log.js"),o=(n=r)&&n.__esModule?n:{default:n},s={get:function(t,e){return t[e]},set:function(t,e,i){return t[e]=i,!0}};i.default=function(t){var e,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if("function"==typeof Proxy){var n=(e={},Object.keys(i).forEach((function(t){s.hasOwnProperty(t)&&(e[t]=function(){return o.default.warn(i[t]),s[t].apply(this,arguments)})})),{v:new Proxy(t,e)});if("object"==typeof n)return n.v}return t},e.exports=i.default},{"./log.js":128}],123:[function(t,e,i){"use strict";i.__esModule=!0,i.getEl=function(t){return 0===t.indexOf("#")&&(t=t.slice(1)),s.default.getElementById(t)},i.createEl=function(){var t=arguments.length<=0||void 0===arguments[0]?"div":arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=s.default.createElement(t);return Object.getOwnPropertyNames(e).forEach((function(t){var i=e[t];-1!==t.indexOf("aria-")||"role"===t||"type"===t?(c.default.warn(u.default(r,t,i)),n.setAttribute(t,i)):n[t]=i})),Object.getOwnPropertyNames(i).forEach((function(t){i[t],n.setAttribute(t,i[t])})),n},i.insertElFirst=function(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},i.getElData=function(t){var e=t[f];return e||(e=t[f]=l.newGUID()),h[e]||(h[e]={}),h[e]},i.hasElData=function(t){var e=t[f];return!!e&&!!Object.getOwnPropertyNames(h[e]).length},i.removeElData=function(t){var e=t[f];if(e){delete h[e];try{delete t[f]}catch(e){t.removeAttribute?t.removeAttribute(f):t[f]=null}}},i.hasElClass=d,i.addElClass=function(t,e){d(t,e)||(t.className=""===t.className?e:t.className+" "+e)},i.removeElClass=function(t,e){if(d(t,e)){for(var i=t.className.split(" "),n=i.length-1;n>=0;n--)i[n]===e&&i.splice(n,1);t.className=i.join(" ")}},i.setElAttributes=function(t,e){Object.getOwnPropertyNames(e).forEach((function(i){var n=e[i];null==n||!1===n?t.removeAttribute(i):t.setAttribute(i,!0===n?"":n)}))},i.getElAttributes=function(t){var e,i,n,r,o;if(e={},i=",autoplay,controls,loop,muted,default,",t&&t.attributes&&t.attributes.length>0)for(var s=(n=t.attributes).length-1;s>=0;s--)r=n[s].name,o=n[s].value,"boolean"!=typeof t[r]&&-1===i.indexOf(","+r+",")||(o=null!==o),e[r]=o;return e},i.blockTextSelection=function(){s.default.body.focus(),s.default.onselectstart=function(){return!1}},i.unblockTextSelection=function(){s.default.onselectstart=function(){return!0}},i.findElPosition=p,i.getPointerPosition=function(t,e){var i={},n=p(t),r=t.offsetWidth,o=t.offsetHeight,s=n.top,a=n.left,l=e.pageY,c=e.pageX;return e.changedTouches&&(c=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(s-l+o)/o)),i.x=Math.max(0,Math.min(1,(c-a)/r)),i};var n,r=((n=["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]).raw=["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],n);function o(t){return t&&t.__esModule?t:{default:t}}var s=o(t("global/document")),a=o(t("global/window")),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./guid.js")),c=o(t("./log.js")),u=o(t("tsml")),h={},f="vdata"+(new Date).getTime();function d(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function p(t){var e=void 0;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var i=s.default.documentElement,n=s.default.body,r=i.clientLeft||n.clientLeft||0,o=a.default.pageXOffset||n.scrollLeft,l=e.left+o-r,c=i.clientTop||n.clientTop||0,u=a.default.pageYOffset||n.scrollTop,h=e.top+u-c;return{left:Math.round(l),top:Math.round(h)}}},{"./guid.js":127,"./log.js":128,"global/document":1,"global/window":2,tsml:54}],124:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}i.__esModule=!0,i.on=c,i.off=u,i.trigger=function t(e,i,n){var r=o.hasElData(e)?o.getElData(e):{},s=e.parentNode||e.ownerDocument;if("string"==typeof i&&(i={type:i,target:e}),i=h(i),r.dispatcher&&r.dispatcher.call(e,i,n),s&&!i.isPropagationStopped()&&!0===i.bubbles)t.call(null,s,i,n);else if(!s&&!i.defaultPrevented){var a=o.getElData(i.target);i.target[i.type]&&(a.disabled=!0,"function"==typeof i.target[i.type]&&i.target[i.type](),a.disabled=!1)}return!i.defaultPrevented},i.one=function t(e,i,n){if(Array.isArray(i))return d(t,e,i,n);var r=function t(){u(e,i,t),n.apply(this,arguments)};r.guid=n.guid=n.guid||s.newGUID(),c(e,i,r)},i.fixEvent=h;var o=r(t("./dom.js")),s=r(t("./guid.js")),a=n(t("global/window")),l=n(t("global/document"));function c(t,e,i){if(Array.isArray(e))return d(c,t,e,i);var n=o.getElData(t);n.handlers||(n.handlers={}),n.handlers[e]||(n.handlers[e]=[]),i.guid||(i.guid=s.newGUID()),n.handlers[e].push(i),n.dispatcher||(n.disabled=!1,n.dispatcher=function(e,i){if(!n.disabled){e=h(e);var r=n.handlers[e.type];if(r)for(var o=r.slice(0),s=0,a=o.length;s<a&&!e.isImmediatePropagationStopped();s++)o[s].call(t,e,i)}}),1===n.handlers[e].length&&(t.addEventListener?t.addEventListener(e,n.dispatcher,!1):t.attachEvent&&t.attachEvent("on"+e,n.dispatcher))}function u(t,e,i){if(o.hasElData(t)){var n=o.getElData(t);if(n.handlers){if(Array.isArray(e))return d(u,t,e,i);var r=function(e){n.handlers[e]=[],f(t,e)};if(e){var s=n.handlers[e];if(s)if(i){if(i.guid)for(var a=0;a<s.length;a++)s[a].guid===i.guid&&s.splice(a--,1);f(t,e)}else r(e)}else for(var l in n.handlers)r(l)}}}function h(t){function e(){return!0}function i(){return!1}if(!t||!t.isPropagationStopped){var n=t||a.default.event;for(var r in t={},n)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&n.preventDefault||(t[r]=n[r]));if(t.target||(t.target=t.srcElement||l.default),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){n.preventDefault&&n.preventDefault(),t.returnValue=!1,n.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),t.cancelBubble=!0,n.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=i,t.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=i,null!=t.clientX){var o=l.default.documentElement,s=l.default.body;t.pageX=t.clientX+(o&&o.scrollLeft||s&&s.scrollLeft||0)-(o&&o.clientLeft||s&&s.clientLeft||0),t.pageY=t.clientY+(o&&o.scrollTop||s&&s.scrollTop||0)-(o&&o.clientTop||s&&s.clientTop||0)}t.which=t.charCode||t.keyCode,null!=t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}function f(t,e){var i=o.getElData(t);0===i.handlers[e].length&&(delete i.handlers[e],t.removeEventListener?t.removeEventListener(e,i.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&o.removeElData(t)}function d(t,e,i,n){i.forEach((function(i){t(e,i,n)}))}},{"./dom.js":123,"./guid.js":127,"global/document":1,"global/window":2}],125:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./guid.js");i.bind=function(t,e,i){e.guid||(e.guid=n.newGUID());var r=function(){return e.apply(t,arguments)};return r.guid=i?i+"_"+e.guid:e.guid,r}},{"./guid.js":127}],126:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e,i,n,r,o,s=arguments.length<=1||void 0===arguments[1]?t:arguments[1];return e=Math.floor(t%60),i=Math.floor(t/60%60),n=Math.floor(t/3600),r=Math.floor(s/60%60),o=Math.floor(s/3600),(isNaN(t)||t===1/0)&&(n=i=e="-"),(n=n>0||o>0?n+":":"")+(i=((n||r>=10)&&i<10?"0"+i:i)+":")+(e=e<10?"0"+e:e)},e.exports=i.default},{}],127:[function(t,e,i){"use strict";i.__esModule=!0,i.newGUID=function(){return n++};var n=1},{}],128:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("global/window"),o=(n=r)&&n.__esModule?n:{default:n},s=function(){a(null,arguments)};function a(t,e){var i=Array.prototype.slice.call(e),n=function(){},r=o.default.console||{log:n,warn:n,error:n};t?i.unshift(t.toUpperCase()+":"):t="log",s.history.push(i),i.unshift("VIDEOJS:"),r[t].apply?r[t].apply(r,i):r[t](i.join(" "))}s.history=[],s.error=function(){a("error",arguments)},s.warn=function(){a("warn",arguments)},i.default=s,e.exports=i.default},{"global/window":2}],129:[function(t,e,i){"use strict";i.__esModule=!0,i.default=l;var n,r=t("lodash-compat/object/merge"),o=(n=r)&&n.__esModule?n:{default:n};function s(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object}var a=function(t,e){return s(e)?s(t)?void 0:l(e):e};function l(){var t=Array.prototype.slice.call(arguments);return t.unshift({}),t.push(a),o.default.apply(null,t),t[0]}e.exports=i.default},{"lodash-compat/object/merge":40}],130:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("global/document"),o=(n=r)&&n.__esModule?n:{default:n};i.createStyleElement=function(t){var e=o.default.createElement("style");return e.className=t,e},i.setTextContent=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e}},{"global/document":1}],131:[function(t,e,i){"use strict";i.__esModule=!0,i.createTimeRanges=s;var n,r=t("./log.js"),o=(n=r)&&n.__esModule?n:{default:n};function s(t,e){return Array.isArray(t)?a(t):void 0===t||void 0===e?a():a([[t,e]])}function a(t){return void 0===t||0===t.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:l.bind(null,"start",0,t),end:l.bind(null,"end",1,t)}}function l(t,e,i,n){return void 0===n&&(o.default.warn("DEPRECATED: Function '"+t+"' on 'TimeRanges' called without an index argument."),n=0),function(t,e,i){if(e<0||e>i)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is greater than or equal to the maximum bound ("+i+").")}(t,n,i.length-1),i[n][e]}i.createTimeRange=s},{"./log.js":128}],132:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},e.exports=i.default},{}],133:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=n(t("global/document")),o=n(t("global/window")),s=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],i=r.default.createElement("a");i.href=t;var n=""===i.host&&"file:"!==i.protocol,o=void 0;n&&((o=r.default.createElement("div")).innerHTML='<a href="'+t+'"></a>',i=o.firstChild,o.setAttribute("style","display:none; position:absolute;"),r.default.body.appendChild(o));for(var s={},a=0;a<e.length;a++)s[e[a]]=i[e[a]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),n&&r.default.body.removeChild(o),s};i.parseUrl=s,i.getAbsoluteURL=function(t){if(!t.match(/^https?:\/\//)){var e=r.default.createElement("div");e.innerHTML='<a href="'+t+'">x</a>',t=e.firstChild.href}return t},i.getFileExtension=function(t){if("string"==typeof t){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(t);if(e)return e.pop().toLowerCase()}return""},i.isCrossOrigin=function(t){var e=s(t),i=o.default.location;return(":"===e.protocol?i.protocol:e.protocol)+e.host!==i.protocol+i.host}},{"global/document":1,"global/window":2}],134:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=r(t("global/document")),s=n(t("./setup")),a=n(t("./utils/stylesheet.js")),l=r(t("./component")),c=r(t("./event-target")),u=n(t("./utils/events.js")),h=r(t("./player")),f=r(t("./plugins.js")),d=r(t("../../src/js/utils/merge-options.js")),p=n(t("./utils/fn.js")),g=r(t("./tracks/text-track.js")),m=(r(t("object.assign")),t("./utils/time-ranges.js")),v=r(t("./utils/format-time.js")),y=r(t("./utils/log.js")),_=n(t("./utils/dom.js")),b=n(t("./utils/browser.js")),w=n(t("./utils/url.js")),x=r(t("./extend.js")),C=r(t("lodash-compat/object/merge")),T=r(t("./utils/create-deprecation-proxy.js")),S=r(t("xhr"));r(t("./tech/html5.js")),r(t("./tech/flash.js")),"undefined"==typeof HTMLVideoElement&&(o.default.createElement("video"),o.default.createElement("audio"),o.default.createElement("track"));var k=function t(e,i,n){var r;if("string"==typeof e){if(0===e.indexOf("#")&&(e=e.slice(1)),t.getPlayers()[e])return i&&y.default.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&t.getPlayers()[e].ready(n),t.getPlayers()[e];r=_.getEl(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return r.player||new h.default(r,i,n)},O=o.default.querySelector(".vjs-styles-defaults");if(!O){O=a.createStyleElement("vjs-styles-defaults");var j=o.default.querySelector("head");j.insertBefore(O,j.firstChild),a.setTextContent(O,"\n    .video-js {\n      width: 300px;\n      height: 150px;\n    }\n\n    .vjs-fluid {\n      padding-top: 56.25%\n    }\n  ")}s.autoSetupTimeout(1,k),k.VERSION="5.0.2",k.options=h.default.prototype.options_,k.getPlayers=function(){return h.default.players},k.players=T.default(h.default.players,{get:"Access to videojs.players is deprecated; use videojs.getPlayers instead",set:"Modification of videojs.players is deprecated"}),k.getComponent=l.default.getComponent,k.registerComponent=l.default.registerComponent,k.browser=b,k.TOUCH_ENABLED=b.TOUCH_ENABLED,k.extend=x.default,k.mergeOptions=d.default,k.bind=p.bind,k.plugin=f.default,k.addLanguage=function(t,e){var i;return t=(""+t).toLowerCase(),C.default(k.options.languages,(i={},i[t]=e,i))[t]},k.log=y.default,k.createTimeRange=k.createTimeRanges=m.createTimeRanges,k.formatTime=v.default,k.parseUrl=w.parseUrl,k.isCrossOrigin=w.isCrossOrigin,k.EventTarget=c.default,k.on=u.on,k.one=u.one,k.off=u.off,k.trigger=u.trigger,k.xhr=S.default,k.TextTrack=g.default,"object"==typeof i&&"object"==typeof e&&(e.exports=k),i.default=k,e.exports=i.default},{"../../src/js/utils/merge-options.js":129,"./component":63,"./event-target":95,"./extend.js":96,"./player":103,"./plugins.js":104,"./setup":106,"./tech/flash.js":109,"./tech/html5.js":110,"./tracks/text-track.js":119,"./utils/browser.js":120,"./utils/create-deprecation-proxy.js":122,"./utils/dom.js":123,"./utils/events.js":124,"./utils/fn.js":125,"./utils/format-time.js":126,"./utils/log.js":128,"./utils/stylesheet.js":130,"./utils/time-ranges.js":131,"./utils/url.js":133,"global/document":1,"lodash-compat/object/merge":40,"object.assign":45,xhr:55}]},{},[134])(134),r=(n=this).vttjs={},o=r.VTTCue,s=r.VTTRegion,a=n.VTTCue,l=n.VTTRegion,r.shim=function(){r.VTTCue=o,r.VTTRegion=s},r.restore=function(){r.VTTCue=a,r.VTTRegion=l},function(t,e){var i="auto",n={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function o(t){return"string"==typeof t&&(!!r[t.toLowerCase()]&&t.toLowerCase())}function s(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function a(t,e,r){var a=this,l=/MSIE\s8\.0/.test(navigator.userAgent),c={};l?a=document.createElement("custom"):c.enumerable=!0,a.hasBeenReset=!1;var u="",h=!1,f=t,d=e,p=r,g=null,m="",v=!0,y="auto",_="start",b=50,w="middle",x=50,C="middle";if(Object.defineProperty(a,"id",s({},c,{get:function(){return u},set:function(t){u=""+t}})),Object.defineProperty(a,"pauseOnExit",s({},c,{get:function(){return h},set:function(t){h=!!t}})),Object.defineProperty(a,"startTime",s({},c,{get:function(){return f},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",s({},c,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",s({},c,{get:function(){return p},set:function(t){p=""+t,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",s({},c,{get:function(){return g},set:function(t){g=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",s({},c,{get:function(){return m},set:function(t){var e=function(t){return"string"==typeof t&&(!!n[t.toLowerCase()]&&t.toLowerCase())}(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",s({},c,{get:function(){return v},set:function(t){v=!!t,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",s({},c,{get:function(){return y},set:function(t){if("number"!=typeof t&&t!==i)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",s({},c,{get:function(){return _},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",s({},c,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",s({},c,{get:function(){return w},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",s({},c,{get:function(){return x},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");x=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",s({},c,{get:function(){return C},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");C=e,this.hasBeenReset=!0}})),a.displayState=void 0,l)return a}a.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},t.VTTCue=t.VTTCue||a,e.VTTCue=a}(this,this.vttjs||{}),function(t,e){var i={"":!0,up:!0};function n(t){return"number"==typeof t&&t>=0&&t<=100}function r(){var t=100,e=3,r=0,o=100,s=0,a=100,l="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!n(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return e},set:function(t){if("number"!=typeof t)throw new TypeError("Lines must be set to a number.");e=t}},regionAnchorY:{enumerable:!0,get:function(){return o},set:function(t){if(!n(t))throw new Error("RegionAnchorX must be between 0 and 100.");o=t}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(t){if(!n(t))throw new Error("RegionAnchorY must be between 0 and 100.");r=t}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(t){if(!n(t))throw new Error("ViewportAnchorY must be between 0 and 100.");a=t}},viewportAnchorX:{enumerable:!0,get:function(){return s},set:function(t){if(!n(t))throw new Error("ViewportAnchorX must be between 0 and 100.");s=t}},scroll:{enumerable:!0,get:function(){return l},set:function(t){var e=function(t){return"string"==typeof t&&(!!i[t.toLowerCase()]&&t.toLowerCase())}(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");l=e}}})}t.VTTRegion=t.VTTRegion||r,e.VTTRegion=r}(this,this.vttjs||{}),function(t){var e=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function i(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function n(t){function e(t,e,i,n){return 3600*(0|t)+60*(0|e)+(0|i)+(0|n)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function r(){this.values=e(null)}function o(t,e,i,n){var r=n?t.split(n):[t];for(var o in r)if("string"==typeof r[o]){var s=r[o].split(i);if(2===s.length)e(s[0],s[1])}}function s(t,e,s){var a=t;function l(){var e=n(t);if(null===e)throw new i(i.Errors.BadTimeStamp,"Malformed timestamp: "+a);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function c(){t=t.replace(/^\s+/,"")}if(c(),e.startTime=l(),c(),"--\x3e"!==t.substr(0,3))throw new i(i.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+a);t=t.substr(3),c(),e.endTime=l(),c(),function(t,e){var i=new r;o(t,(function(t,e){switch(t){case"region":for(var n=s.length-1;n>=0;n--)if(s[n].id===e){i.set(t,s[n].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var r=e.split(","),o=r[0];i.integer(t,o),i.percent(t,o)&&i.set("snapToLines",!1),i.alt(t,o,["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start","middle","end"]);break;case"position":r=e.split(","),i.percent(t,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start","middle","end"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start","middle","end","left","right"])}}),/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical",""),e.line=i.get("line","auto"),e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align","middle"),e.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}(t,e)}i.prototype=e(Error.prototype),i.prototype.constructor=i,i.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},r.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var a={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},c={v:"title",lang:"lang"},u={rt:"ruby"};function h(t,e){function i(){if(!e)return null;var t,i=e.match(/^([^<]*)(<[^>]+>?)?/);return t=i[1]?i[1]:i[2],e=e.substr(t.length),t}function r(t){return a[t]}function o(t){for(;y=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(y[0],r);return t}function s(t,e){return!u[e.localName]||u[e.localName]===t.localName}function h(e,i){var n=l[e];if(!n)return null;var r=t.document.createElement(n);r.localName=n;var o=c[e];return o&&i&&(r[o]=i.trim()),r}for(var f,d=t.document.createElement("div"),p=d,g=[];null!==(f=i());)if("<"!==f[0])p.appendChild(t.document.createTextNode(o(f)));else{if("/"===f[1]){g.length&&g[g.length-1]===f.substr(2).replace(">","")&&(g.pop(),p=p.parentNode);continue}var m,v=n(f.substr(1,f.length-2));if(v){m=t.document.createProcessingInstruction("timestamp",v),p.appendChild(m);continue}var y=f.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(m=h(y[1],y[3])))continue;if(!s(p,m))continue;y[2]&&(m.className=y[2].substr(1).replace("."," ")),g.push(y[1]),p.appendChild(m),p=m}return d}var f=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];function d(){}function p(t,e,i){var n=/MSIE\s8\.0/.test(navigator.userAgent),r="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)";n&&(r="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),d.call(this),this.cue=e,this.cueDiv=h(t,e.text);var s={color:r,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};n||(s.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",s.unicodeBidi="plaintext"),this.applyStyles(s,this.cueDiv),this.div=t.document.createElement("div"),s={textAlign:"middle"===e.align?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},n||(s.direction=function(t){var e,i=[],n="";if(!t||!t.childNodes)return"ltr";function r(t,e){for(var i=e.childNodes.length-1;i>=0;i--)t.push(e.childNodes[i])}function o(t){if(!t||!t.length)return null;var e=t.pop(),i=e.textContent||e.innerText;if(i){var n=i.match(/^.*(\n|\r)/);return n?(t.length=0,n[0]):i}return"ruby"===e.tagName?o(t):e.childNodes?(r(t,e),o(t)):void 0}for(r(i,t);n=o(i);)for(var s=0;s<n.length;s++){e=n.charCodeAt(s);for(var a=0;a<f.length;a++)if(f[a]===e)return"rtl"}return"ltr"}(this.cueDiv),s.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(s),this.div.appendChild(this.cueDiv);var a=0;switch(e.positionAlign){case"start":a=e.position;break;case"middle":a=e.position-e.size/2;break;case"end":a=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(a,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(a,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function g(t){var e,i,n,r,o=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){i=t.div.offsetHeight,n=t.div.offsetWidth,r=t.div.offsetTop;var s=(s=t.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects();t=t.div.getBoundingClientRect(),e=s?Math.max(s[0]&&s[0].height||0,t.height/s.length):0}this.left=t.left,this.right=t.right,this.top=t.top||r,this.height=t.height||i,this.bottom=t.bottom||r+(t.height||i),this.width=t.width||n,this.lineHeight=void 0!==e?e:t.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function m(t,e,i,n){var r=new g(e),o=e.cue,s=function(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,n=0,r=0;r<i.length&&i[r]!==e;r++)"showing"===i[r].mode&&n++;return-1*++n}(o),a=[];if(o.snapToLines){var l;switch(o.vertical){case"":a=["+y","-y"],l="height";break;case"rl":a=["+x","-x"],l="width";break;case"lr":a=["-x","+x"],l="width"}var c=r.lineHeight,u=c*Math.round(s),h=i[l]+c,f=a[0];Math.abs(u)>h&&(u=u<0?-1:1,u*=Math.ceil(h/c)*c),s<0&&(u+=""===o.vertical?i.height:i.width,a=a.reverse()),r.move(f,u)}else{var d=r.lineHeight/i.height*100;switch(o.lineAlign){case"middle":s-=d/2;break;case"end":s-=d}switch(o.vertical){case"":e.applyStyles({top:e.formatStyle(s,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(s,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(s,"%")})}a=["+y","-x","+x","-y"],r=new g(e)}var p=function(t,e){for(var r,o=new g(t),s=1,a=0;a<e.length;a++){for(;t.overlapsOppositeAxis(i,e[a])||t.within(i)&&t.overlapsAny(n);)t.move(e[a]);if(t.within(i))return t;var l=t.intersectPercentage(i);s>l&&(r=new g(t),s=l),t=new g(o)}return r||o}(r,a);e.move(p.toCSSCompatValues(i))}function v(){}d.prototype.applyStyles=function(t,e){for(var i in e=e||this.div,t)t.hasOwnProperty(i)&&(e.style[i]=t[i])},d.prototype.formatStyle=function(t,e){return 0===t?0:t+e},p.prototype=e(d.prototype),p.prototype.constructor=p,g.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},g.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},g.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},g.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},g.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},g.prototype.intersectPercentage=function(t){return Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left))*Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top))/(this.height*this.width)},g.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},g.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,n=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;return{left:(t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t).left,right:t.right,top:t.top||n,height:t.height||e,bottom:t.bottom||n+(t.height||e),width:t.width||i}},v.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},v.convertCueToDOMTree=function(t,e){return t&&e?h(t,e):null};v.processCues=function(t,e,i){if(!t||!e||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var n=t.document.createElement("div");if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin="1.5%",i.appendChild(n),function(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}(e)){var r=[],o=g.getSimpleBoxPosition(n),s={font:Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var i,a,l=0;l<e.length;l++)a=e[l],i=new p(t,a,s),n.appendChild(i.div),m(0,i,o,r),a.displayState=i.div,r.push(g.getSimpleBoxPosition(i))}()}else for(var a=0;a<e.length;a++)n.appendChild(e[a].displayState)},v.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]},v.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof i))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){var e=this;function n(){for(var t=e.buffer,i=0;i<t.length&&"\r"!==t[i]&&"\n"!==t[i];)++i;var n=t.substr(0,i);return"\r"===t[i]&&++i,"\n"===t[i]&&++i,e.buffer=t.substr(i),n}function a(t){o(t,(function(t,i){switch(t){case"Region":!function(t){var i=new r;if(o(t,(function(t,e){switch(t){case"id":i.set(t,e);break;case"width":i.percent(t,e);break;case"lines":i.integer(t,e);break;case"regionanchor":case"viewportanchor":var n=e.split(",");if(2!==n.length)break;var o=new r;if(o.percent("x",n[0]),o.percent("y",n[1]),!o.has("x")||!o.has("y"))break;i.set(t+"X",o.get("x")),i.set(t+"Y",o.get("y"));break;case"scroll":i.alt(t,e,["up"])}}),/=/,/\s/),i.has("id")){var n=new(e.vttjs.VTTRegion||e.window.VTTRegion);n.width=i.get("width",100),n.lines=i.get("lines",3),n.regionAnchorX=i.get("regionanchorX",0),n.regionAnchorY=i.get("regionanchorY",100),n.viewportAnchorX=i.get("viewportanchorX",0),n.viewportAnchorY=i.get("viewportanchorY",100),n.scroll=i.get("scroll",""),e.onregion&&e.onregion(n),e.regionList.push({id:i.get("id"),region:n})}}(i)}}),/:/)}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var l;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var c=(l=n()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new i(i.Errors.BadSignature);e.state="HEADER"}for(var u=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(u?u=!1:l=n(),e.state){case"HEADER":/:/.test(l)?a(l):l||(e.state="ID");continue;case"NOTE":l||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){e.state="NOTE";break}if(!l)continue;if(e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,""),e.state="CUE",-1===l.indexOf("--\x3e")){e.cue.id=l;continue}case"CUE":try{s(l,e.cue,e.regionList)}catch(t){e.reportOrThrowError(t),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var h=-1!==l.indexOf("--\x3e");if(!l||h&&(u=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=l;continue;case"BADCUE":l||(e.state="ID");continue}}}catch(t){e.reportOrThrowError(t),"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new i(i.Errors.BadSignature)}catch(t){this.reportOrThrowError(t)}return this.onflush&&this.onflush(),this}},t.WebVTT=v}(this,this.vttjs),function(t){var e=t&&t.videojs;if(e){e.CDN_VERSION="5.0.2";var i="https:"===t.location.protocol?"https://":"http://";e.options.flash.swf=i+__vodPlayerUrl__}}(window)}).call(this,i(24))},function(t,e,i){var n;void 0===(n=function(t){var e=i(0),n={LAST_LIVE_TIME:-1,initDuration:0,playDuration:0,delayDuration:0,cmdDelay:0,baseDuration:0,jobs:[],timmer:null,lock:!1,setPlayDuration:function(t){if(t>=0&&(this.playDuration=t,window.localStorage))try{localStorage.setItem("playDuration",t)}catch(t){e.debug("playDuration error: 不支持locaStorage")}},setDisposeTime:function(t){this.LAST_LIVE_TIME>0&&(this.baseDuration=this.LAST_LIVE_TIME+t-this.cmdDelay),this.setDisTimer||(this.setDisTimer=setInterval(function(){this.baseDuration+=1}.bind(this),1e3))},addSchedule:function(t,e,i,n){var r={st:t,command:e,callback:i};n&&"top"===n?this.jobs.unshift(r):this.jobs.push(r)},clearSchedule:function(){this.jobs=[]},run:function(t){e.debug("涂鸦队列开启..."),this.playType=t||"live",this.lock=!1;var i=this;if(!this.timmer){var n;i=this;if(!this.timmer){!function r(){this.timmer=setTimeout((function(){if(!this.lock){if(i.jobs.length>0)for(var o=0,s=i.jobs.length;o<s&&(n=i.jobs[o]);o++)if("playback"===t){if(!(n.st<=i.initDuration+i.playDuration-i.delayDuration))break;i.fire(i.jobs.shift())}else if("live"===t){if(!(n.st&&n.st<=i.baseDuration))break;i.fire(i.jobs.shift()),e.debug("schedule ===> cmd.st:"+n.st+" initDuration:"+i.initDuration+" playDuration:"+i.playDuration+"delayDuration:"+i.delayDuration+" now:"+e.now()+" cmdDelay ==> "+i.cmdDelay)}r()}}),200)}()}}},pause:function(){this.timmer&&(clearTimeout(this.timmer),this.timmer=null),this.setDisTimer&&(clearInterval(this.setDisTimer),this.setDisTimer=null),this.lock=!0},stop:function(){this.initDuration=0,this.delayDuration=0,this.setPlayDuration(0),this.pause(),this.clearSchedule()},fire:function(t){t.callback&&"function"==typeof t.callback&&t.callback(t.command)}};return window.schedule=n,n}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n=i(80),r=i(22),o=i(39),s=i(8)("socket.io-client");t.exports=e=l;var a=e.managers={};function l(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r=n(t),l=r.source,c=r.id,u=r.path,h=a[c]&&u in a[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||h?(s("ignoring socket cache for %s",l),i=o(l,e)):(a[c]||(s("new io instance for %s",l),a[c]=o(l,e)),i=a[c]),r.query&&!e.query&&(e.query=r.query),i.socket(r.path,e)}e.protocol=r.protocol,e.connect=l,e.Manager=i(39),e.Socket=i(45)},function(t,e,i){"use strict";var n={};(0,i(9).assign)(n,i(105),i(108),i(52)),t.exports=n},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){return function(){function extend(){var t=Array.prototype.slice.call(arguments);if(t.length<=1){if("[object Object]"===Array.prototype.toString.call(t[0]))return console.warn("extend methods received one param or none, need two more."),t[0];throw new Error("Must passed an object.")}for(var e=t.shift(),i=0;i<t.length;i++){var n=t[i];if("[object Object]"!==Array.prototype.toString.call(n))throw new Error("extend method's error: the"+(i+1));for(var r in n)"[object Object]"===Object.prototype.toString.call(n[r])?(e[r]={},extend(e[r],n[r])):"[object Array]"===Object.prototype.toString.call(n[r])?e[r]=n[r].slice():e[r]=n[r]}return e}function isEmptyObject(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function formatParam(t,e){var i,n,r=[];for(var o in e=e||!1,t)e?(i=encodeURIComponent(o),n=encodeURIComponent(t[o])):(i=o,n=t[o]),r.push(i+"="+n);return r.join("&")}function ajaxs(options){if("[object Object]"!==Object.prototype.toString.call(options))throw new Error("should passed an object.");var abortTimer=null,responseHeaderContentType="",dhead,s,defaults={url:"",type:"get",dataType:"json",data:{},timeout:0,withCredentials:!0,async:!0,cache:!1,beforeSend:function(t){return t},success:function(){},error:function(){}};defaults=Object.assign?Object.assign(defaults,options):extend(defaults,options);var type=defaults.type.toLowerCase(),url=defaults.url,dataType=defaults.dataType.toLowerCase();if("string"==typeof defaults.data){for(var tempDataArr=defaults.data.split("&"),tempDataObj={},i=0;i<tempDataArr.length;i++){var cur=tempDataArr[i],tempCurArr=cur.split("=");tempDataObj[tempCurArr[0]]=tempCurArr[1]}var data=tempDataObj}else var data=defaults.data;var async=defaults.async,cache=defaults.cache,tTimeStampName="ht_tstamp",timeout=defaults.timeout,encodeFlag=!1,contentType=defaults.contentType;if("jsonp"===dataType){var jsonp=data.jsonp||"callback",jsonpCallback;if(jsonpCallback=defaults.jsonpCallback?defaults.jsonpCallback:"tf_tstamp"+(new Date).getTime().toString()+Math.random().toString().slice(2),url=url+"?"+jsonp+"="+jsonpCallback,url=url+"&"+formatParam(data),cache||(url=url+"&"+tTimeStampName+"="+(new Date).getTime().toString()),s=document.createElement("script"),dhead||(dhead=document.getElementsByTagName("head")[0]),s.src=url,s.onerror=function(){throw new Error("script onerror: jsonp请求发送失败")},defaults.beforeSend&&!1===defaults.beforeSend())return!1;dhead.appendChild(s),window[jsonpCallback]=function(t){clearTimeout(s.timer),dhead.removeChild(s),window[jsonpCallback]=null,defaults.success&&defaults.success(t)},defaults.timeout&&(s.timer=setTimeout((function(){dhead.removeChild(s),window[jsonpCallback]=null,defaults.error&&defaults.error({message:"jsonp request timeout"})}),timeout))}else if("script"===dataType){if(s=document.createElement("script"),dhead||(dhead=document.getElementsByTagName("head")[0]),isEmptyObject(data)||(url=url.lastIndexOf("?")>-1?url+"&"+formatParam(data):url+"?"+formatParam(data)),cache||(url.lastIndexOf("?"),url=url+"&"+tTimeStampName+"="+(new Date).getTime().toString()),s.src=url,s.onload=function(){defaults.success&&defaults.success(this),s=null},s.onerror=function(){defaults.error&&defaults.error({message:"script loaded error"}),s=null},defaults.beforeSend&&!1===defaults.beforeSend())return!1;dhead.appendChild(s)}else{var xhr=new XMLHttpRequest;if(xhr="withCredentials"in xhr?xhr:"undefined"!=typeof XDomainRequest?new XDomainRequest:null,xhr.onreadystatechange=function(){var res,status;1===xhr.readyState&&!abortTimer&&timeout>0&&(abortTimer=setTimeout((function(){xhr.abort(),abortTimer=null}),timeout)),2===xhr.readyState&&(responseHeaderContentType=xhr.getResponseHeader("Content-Type")),4===xhr.readyState&&(status=xhr.status,status>=200&&status<300?(clearTimeout(abortTimer),abortTimer=null,"json"!==dataType||/javascript/.test(responseHeaderContentType)?"xml"===dataType?xhr.responseXML&&(res=xhr.responseXML,res.documentElement&&(res=res.documentElement)):res=xhr.responseText:res="object"==typeof xhr.responseText?xhr.responseText:JSON.parse?"string"==typeof xhr.responseText&&xhr.responseText.length>0?JSON.parse(xhr.responseText):{}:eval("("+xhr.responseText+")"),options.success&&options.success(res)):options.error&&options.error(status))},"get"===type){if(isEmptyObject(data)||(url=url.lastIndexOf("?")>-1?url+"&"+formatParam(data):url+"?"+formatParam(data)),cache||(url=url.lastIndexOf("?")>-1?url+"&"+tTimeStampName+"="+(new Date).getTime().toString():url+"?"+tTimeStampName+"="+(new Date).getTime().toString()),xhr.open(type,url,async),!1===("function"==typeof defaults.beforeSend&&defaults.beforeSend(xhr)))return xhr=null,!1;xhr.send(null)}else if("post"===type){if(xhr.open(type,url,async),contentType?xhr.setRequestHeader("Content-Type",contentType):xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),!1===(defaults.beforeSend&&defaults.beforeSend(xhr)))return xhr=null,!1;var _params="",_postArrs=[];if("object"==typeof data){var _postDatas=Object.keys(data),_it="";if(_postDatas.length>0)for(var _k in data)_it=_k+"="+data[_k],_postArrs.push(_it);_params=_postArrs.join("&")}xhr.send(_params)}}}return ajaxs}()},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(t,e,i){"use strict";var n={signal:1,propertyUpdate:2,init:3,idle:4,debug:5,invokeMethod:6,connectToSignal:7,disconnectFromSignal:8,setProperty:9,response:10},r=function(t,e){if("object"==typeof t&&"function"==typeof t.send){var i=this;this.transport=t,this.send=function(t){"string"!=typeof t&&(t=JSON.stringify(t)),i.transport.send(t)},this.transport.onmessage=function(t){var e=t.data;switch("string"==typeof e&&(e=JSON.parse(e)),e.type){case n.signal:i.handleSignal(e);break;case n.response:i.handleResponse(e);break;case n.propertyUpdate:i.handlePropertyUpdate(e);break;default:console.error("invalid message received:",t.data)}},this.execCallbacks={},this.execId=0,this.exec=function(t,e){e?(i.execId===Number.MAX_VALUE&&(i.execId=Number.MIN_VALUE),t.hasOwnProperty("id")?console.error("Cannot exec message with property id: "+JSON.stringify(t)):(t.id=i.execId++,i.execCallbacks[t.id]=e,i.send(t))):i.send(t)},this.objects={},this.handleSignal=function(t){var e=i.objects[t.object];e?e.signalEmitted(t.signal,t.args):console.warn("Unhandled signal: "+t.object+"::"+t.signal)},this.handleResponse=function(t){t.hasOwnProperty("id")?(i.execCallbacks[t.id](t.data),delete i.execCallbacks[t.id]):console.error("Invalid response message received: ",JSON.stringify(t))},this.handlePropertyUpdate=function(t){for(var e in t.data){var r=t.data[e],o=i.objects[r.object];o?o.propertyUpdate(r.signals,r.properties):console.warn("Unhandled property update: "+r.object+"::"+r.signal)}i.exec({type:n.idle})},this.debug=function(t){i.send({type:n.debug,data:t})},i.exec({type:n.init},(function(t){for(var r in t)new o(r,t[r],i);for(var r in i.objects)i.objects[r].unwrapProperties();e&&e(i),i.exec({type:n.idle})}))}else console.error("The QWebChannel expects a transport object with a send function and onmessage callback property. Given is: transport: "+typeof t+", transport.send: "+typeof t.send)};function o(t,e,i){this.__id__=t,i.objects[t]=this,this.__objectSignals__={},this.__propertyCache__={};var r=this;function s(t,e){var o=t[0],s=t[1];r[o]={connect:function(t){"function"==typeof t?(r.__objectSignals__[s]=r.__objectSignals__[s]||[],r.__objectSignals__[s].push(t),e||"destroyed"===o||i.exec({type:n.connectToSignal,object:r.__id__,signal:s})):console.error("Bad callback given to connect to signal "+o)},disconnect:function(t){if("function"==typeof t){r.__objectSignals__[s]=r.__objectSignals__[s]||[];var a=r.__objectSignals__[s].indexOf(t);-1!==a?(r.__objectSignals__[s].splice(a,1),e||0!==r.__objectSignals__[s].length||i.exec({type:n.disconnectFromSignal,object:r.__id__,signal:s})):console.error("Cannot find connection of signal "+o+" to "+t.name)}else console.error("Bad callback given to disconnect from signal "+o)}}}function a(t,e){var i=r.__objectSignals__[t];i&&i.forEach((function(t){t.apply(t,e)}))}for(var t in this.unwrapQObject=function(t){if(t instanceof Array){for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=r.unwrapQObject(t[n]);return e}if(!t||!t["__QObject*__"]||void 0===t.id)return t;var s=t.id;if(i.objects[s])return i.objects[s];if(t.data){var a=new o(s,t.data,i);return a.destroyed.connect((function(){if(i.objects[s]===a){delete i.objects[s];var t=[];for(var e in a)t.push(e);for(var n in t)delete a[t[n]]}})),a.unwrapProperties(),a}console.error("Cannot unwrap unknown QObject "+s+" without data.")},this.unwrapProperties=function(){for(var t in r.__propertyCache__)r.__propertyCache__[t]=r.unwrapQObject(r.__propertyCache__[t])},this.propertyUpdate=function(t,e){for(var i in e){var n=e[i];r.__propertyCache__[i]=n}for(var o in t)a(o,t[o])},this.signalEmitted=function(t,e){a(t,e)},e.methods.forEach((function(t){var e=t[0],o=t[1];r[e]=function(){for(var t,e=[],s=0;s<arguments.length;++s)"function"==typeof arguments[s]?t=arguments[s]:e.push(arguments[s]);i.exec({type:n.invokeMethod,object:r.__id__,method:o,args:e},(function(e){if(void 0!==e){var i=r.unwrapQObject(e);t&&t(i)}}))}})),e.properties.forEach((function(t){var e=t[0],o=t[1],a=t[2];r.__propertyCache__[e]=t[3],a&&(1===a[0]&&(a[0]=o+"Changed"),s(a,!0)),Object.defineProperty(r,o,{configurable:!0,get:function(){var t=r.__propertyCache__[e];return void 0===t&&console.warn('Undefined value in property cache for property "'+o+'" in object '+r.__id__),t},set:function(t){void 0!==t?(r.__propertyCache__[e]=t,i.exec({type:n.setProperty,object:r.__id__,property:e,value:t})):console.warn("Property setter for "+o+" called with undefined value!")}})})),e.signals.forEach((function(t){s(t,!1)})),e.enums)r[t]=e.enums[t]}t.exports={QWebChannel:r}},function(t,e,i){"use strict";var n,r,o;r=[],void 0===(o="function"==typeof(n=function(){var t=this;function e(e){if(!/MicroMessenger/.test(window.navigator.userAgent))return!1;var i=this;t.WeixinJSBridge.invoke("getNetworkType",{},(function(t){e&&e(i)}),!1)}return function(i){if(t.WeixinJSBridge&&t.WeixinJSBridge.invoke)return e(i);document.addEventListener("WeixinJSBridgeReady",(function(){return e(i)}))}})?n.apply(e,r):n)||(t.exports=o)},function(t,e,i){var n;void 0===(n=function(t){i(1);var e=i(3),n=i(19),r=i(6).default,o=i(0);return{voteUrl:e.APP_HOST+"/live/vote.php",access_token:null,ajax:o.ajax,packet:null,voteLock:!1,postVote:function(t,e){var i=this,s=r.getters("getInitData").user;if(i.voteLock)return!1;i.voteLock=!1;var a={vid:t.vid,action:"vote",option:t.options,access_token:n.getAccessToken()};o.ajax({type:"GET",url:i.voteUrl,data:a,dataType:"jsonp",success:function(n){o.callback(e,n);s.xid,s.uid;var r="";i.packet&&(i.packet.args.vid,r=i.packet.args.info.answer);for(var a=JSON.parse(t.options),l=[],c={1:"A",2:"B",3:"C",4:"D",5:"E",6:"F",7:"G",8:"H"},u=0;u<a.length;u++)l.push(c[a[u]]);l=l.sort();var h=r.split(",");h=h.sort(),n.data&&(0===n.data.answer.length||n.data.isRight);i.voteLock=!1},error:function(){i.voteLock=!1}})},getVoteDetail:function(t,e){var i=n.getAccessToken();o.ajax({type:"GET",data:"access_token="+i+"&action=getVoteList&vid="+t,url:this.voteUrl,dataType:"jsonp",success:function(t){o.callback(e,t)}})},setData:function(t){this.packet=t},init:function(t){this.room=t}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){"use strict";var n=i(4),r=i(28),o=i(64),s=i(34);function a(t){var e=new o(t),i=r(o.prototype.request,e);return n.extend(i,o.prototype,e),n.extend(i,e),i}var l=a(i(31));l.Axios=o,l.create=function(t){return a(s(l.defaults,t))},l.Cancel=i(35),l.CancelToken=i(76),l.isCancel=i(30),l.all=function(t){return Promise.all(t)},l.spread=i(77),t.exports=l,t.exports.default=l},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,i){"use strict";var n=i(4),r=i(29),o=i(65),s=i(66),a=i(34);function l(t){this.defaults=t,this.interceptors={request:new o,response:new o}}l.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method=t.method?t.method.toLowerCase():"get";var e=[s,void 0],i=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)i=i.then(e.shift(),e.shift());return i},l.prototype.getUri=function(t){return t=a(this.defaults,t),r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,i){return this.request(n.merge(i||{},{method:t,url:e}))}})),n.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,i,r){return this.request(n.merge(r||{},{method:t,url:e,data:i}))}})),t.exports=l},function(t,e,i){"use strict";var n=i(4);function r(){this.handlers=[]}r.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){n.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=r},function(t,e,i){"use strict";var n=i(4),r=i(67),o=i(30),s=i(31),a=i(74),l=i(75);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!a(t.url)&&(t.url=l(t.baseURL,t.url)),t.headers=t.headers||{},t.data=r(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return c(t),e.data=r(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(c(t),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,i){"use strict";var n=i(4);t.exports=function(t,e,i){return n.forEach(i,(function(i){t=i(t,e)})),t}},function(t,e,i){"use strict";var n=i(4);t.exports=function(t,e){n.forEach(t,(function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])}))}},function(t,e,i){"use strict";var n=i(33);t.exports=function(t,e,i){var r=i.config.validateStatus;!r||r(i.status)?t(i):e(n("Request failed with status code "+i.status,i.config,null,i.request,i))}},function(t,e,i){"use strict";t.exports=function(t,e,i,n,r){return t.config=e,i&&(t.code=i),t.request=n,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,i){"use strict";var n=i(4),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,o,s={};return t?(n.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=n.trim(t.substr(0,o)).toLowerCase(),i=n.trim(t.substr(o+1)),e){if(s[e]&&r.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([i]):s[e]?s[e]+", "+i:i}})),s):s}},function(t,e,i){"use strict";var n=i(4);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function r(t){var n=t;return e&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return t=r(window.location.href),function(e){var i=n.isString(e)?r(e):e;return i.protocol===t.protocol&&i.host===t.host}}():function(){return!0}},function(t,e,i){"use strict";var n=i(4);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,i,r,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),n.isString(r)&&a.push("path="+r),n.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,i){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,i){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,i){"use strict";var n=i(35);function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var i=this;t((function(t){i.reason||(i.reason=new n(t),e(i.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r((function(e){t=e})),cancel:t}},t.exports=r},function(t,e,i){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,i){var n;void 0===(n=function(t){return{}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n;void 0===(n=function(t){var e=i(1),n=(i(6),i(3)),r=i(36),o=i(0);return{flowerUrl:n.APP_HOST+"/live/flower.php",access_token:r.getAccessToken(),ajax:o.ajax,initData:null,defaults:{amount:0,duration:0,passTime:0,leftTime:0},flowerDuration:0,flowerTimer:null,nativeCall:function(t,e){if(!o.isInNative())return!1;window.SDK&&SDK.call(t,e)},flowerCountdown:function(t,i){var n=this,r=(i=i||"",t.data);if(clearTimeout(n.flowerTimer),n.defaults.amount="get"===i?r.amount||0:"send"===i?r.left_amount||0:r.amount,n.defaults.duration=r.time_interval,n.defaults.passTime=r.pass_time,n.defaults.leftTime=r.left_time,n.defaults.amount>=3)return!1;var s=n.defaults.passTime;o.debug("鲜花统计时间过去====> "+s);var a=0,l=function(){s>=0&&(n.flowerTimer=setTimeout((function(){var t=parseInt(s/n.defaults.duration,10);if(t>0&&t<=3)a!==t&&(n.defaults.amount=t,e.get("flower:total")(t),n.nativeCall("flower:total",{total:t}),a=t);else if(t>=3)return clearTimeout(n.flowerTimer),!1;s+=1,n.defaults.passTime=s,l()}),1e3))};l()},flowerStop:function(){this.defaults.amount=0,this.defaults.duration=0,this.defaults.passTime=0,this.defaults.leftTime=0,clearTimeout(this.flowerTimer)},flowerCallback:function(t){if(t.code===n.CODE_SUCCESS){this.flowerDuration=t.data.time_interval,this.flowerCountdown(t,"get");var i={code:t.code,amount:t.data.amount};e.get("flower:get:init")(i),this.nativeCall("flower:get:init",i)}else if(1202===t.code){i={code:t.code,msg:t.msg};this.flowerStop(),e.get("flower:get:init")(i),this.nativeCall("flower:get:init",i)}else if(15e3===t.code){i={code:t.code,leftTime:t.data.left_time};e.get("flower:time:left")(i),this.nativeCall("flower:time:left",i),this.flowerCountdown(t)}else e.get("flower:load:error")(t)},getFlower:function(t){o.debug("Plugins: flower init...");var e=this;e.initFlower?(e.flowerCallback(e.initFlower),e.initFlower=null):o.ajax({type:"GET",url:e.flowerUrl,dataType:"jsonp",data:{act:"myflower",access_token:r.getAccessToken()},success:function(i){e.flowerCallback(i),t&&t(i)}})},sendFlower:function(){var t=this;if(0===t.defaults.amount){var i={code:15e3,leftTime:t.defaults.duration-t.defaults.passTime};return e.get("flower:time:left")(i),t.nativeCall("flower:time:left",i),!1}o.ajax({type:"GET",url:t.flowerUrl,data:{act:"send",access_token:r.getAccessToken()},dataType:"jsonp",success:function(i){if(i.code===n.CODE_SUCCESS){t.flowerDuration=i.data.time_interval,t.flowerCountdown(i,"send");var r={code:i.code,amount:0};e.get("flower:get:init")(r),t.nativeCall("flower:get:init",r),i.data=member.dealMemberAvatar(i.data),o.isMobileSDK()&&2==o.getSDKMode()?window.SDK.broadcast({cmd:"flower:send",args:i.data}):e.get("flower:send")(i.data)}else if(1202===i.code){r={code:i.code,msg:i.msg};t.flowerStop(),e.get("flower:get:init")(r),t.nativeCall("flower:get:init",r)}else if(15e3===i.code){r={code:i.code,leftTime:i.data.left_time};t.flowerDuration=i.data.time_interval,e.get("flower:time:left")(r),t.nativeCall("flower:time:left",r),t.flowerCountdown(i)}}})}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n=i(37),r=i(8)("socket.io-client:url");t.exports=function(t,e){var i=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),r("parse %s",t),i=n(t));i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443"));i.path=i.path||"/";var o=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port,i.href=i.protocol+"://"+o+(e&&e.port===i.port?"":":"+i.port),i}},function(t,e,i){t.exports=function(t){function e(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return n.colors[Math.abs(e)%n.colors.length]}function n(t){let i;function s(...t){if(!s.enabled)return;const e=s,r=Number(new Date),o=r-(i||r);e.diff=o,e.prev=i,e.curr=r,i=r,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(i,r)=>{if("%%"===i)return i;a++;const o=n.formatters[r];if("function"==typeof o){const n=t[a];i=o.call(e,n),t.splice(a,1),a--}return i}),n.formatArgs.call(e,t),(e.log||n.log).apply(e,t)}return s.namespace=t,s.enabled=n.enabled(t),s.useColors=n.useColors(),s.color=e(t),s.destroy=r,s.extend=o,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function r(){const t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}function o(t,e){const i=n(this.namespace+(void 0===e?":":e)+t);return i.log=this.log,i}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},n.disable=function(){const t=[...n.names.map(s),...n.skips.map(s).map(t=>"-"+t)].join(",");return n.enable(""),t},n.enable=function(t){let e;n.save(t),n.names=[],n.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),r=i.length;for(e=0;e<r;e++)i[e]&&("-"===(t=i[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){const t=n.instances[e];t.enabled=n.enabled(t.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;let e,i;for(e=0,i=n.skips.length;e<i;e++)if(n.skips[e].test(t))return!1;for(e=0,i=n.names.length;e<i;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=i(82),Object.keys(t).forEach(e=>{n[e]=t[e]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=e,n.enable(n.load()),n}},function(t,e){var i=1e3,n=60*i,r=60*n,o=24*r,s=7*o,a=365.25*o;function l(t,e,i,n){var r=e>=1.5*i;return Math.round(t/i)+" "+n+(r?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var l=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*a;case"weeks":case"week":case"w":return l*s;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*n;case"seconds":case"second":case"secs":case"sec":case"s":return l*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=o)return l(t,e,o,"day");if(e>=r)return l(t,e,r,"hour");if(e>=n)return l(t,e,n,"minute");if(e>=i)return l(t,e,i,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=o)return Math.round(t/o)+"d";if(e>=r)return Math.round(t/r)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){(function(n){function r(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}(e=t.exports=i(84)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),!i)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))})),t.splice(o,0,n)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=r,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(r())}).call(this,i(21))},function(t,e,i){function n(t){var i;function n(){if(n.enabled){var t=n,r=+new Date,o=r-(i||r);t.diff=o,t.prev=i,t.curr=r,i=r;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(i,n){if("%%"===i)return i;l++;var r=e.formatters[n];if("function"==typeof r){var o=s[l];i=r.call(t,o),s.splice(l,1),l--}return i})),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),n.destroy=r,"function"==typeof e.init&&e.init(n),e.instances.push(n),n}function r(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var o=e.instances[i];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(85),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var i=1e3,n=60*i,r=60*n,o=24*r,s=365.25*o;function a(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}t.exports=function(t,e){e=e||{};var l,c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===c&&!1===isNaN(t))return e.long?a(l=t,o,"day")||a(l,r,"hour")||a(l,n,"minute")||a(l,i,"second")||l+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=r)return Math.round(t/r)+"h";if(t>=n)return Math.round(t/n)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){var n=i(23),r=i(38),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.deconstructPacket=function(t){var e=[],i=t.data,o=t;return o.data=function t(e,i){if(!e)return e;if(r(e)){var o={_placeholder:!0,num:i.length};return i.push(e),o}if(n(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a],i);return s}if("object"==typeof e&&!(e instanceof Date)){s={};for(var l in e)s[l]=t(e[l],i);return s}return e}(i,e),o.attachments=e.length,{packet:o,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,i){if(!e)return e;if(e&&e._placeholder)return i[e.num];if(n(e))for(var r=0;r<e.length;r++)e[r]=t(e[r],i);else if("object"==typeof e)for(var o in e)e[o]=t(e[o],i);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var i=0,o=t;!function t(l,c,u){if(!l)return l;if(s&&l instanceof Blob||a&&l instanceof File){i++;var h=new FileReader;h.onload=function(){u?u[c]=this.result:o=this.result,--i||e(o)},h.readAsArrayBuffer(l)}else if(n(l))for(var f=0;f<l.length;f++)t(l[f],f,l);else if("object"==typeof l&&!r(l))for(var d in l)t(l[d],d,l)}(o),i||e(o)}},function(t,e,i){"use strict";e.byteLength=function(t){var e=c(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,n=c(t),s=n[0],a=n[1],l=new o(function(t,e,i){return 3*(e+i)/4-i}(0,s,a)),u=0,h=a>0?s-4:s;for(i=0;i<h;i+=4)e=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;2===a&&(e=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,l[u++]=255&e);1===a&&(e=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e);return l},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o=[],s=0,a=i-r;s<a;s+=16383)o.push(u(t,s,s+16383>a?a:s+16383));1===r?(e=t[i-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)n[a]=s[a],r[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function u(t,e,i){for(var r,o,s=[],a=e;a<i;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?r-1:0,f=i?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-u)-1,d>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+t[e+h],h+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=c}return(d?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var s,a,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[i+d]=255&a,d+=p,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;t[i+d]=255&s,d+=p,s/=256,c-=8);t[i+d-p]|=128*g}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){t.exports=i(91),t.exports.parser=i(12)},function(t,e,i){var n=i(40),r=i(11),o=i(8)("engine.io-client:socket"),s=i(44),a=i(12),l=i(37),c=i(17);function u(t,e){if(!(this instanceof u))return new u(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=l(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=l(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=u,u.priorWebsocketSuccess=!1,r(u.prototype),u.protocol=a.protocol,u.Socket=u,u.Transport=i(26),u.transports=i(40),u.parser=i(12),u.prototype.createTransport=function(t){o('creating transport "%s"',t);var e=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var i=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new n[t]({query:e,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,withCredentials:i.withCredentials||this.withCredentials,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0,isReactNative:this.isReactNative})},u.prototype.open=function(){var t;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},u.prototype.setTransport=function(t){o("setting transport %s",t.name);var e=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},u.prototype.probe=function(t){o('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),i=!1,n=this;function r(){if(n.onlyBinaryUpgrades){var r=!this.supportsBinary&&n.transport.supportsBinary;i=i||r}i||(o('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(r){if(!i)if("pong"===r.type&&"probe"===r.data){if(o('probe transport "%s" pong',t),n.upgrading=!0,n.emit("upgrading",e),!e)return;u.priorWebsocketSuccess="websocket"===e.name,o('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){i||"closed"!==n.readyState&&(o("changing transport and sending upgrade packet"),f(),n.setTransport(e),e.send([{type:"upgrade"}]),n.emit("upgrade",e),e=null,n.upgrading=!1,n.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=e.name,n.emit("upgradeError",s)}})))}function s(){i||(i=!0,f(),e.close(),e=null)}function a(i){var r=new Error("probe error: "+i);r.transport=e.name,s(),o('probe transport "%s" failed because of error: %s',t,i),n.emit("upgradeError",r)}function l(){a("transport closed")}function c(){a("socket closed")}function h(t){e&&t.name!==e.name&&(o('"%s" works - aborting "%s"',t.name,e.name),s())}function f(){e.removeListener("open",r),e.removeListener("error",a),e.removeListener("close",l),n.removeListener("close",c),n.removeListener("upgrading",h)}u.priorWebsocketSuccess=!1,e.once("open",r),e.once("error",a),e.once("close",l),this.once("close",c),this.once("upgrading",h),e.open()},u.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},u.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},u.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},u.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},u.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var r={type:t,data:e,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():e()})):this.upgrading?n():e()}function e(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function i(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),e()}function n(){t.once("upgrade",i),t.once("upgradeError",i)}return this},u.prototype.onError=function(t){o("socket error %j",t),u.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},u.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},u.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~s(this.transports,t[i])&&e.push(t[i]);return e}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,i){var n=i(25),r=i(41),o=i(11),s=i(18),a=i(8)("engine.io-client:polling-xhr");function l(){}function c(t){if(r.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,i=location.port;i||(i=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==e}}function u(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(t.exports=c,t.exports.Request=u,s(c,r),c.prototype.supportsBinary=!0,c.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new u(t)},c.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:i}),r=this;n.on("success",e),n.on("error",(function(t){r.onError("xhr post error",t)})),this.sendXhr=n},c.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},o(u.prototype),u.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new n(t),i=this;try{a("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&e.setRequestHeader(r,this.extraHeaders[r])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){i.onLoad()},e.onerror=function(){i.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(i.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?i.onLoad():setTimeout((function(){i.onError("number"==typeof e.status?e.status:0)}),0))},a("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){i.onError(t)}),0)}"undefined"!=typeof document&&(this.index=u.requestsCount++,u.requests[this.index]=this)},u.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},u.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},u.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},u.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete u.requests[this.index],this.xhr=null}},u.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t=("application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},u.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},u.prototype.abort=function(){this.cleanup()},u.requestsCount=0,u.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,f,!1)}function f(){for(var t in u.requests)u.requests.hasOwnProperty(t)&&u.requests[t].abort()}},function(t,e){t.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},function(t,e){t.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-e),s=e,a=0;s<i;s++,a++)o[a]=r[s];return o.buffer}},function(t,e){function i(){}t.exports=function(t,e,n){var r=!1;return n=n||i,o.count=t,0===t?e():o;function o(t,i){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(r=!0,e(t),e=n):0!==o.count||r||e(null,i)}}},function(t,e){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var i,n,r,o=String.fromCharCode;function s(t){for(var e,i,n=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function a(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(t,e){return o(t>>e&63|128)}function c(t,e){if(0==(4294967168&t))return o(t);var i="";return 0==(4294965248&t)?i=o(t>>6&31|192):0==(4294901760&t)?(a(t,e)||(t=65533),i=o(t>>12&15|224),i+=l(t,6)):0==(4292870144&t)&&(i=o(t>>18&7|240),i+=l(t,12),i+=l(t,6)),i+=o(63&t|128)}function u(){if(r>=n)throw Error("Invalid byte index");var t=255&i[r];if(r++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(t){var e,o;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(e=255&i[r],r++,0==(128&e))return e;if(192==(224&e)){if((o=(31&e)<<6|u())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&e)){if((o=(15&e)<<12|u()<<6|u())>=2048)return a(o,t)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(o=(7&e)<<18|u()<<12|u()<<6|u())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,e){for(var i=!1!==(e=e||{}).strict,n=s(t),r=n.length,o=-1,a="";++o<r;)a+=c(n[o],i);return a},decode:function(t,e){var a=!1!==(e=e||{}).strict;i=s(t),n=i.length,r=0;for(var l,c=[];!1!==(l=h(a));)c.push(l);return function(t){for(var e,i=t.length,n=-1,r="";++n<i;)(e=t[n])>65535&&(r+=o((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+=o(e);return r}(c)}}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),n=0;n<t.length;n++)i[t.charCodeAt(n)]=n;e.encode=function(e){var i,n=new Uint8Array(e),r=n.length,o="";for(i=0;i<r;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,n,r,o,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(e=0;e<l;e+=4)n=i[t.charCodeAt(e)],r=i[t.charCodeAt(e+1)],o=i[t.charCodeAt(e+2)],s=i[t.charCodeAt(e+3)],h[c++]=n<<2|r>>4,h[c++]=(15&r)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return u}}()},function(t,e){var i=void 0!==i?i:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),r=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;function s(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var i=new Uint8Array(t.byteLength);i.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=i.buffer}return e}return t}))}function a(t,e){e=e||{};var n=new i;return s(t).forEach((function(t){n.append(t)})),e.type?n.getBlob(e.type):n.getBlob()}function l(t,e){return new Blob(s(t),e||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,l.prototype=Blob.prototype),t.exports=n?r?Blob:l:o?a:void 0},function(t,e,i){(function(e){var n=i(41),r=i(18);t.exports=u;var o,s=/\n/g,a=/\\n/g;function l(){}function c(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}}function u(t){if(n.call(this,t),this.query=this.query||{},!o){var e=c();o=e.___eio=e.___eio||[]}this.index=o.length;var i=this;o.push((function(t){i.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){i.script&&(i.script.onerror=l)}),!1)}r(u,n),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},u.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},u.prototype.doWrite=function(t,e){var i=this;if(!this.form){var n,r=document.createElement("form"),o=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=l,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o}function c(){u(),e()}function u(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(t){i.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';n=document.createElement(t)}catch(t){(n=document.createElement("iframe")).name=i.iframeId,n.src="javascript:0"}n.id=i.iframeId,i.form.appendChild(n),i.iframe=n}this.form.action=this.uri(),u(),t=t.replace(a,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,i(24))},function(t,e,i){(function(e){var n,r,o=i(26),s=i(12),a=i(17),l=i(18),c=i(43),u=i(8)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{r=i(102)}catch(t){}var h=n||r;function f(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=n&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(h=r),o.call(this,t)}t.exports=f,l(f,o),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new h(t,e):new h(t):new h(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},f.prototype.write=function(t){var i=this;this.writable=!1;for(var n=t.length,r=0,o=n;r<o;r++)!function(t){s.encodePacket(t,i.supportsBinary,(function(r){if(!i.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),i.perMessageDeflate)("string"==typeof r?e.byteLength(r):r.length)<i.perMessageDeflate.threshold&&(o.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(r):i.ws.send(r,o)}catch(t){u("websocket closed before onclose event")}--n||a()}))}(t[r]);function a(){i.emit("flush"),setTimeout((function(){i.writable=!0,i.emit("drain")}),0)}},f.prototype.onClose=function(){o.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},f.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===f.prototype.name)}}).call(this,i(16).Buffer)},function(t,e){},function(t,e){t.exports=function(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},function(t,e,i){"use strict";var n=i(106),r=i(9),o=i(50),s=i(27),a=i(51),l=Object.prototype.toString,c=0,u=-1,h=0,f=8;function d(t){if(!(this instanceof d))return new d(t);this.options=r.assign({level:u,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(s[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var p;if(p="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=n.deflateSetDictionary(this.strm,p))!==c)throw new Error(s[i]);this._dict_set=!0}}function p(t,e){var i=new d(e);if(i.push(t,!0),i.err)throw i.msg||s[i.err];return i.result}d.prototype.push=function(t,e){var i,s,a=this.strm,u=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?a.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new r.Buf8(u),a.next_out=0,a.avail_out=u),1!==(i=n.deflate(a,s))&&i!==c)return this.onEnd(i),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(a.output,a.next_out))):this.onData(r.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==i);return 4===s?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==s||(this.onEnd(c),a.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=d,e.deflate=p,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,p(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,p(t,e)}},function(t,e,i){"use strict";var n,r=i(9),o=i(107),s=i(48),a=i(49),l=i(27),c=0,u=1,h=3,f=4,d=5,p=0,g=1,m=-2,v=-3,y=-5,_=-1,b=1,w=2,x=3,C=4,T=0,S=2,k=8,O=9,j=15,E=8,A=286,P=30,D=19,M=2*A+1,I=15,R=3,F=258,L=F+R+1,B=32,N=42,U=69,H=73,z=91,V=103,W=113,X=666,Y=1,G=2,q=3,K=4,J=3;function Z(t,e){return t.msg=l[e],e}function Q(t){return(t<<1)-(t>4?9:0)}function $(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function et(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function it(t,e){t.pending_buf[t.pending++]=e}function nt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e){var i,n,r=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match,l=t.strstart>t.w_size-L?t.strstart-(t.w_size-L):0,c=t.window,u=t.w_mask,h=t.prev,f=t.strstart+F,d=c[o+s-1],p=c[o+s];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(c[(i=e)+s]===p&&c[i+s-1]===d&&c[i]===c[o]&&c[++i]===c[o+1]){o+=2,i++;do{}while(c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&o<f);if(n=F-(f-o),o=f-F,n>s){if(t.match_start=e,s=n,n>=a)break;d=c[o+s-1],p=c[o+s]}}}while((e=h[e&u])>l&&0!=--r);return s<=t.lookahead?s:t.lookahead}function ot(t){var e,i,n,o,l,c,u,h,f,d,p=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-L)){r.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=p?n-p:0}while(--i);e=i=p;do{n=t.prev[--e],t.prev[e]=n>=p?n-p:0}while(--i);o+=p}if(0===t.strm.avail_in)break;if(c=t.strm,u=t.window,h=t.strstart+t.lookahead,f=o,d=void 0,(d=c.avail_in)>f&&(d=f),i=0===d?0:(c.avail_in-=d,r.arraySet(u,c.input,c.next_in,d,h),1===c.state.wrap?c.adler=s(c.adler,u,d,h):2===c.state.wrap&&(c.adler=a(c.adler,u,d,h)),c.next_in+=d,c.total_in+=d,d),t.lookahead+=i,t.lookahead+t.insert>=R)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+R-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<R)););}while(t.lookahead<L&&0!==t.strm.avail_in)}function st(t,e){for(var i,n;;){if(t.lookahead<L){if(ot(t),t.lookahead<L&&e===c)return Y;if(0===t.lookahead)break}if(i=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-L&&(t.match_length=rt(t,i)),t.match_length>=R)if(n=o._tr_tally(t,t.strstart-t.match_start,t.match_length-R),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=R){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=t.strstart<R-1?t.strstart:R-1,e===f?(et(t,!0),0===t.strm.avail_out?q:K):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:G}function at(t,e){for(var i,n,r;;){if(t.lookahead<L){if(ot(t),t.lookahead<L&&e===c)return Y;if(0===t.lookahead)break}if(i=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=R-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-L&&(t.match_length=rt(t,i),t.match_length<=5&&(t.strategy===b||t.match_length===R&&t.strstart-t.match_start>4096)&&(t.match_length=R-1)),t.prev_length>=R&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-R,n=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-R),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=R-1,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return Y}else if(t.match_available){if((n=o._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Y}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<R-1?t.strstart:R-1,e===f?(et(t,!0),0===t.strm.avail_out?q:K):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:G}function lt(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function ct(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*M),this.dyn_dtree=new r.Buf16(2*(2*P+1)),this.bl_tree=new r.Buf16(2*(2*D+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(I+1),this.heap=new r.Buf16(2*A+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*A+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ut(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=S,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?N:W,t.adler=2===e.wrap?0:1,e.last_flush=c,o._tr_init(e),p):Z(t,m)}function ht(t){var e,i=ut(t);return i===p&&((e=t.state).window_size=2*e.w_size,$(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=R-1,e.match_available=0,e.ins_h=0),i}function ft(t,e,i,n,o,s){if(!t)return m;var a=1;if(e===_&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),o<1||o>O||i!==k||n<8||n>15||e<0||e>9||s<0||s>C)return Z(t,m);8===n&&(n=9);var l=new ct;return t.state=l,l.strm=t,l.wrap=a,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+R-1)/R),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=i,ht(t)}n=[new lt(0,0,0,0,(function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ot(t),0===t.lookahead&&e===c)return Y;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,et(t,!1),0===t.strm.avail_out))return Y;if(t.strstart-t.block_start>=t.w_size-L&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?q:K):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),Y)})),new lt(4,4,8,4,st),new lt(4,5,16,8,st),new lt(4,6,32,32,st),new lt(4,4,16,16,at),new lt(8,16,32,32,at),new lt(8,16,128,128,at),new lt(8,32,128,256,at),new lt(32,128,258,1024,at),new lt(32,258,258,4096,at)],e.deflateInit=function(t,e){return ft(t,e,k,j,E,T)},e.deflateInit2=ft,e.deflateReset=ht,e.deflateResetKeep=ut,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?m:(t.state.gzhead=e,p):m},e.deflate=function(t,e){var i,r,s,l;if(!t||!t.state||e>d||e<0)return t?Z(t,m):m;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===X&&e!==f)return Z(t,0===t.avail_out?y:m);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===N)if(2===r.wrap)t.adler=0,it(r,31),it(r,139),it(r,8),r.gzhead?(it(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),it(r,255&r.gzhead.time),it(r,r.gzhead.time>>8&255),it(r,r.gzhead.time>>16&255),it(r,r.gzhead.time>>24&255),it(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),it(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(it(r,255&r.gzhead.extra.length),it(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=a(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=U):(it(r,0),it(r,0),it(r,0),it(r,0),it(r,0),it(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),it(r,J),r.status=W);else{var v=k+(r.w_bits-8<<4)<<8;v|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(v|=B),v+=31-v%31,r.status=W,nt(r,v),0!==r.strstart&&(nt(r,t.adler>>>16),nt(r,65535&t.adler)),t.adler=1}if(r.status===U)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending!==r.pending_buf_size));)it(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=H)}else r.status=H;if(r.status===H)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,it(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),0===l&&(r.gzindex=0,r.status=z)}else r.status=z;if(r.status===z)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,it(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),0===l&&(r.status=V)}else r.status=V;if(r.status===V&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&tt(t),r.pending+2<=r.pending_buf_size&&(it(r,255&t.adler),it(r,t.adler>>8&255),t.adler=0,r.status=W)):r.status=W),0!==r.pending){if(tt(t),0===t.avail_out)return r.last_flush=-1,p}else if(0===t.avail_in&&Q(e)<=Q(i)&&e!==f)return Z(t,y);if(r.status===X&&0!==t.avail_in)return Z(t,y);if(0!==t.avail_in||0!==r.lookahead||e!==c&&r.status!==X){var _=r.strategy===w?function(t,e){for(var i;;){if(0===t.lookahead&&(ot(t),0===t.lookahead)){if(e===c)return Y;break}if(t.match_length=0,i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?q:K):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:G}(r,e):r.strategy===x?function(t,e){for(var i,n,r,s,a=t.window;;){if(t.lookahead<=F){if(ot(t),t.lookahead<=F&&e===c)return Y;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=R&&t.strstart>0&&(n=a[r=t.strstart-1])===a[++r]&&n===a[++r]&&n===a[++r]){s=t.strstart+F;do{}while(n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&r<s);t.match_length=F-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=R?(i=o._tr_tally(t,1,t.match_length-R),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?q:K):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:G}(r,e):n[r.level].func(r,e);if(_!==q&&_!==K||(r.status=X),_===Y||_===q)return 0===t.avail_out&&(r.last_flush=-1),p;if(_===G&&(e===u?o._tr_align(r):e!==d&&(o._tr_stored_block(r,0,0,!1),e===h&&($(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),tt(t),0===t.avail_out))return r.last_flush=-1,p}return e!==f?p:r.wrap<=0?g:(2===r.wrap?(it(r,255&t.adler),it(r,t.adler>>8&255),it(r,t.adler>>16&255),it(r,t.adler>>24&255),it(r,255&t.total_in),it(r,t.total_in>>8&255),it(r,t.total_in>>16&255),it(r,t.total_in>>24&255)):(nt(r,t.adler>>>16),nt(r,65535&t.adler)),tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:g)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==N&&e!==U&&e!==H&&e!==z&&e!==V&&e!==W&&e!==X?Z(t,m):(t.state=null,e===W?Z(t,v):p):m},e.deflateSetDictionary=function(t,e){var i,n,o,a,l,c,u,h,f=e.length;if(!t||!t.state)return m;if(2===(a=(i=t.state).wrap)||1===a&&i.status!==N||i.lookahead)return m;for(1===a&&(t.adler=s(t.adler,e,f,0)),i.wrap=0,f>=i.w_size&&(0===a&&($(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new r.Buf8(i.w_size),r.arraySet(h,e,f-i.w_size,i.w_size,0),e=h,f=i.w_size),l=t.avail_in,c=t.next_in,u=t.input,t.avail_in=f,t.next_in=0,t.input=e,ot(i);i.lookahead>=R;){n=i.strstart,o=i.lookahead-(R-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+R-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--o);i.strstart=n,i.lookahead=R-1,ot(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=R-1,i.match_available=0,t.next_in=c,t.input=u,t.avail_in=l,i.wrap=a,p},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";var n=i(9),r=4,o=0,s=1,a=2;function l(t){for(var e=t.length;--e>=0;)t[e]=0}var c=0,u=1,h=2,f=29,d=256,p=d+1+f,g=30,m=19,v=2*p+1,y=15,_=16,b=7,w=256,x=16,C=17,T=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=new Array(2*(p+2));l(E);var A=new Array(2*g);l(A);var P=new Array(512);l(P);var D=new Array(256);l(D);var M=new Array(f);l(M);var I,R,F,L=new Array(g);function B(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function N(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function U(t){return t<256?P[t]:P[256+(t>>>7)]}function H(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function z(t,e,i){t.bi_valid>_-i?(t.bi_buf|=e<<t.bi_valid&65535,H(t,t.bi_buf),t.bi_buf=e>>_-t.bi_valid,t.bi_valid+=i-_):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function V(t,e,i){z(t,i[2*e],i[2*e+1])}function W(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function X(t,e,i){var n,r,o=new Array(y+1),s=0;for(n=1;n<=y;n++)o[n]=s=s+i[n-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=W(o[a]++,a))}}function Y(t){var e;for(e=0;e<p;e++)t.dyn_ltree[2*e]=0;for(e=0;e<g;e++)t.dyn_dtree[2*e]=0;for(e=0;e<m;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*w]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function G(t){t.bi_valid>8?H(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function q(t,e,i,n){var r=2*e,o=2*i;return t[r]<t[o]||t[r]===t[o]&&n[e]<=n[i]}function K(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&q(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!q(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function J(t,e,i){var n,r,o,s,a=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*a]<<8|t.pending_buf[t.d_buf+2*a+1],r=t.pending_buf[t.l_buf+a],a++,0===n?V(t,r,e):(V(t,(o=D[r])+d+1,e),0!==(s=S[o])&&z(t,r-=M[o],s),V(t,o=U(--n),i),0!==(s=k[o])&&z(t,n-=L[o],s))}while(a<t.last_lit);V(t,w,e)}function Z(t,e){var i,n,r,o=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=v,i=0;i<l;i++)0!==o[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):o[2*i+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,a&&(t.static_len-=s[2*r+1]);for(e.max_code=c,i=t.heap_len>>1;i>=1;i--)K(t,o,i);r=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],K(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,o[2*r]=o[2*i]+o[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,o[2*i+1]=o[2*n+1]=r,t.heap[1]=r++,K(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,o,s,a,l=e.dyn_tree,c=e.max_code,u=e.stat_desc.static_tree,h=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(o=0;o<=y;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<v;i++)(o=l[2*l[2*(n=t.heap[i])+1]+1]+1)>p&&(o=p,g++),l[2*n+1]=o,n>c||(t.bl_count[o]++,s=0,n>=d&&(s=f[n-d]),a=l[2*n],t.opt_len+=a*(o+s),h&&(t.static_len+=a*(u[2*n+1]+s)));if(0!==g){do{for(o=p-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(n=t.bl_count[o];0!==n;)(r=t.heap[--i])>c||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),n--)}}(t,e),X(o,c,t.bl_count)}function Q(t,e,i){var n,r,o=-1,s=e[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=s,s=e[2*(n+1)+1],++a<l&&r===s||(a<c?t.bl_tree[2*r]+=a:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*x]++):a<=10?t.bl_tree[2*C]++:t.bl_tree[2*T]++,a=0,o=r,0===s?(l=138,c=3):r===s?(l=6,c=3):(l=7,c=4))}function $(t,e,i){var n,r,o=-1,s=e[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),n=0;n<=i;n++)if(r=s,s=e[2*(n+1)+1],!(++a<l&&r===s)){if(a<c)do{V(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(V(t,r,t.bl_tree),a--),V(t,x,t.bl_tree),z(t,a-3,2)):a<=10?(V(t,C,t.bl_tree),z(t,a-3,3)):(V(t,T,t.bl_tree),z(t,a-11,7));a=0,o=r,0===s?(l=138,c=3):r===s?(l=6,c=3):(l=7,c=4)}}l(L);var tt=!1;function et(t,e,i,r){z(t,(c<<1)+(r?1:0),3),function(t,e,i,r){G(t),r&&(H(t,i),H(t,~i)),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i,!0)}e._tr_init=function(t){tt||(!function(){var t,e,i,n,r,o=new Array(y+1);for(i=0,n=0;n<f-1;n++)for(M[n]=i,t=0;t<1<<S[n];t++)D[i++]=n;for(D[i-1]=n,r=0,n=0;n<16;n++)for(L[n]=r,t=0;t<1<<k[n];t++)P[r++]=n;for(r>>=7;n<g;n++)for(L[n]=r<<7,t=0;t<1<<k[n]-7;t++)P[256+r++]=n;for(e=0;e<=y;e++)o[e]=0;for(t=0;t<=143;)E[2*t+1]=8,t++,o[8]++;for(;t<=255;)E[2*t+1]=9,t++,o[9]++;for(;t<=279;)E[2*t+1]=7,t++,o[7]++;for(;t<=287;)E[2*t+1]=8,t++,o[8]++;for(X(E,p+1,o),t=0;t<g;t++)A[2*t+1]=5,A[2*t]=W(t,5);I=new B(E,S,d+1,p,y),R=new B(A,k,0,g,y),F=new B(new Array(0),O,0,m,b)}(),tt=!0),t.l_desc=new N(t.dyn_ltree,I),t.d_desc=new N(t.dyn_dtree,R),t.bl_desc=new N(t.bl_tree,F),t.bi_buf=0,t.bi_valid=0,Y(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,i,n){var l,c,f=0;t.level>0?(t.strm.data_type===a&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<d;e++)if(0!==t.dyn_ltree[2*e])return s;return o}(t)),Z(t,t.l_desc),Z(t,t.d_desc),f=function(t){var e;for(Q(t,t.dyn_ltree,t.l_desc.max_code),Q(t,t.dyn_dtree,t.d_desc.max_code),Z(t,t.bl_desc),e=m-1;e>=3&&0===t.bl_tree[2*j[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),l=t.opt_len+3+7>>>3,(c=t.static_len+3+7>>>3)<=l&&(l=c)):l=c=i+5,i+4<=l&&-1!==e?et(t,e,i,n):t.strategy===r||c===l?(z(t,(u<<1)+(n?1:0),3),J(t,E,A)):(z(t,(h<<1)+(n?1:0),3),function(t,e,i,n){var r;for(z(t,e-257,5),z(t,i-1,5),z(t,n-4,4),r=0;r<n;r++)z(t,t.bl_tree[2*j[r]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,f+1),J(t,t.dyn_ltree,t.dyn_dtree)),Y(t),n&&G(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(D[i]+d+1)]++,t.dyn_dtree[2*U(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){z(t,u<<1,3),V(t,w,E),function(t){16===t.bi_valid?(H(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){"use strict";var n=i(109),r=i(9),o=i(50),s=i(52),a=i(27),l=i(51),c=i(112),u=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==s.Z_OK)throw new Error(a[i]);if(this.header=new c,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=o.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=n.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(a[i])}function f(t,e){var i=new h(e);if(i.push(t,!0),i.err)throw i.msg||a[i.err];return i.result}h.prototype.push=function(t,e){var i,a,l,c,h,f=this.strm,d=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?f.input=o.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(d),f.next_out=0,f.avail_out=d),(i=n.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(i=n.inflateSetDictionary(this.strm,p)),i===s.Z_BUF_ERROR&&!0===g&&(i=s.Z_OK,g=!1),i!==s.Z_STREAM_END&&i!==s.Z_OK)return this.onEnd(i),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&i!==s.Z_STREAM_END&&(0!==f.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,h=o.buf2string(f.output,l),f.next_out=c,f.avail_out=d-c,c&&r.arraySet(f.output,f.output,l,c,0),this.onData(h)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((f.avail_in>0||0===f.avail_out)&&i!==s.Z_STREAM_END);return i===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),f.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=h,e.inflate=f,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},e.ungzip=f},function(t,e,i){"use strict";var n=i(9),r=i(48),o=i(49),s=i(110),a=i(111),l=0,c=1,u=2,h=4,f=5,d=6,p=0,g=1,m=2,v=-2,y=-3,_=-4,b=-5,w=8,x=1,C=2,T=3,S=4,k=5,O=6,j=7,E=8,A=9,P=10,D=11,M=12,I=13,R=14,F=15,L=16,B=17,N=18,U=19,H=20,z=21,V=22,W=23,X=24,Y=25,G=26,q=27,K=28,J=29,Z=30,Q=31,$=32,tt=852,et=592,it=15;function nt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ot(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=x,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(tt),e.distcode=e.distdyn=new n.Buf32(et),e.sane=1,e.back=-1,p):v}function st(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,ot(t)):v}function at(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?v:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,st(t))):v}function lt(t,e){var i,n;return t?(n=new rt,t.state=n,n.window=null,(i=at(t,e))!==p&&(t.state=null),i):v}var ct,ut,ht=!0;function ft(t){if(ht){var e;for(ct=new n.Buf32(512),ut=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(c,t.lens,0,288,ct,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(u,t.lens,0,32,ut,0,t.work,{bits:5}),ht=!1}t.lencode=ct,t.lenbits=9,t.distcode=ut,t.distbits=5}function dt(t,e,i,r){var o,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),r>=s.wsize?(n.arraySet(s.window,e,i-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>r&&(o=r),n.arraySet(s.window,e,i-r,o,s.wnext),(r-=o)?(n.arraySet(s.window,e,i-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}e.inflateReset=st,e.inflateReset2=at,e.inflateResetKeep=ot,e.inflateInit=function(t){return lt(t,it)},e.inflateInit2=lt,e.inflate=function(t,e){var i,tt,et,it,rt,ot,st,at,lt,ct,ut,ht,pt,gt,mt,vt,yt,_t,bt,wt,xt,Ct,Tt,St,kt=0,Ot=new n.Buf8(4),jt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return v;(i=t.state).mode===M&&(i.mode=I),rt=t.next_out,et=t.output,st=t.avail_out,it=t.next_in,tt=t.input,ot=t.avail_in,at=i.hold,lt=i.bits,ct=ot,ut=st,Ct=p;t:for(;;)switch(i.mode){case x:if(0===i.wrap){i.mode=I;break}for(;lt<16;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(2&i.wrap&&35615===at){i.check=0,Ot[0]=255&at,Ot[1]=at>>>8&255,i.check=o(i.check,Ot,2,0),at=0,lt=0,i.mode=C;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&at)<<8)+(at>>8))%31){t.msg="incorrect header check",i.mode=Z;break}if((15&at)!==w){t.msg="unknown compression method",i.mode=Z;break}if(lt-=4,xt=8+(15&(at>>>=4)),0===i.wbits)i.wbits=xt;else if(xt>i.wbits){t.msg="invalid window size",i.mode=Z;break}i.dmax=1<<xt,t.adler=i.check=1,i.mode=512&at?P:M,at=0,lt=0;break;case C:for(;lt<16;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(i.flags=at,(255&i.flags)!==w){t.msg="unknown compression method",i.mode=Z;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Z;break}i.head&&(i.head.text=at>>8&1),512&i.flags&&(Ot[0]=255&at,Ot[1]=at>>>8&255,i.check=o(i.check,Ot,2,0)),at=0,lt=0,i.mode=T;case T:for(;lt<32;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.head&&(i.head.time=at),512&i.flags&&(Ot[0]=255&at,Ot[1]=at>>>8&255,Ot[2]=at>>>16&255,Ot[3]=at>>>24&255,i.check=o(i.check,Ot,4,0)),at=0,lt=0,i.mode=S;case S:for(;lt<16;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.head&&(i.head.xflags=255&at,i.head.os=at>>8),512&i.flags&&(Ot[0]=255&at,Ot[1]=at>>>8&255,i.check=o(i.check,Ot,2,0)),at=0,lt=0,i.mode=k;case k:if(1024&i.flags){for(;lt<16;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.length=at,i.head&&(i.head.extra_len=at),512&i.flags&&(Ot[0]=255&at,Ot[1]=at>>>8&255,i.check=o(i.check,Ot,2,0)),at=0,lt=0}else i.head&&(i.head.extra=null);i.mode=O;case O:if(1024&i.flags&&((ht=i.length)>ot&&(ht=ot),ht&&(i.head&&(xt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,tt,it,ht,xt)),512&i.flags&&(i.check=o(i.check,tt,ht,it)),ot-=ht,it+=ht,i.length-=ht),i.length))break t;i.length=0,i.mode=j;case j:if(2048&i.flags){if(0===ot)break t;ht=0;do{xt=tt[it+ht++],i.head&&xt&&i.length<65536&&(i.head.name+=String.fromCharCode(xt))}while(xt&&ht<ot);if(512&i.flags&&(i.check=o(i.check,tt,ht,it)),ot-=ht,it+=ht,xt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=E;case E:if(4096&i.flags){if(0===ot)break t;ht=0;do{xt=tt[it+ht++],i.head&&xt&&i.length<65536&&(i.head.comment+=String.fromCharCode(xt))}while(xt&&ht<ot);if(512&i.flags&&(i.check=o(i.check,tt,ht,it)),ot-=ht,it+=ht,xt)break t}else i.head&&(i.head.comment=null);i.mode=A;case A:if(512&i.flags){for(;lt<16;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(at!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Z;break}at=0,lt=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=M;break;case P:for(;lt<32;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}t.adler=i.check=nt(at),at=0,lt=0,i.mode=D;case D:if(0===i.havedict)return t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=ot,i.hold=at,i.bits=lt,m;t.adler=i.check=1,i.mode=M;case M:if(e===f||e===d)break t;case I:if(i.last){at>>>=7&lt,lt-=7&lt,i.mode=q;break}for(;lt<3;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}switch(i.last=1&at,lt-=1,3&(at>>>=1)){case 0:i.mode=R;break;case 1:if(ft(i),i.mode=H,e===d){at>>>=2,lt-=2;break t}break;case 2:i.mode=B;break;case 3:t.msg="invalid block type",i.mode=Z}at>>>=2,lt-=2;break;case R:for(at>>>=7&lt,lt-=7&lt;lt<32;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if((65535&at)!=(at>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Z;break}if(i.length=65535&at,at=0,lt=0,i.mode=F,e===d)break t;case F:i.mode=L;case L:if(ht=i.length){if(ht>ot&&(ht=ot),ht>st&&(ht=st),0===ht)break t;n.arraySet(et,tt,it,ht,rt),ot-=ht,it+=ht,st-=ht,rt+=ht,i.length-=ht;break}i.mode=M;break;case B:for(;lt<14;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(i.nlen=257+(31&at),at>>>=5,lt-=5,i.ndist=1+(31&at),at>>>=5,lt-=5,i.ncode=4+(15&at),at>>>=4,lt-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Z;break}i.have=0,i.mode=N;case N:for(;i.have<i.ncode;){for(;lt<3;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.lens[jt[i.have++]]=7&at,at>>>=3,lt-=3}for(;i.have<19;)i.lens[jt[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Tt={bits:i.lenbits},Ct=a(l,i.lens,0,19,i.lencode,0,i.work,Tt),i.lenbits=Tt.bits,Ct){t.msg="invalid code lengths set",i.mode=Z;break}i.have=0,i.mode=U;case U:for(;i.have<i.nlen+i.ndist;){for(;vt=(kt=i.lencode[at&(1<<i.lenbits)-1])>>>16&255,yt=65535&kt,!((mt=kt>>>24)<=lt);){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(yt<16)at>>>=mt,lt-=mt,i.lens[i.have++]=yt;else{if(16===yt){for(St=mt+2;lt<St;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(at>>>=mt,lt-=mt,0===i.have){t.msg="invalid bit length repeat",i.mode=Z;break}xt=i.lens[i.have-1],ht=3+(3&at),at>>>=2,lt-=2}else if(17===yt){for(St=mt+3;lt<St;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}lt-=mt,xt=0,ht=3+(7&(at>>>=mt)),at>>>=3,lt-=3}else{for(St=mt+7;lt<St;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}lt-=mt,xt=0,ht=11+(127&(at>>>=mt)),at>>>=7,lt-=7}if(i.have+ht>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Z;break}for(;ht--;)i.lens[i.have++]=xt}}if(i.mode===Z)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Z;break}if(i.lenbits=9,Tt={bits:i.lenbits},Ct=a(c,i.lens,0,i.nlen,i.lencode,0,i.work,Tt),i.lenbits=Tt.bits,Ct){t.msg="invalid literal/lengths set",i.mode=Z;break}if(i.distbits=6,i.distcode=i.distdyn,Tt={bits:i.distbits},Ct=a(u,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Tt),i.distbits=Tt.bits,Ct){t.msg="invalid distances set",i.mode=Z;break}if(i.mode=H,e===d)break t;case H:i.mode=z;case z:if(ot>=6&&st>=258){t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=ot,i.hold=at,i.bits=lt,s(t,ut),rt=t.next_out,et=t.output,st=t.avail_out,it=t.next_in,tt=t.input,ot=t.avail_in,at=i.hold,lt=i.bits,i.mode===M&&(i.back=-1);break}for(i.back=0;vt=(kt=i.lencode[at&(1<<i.lenbits)-1])>>>16&255,yt=65535&kt,!((mt=kt>>>24)<=lt);){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(vt&&0==(240&vt)){for(_t=mt,bt=vt,wt=yt;vt=(kt=i.lencode[wt+((at&(1<<_t+bt)-1)>>_t)])>>>16&255,yt=65535&kt,!(_t+(mt=kt>>>24)<=lt);){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}at>>>=_t,lt-=_t,i.back+=_t}if(at>>>=mt,lt-=mt,i.back+=mt,i.length=yt,0===vt){i.mode=G;break}if(32&vt){i.back=-1,i.mode=M;break}if(64&vt){t.msg="invalid literal/length code",i.mode=Z;break}i.extra=15&vt,i.mode=V;case V:if(i.extra){for(St=i.extra;lt<St;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.length+=at&(1<<i.extra)-1,at>>>=i.extra,lt-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=W;case W:for(;vt=(kt=i.distcode[at&(1<<i.distbits)-1])>>>16&255,yt=65535&kt,!((mt=kt>>>24)<=lt);){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(0==(240&vt)){for(_t=mt,bt=vt,wt=yt;vt=(kt=i.distcode[wt+((at&(1<<_t+bt)-1)>>_t)])>>>16&255,yt=65535&kt,!(_t+(mt=kt>>>24)<=lt);){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}at>>>=_t,lt-=_t,i.back+=_t}if(at>>>=mt,lt-=mt,i.back+=mt,64&vt){t.msg="invalid distance code",i.mode=Z;break}i.offset=yt,i.extra=15&vt,i.mode=X;case X:if(i.extra){for(St=i.extra;lt<St;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}i.offset+=at&(1<<i.extra)-1,at>>>=i.extra,lt-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Z;break}i.mode=Y;case Y:if(0===st)break t;if(ht=ut-st,i.offset>ht){if((ht=i.offset-ht)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Z;break}ht>i.wnext?(ht-=i.wnext,pt=i.wsize-ht):pt=i.wnext-ht,ht>i.length&&(ht=i.length),gt=i.window}else gt=et,pt=rt-i.offset,ht=i.length;ht>st&&(ht=st),st-=ht,i.length-=ht;do{et[rt++]=gt[pt++]}while(--ht);0===i.length&&(i.mode=z);break;case G:if(0===st)break t;et[rt++]=i.length,st--,i.mode=z;break;case q:if(i.wrap){for(;lt<32;){if(0===ot)break t;ot--,at|=tt[it++]<<lt,lt+=8}if(ut-=st,t.total_out+=ut,i.total+=ut,ut&&(t.adler=i.check=i.flags?o(i.check,et,ut,rt-ut):r(i.check,et,ut,rt-ut)),ut=st,(i.flags?at:nt(at))!==i.check){t.msg="incorrect data check",i.mode=Z;break}at=0,lt=0}i.mode=K;case K:if(i.wrap&&i.flags){for(;lt<32;){if(0===ot)break t;ot--,at+=tt[it++]<<lt,lt+=8}if(at!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Z;break}at=0,lt=0}i.mode=J;case J:Ct=g;break t;case Z:Ct=y;break t;case Q:return _;case $:default:return v}return t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=ot,i.hold=at,i.bits=lt,(i.wsize||ut!==t.avail_out&&i.mode<Z&&(i.mode<q||e!==h))&&dt(t,t.output,t.next_out,ut-t.avail_out)?(i.mode=Q,_):(ct-=t.avail_in,ut-=t.avail_out,t.total_in+=ct,t.total_out+=ut,i.total+=ut,i.wrap&&ut&&(t.adler=i.check=i.flags?o(i.check,et,ut,t.next_out-ut):r(i.check,et,ut,t.next_out-ut)),t.data_type=i.bits+(i.last?64:0)+(i.mode===M?128:0)+(i.mode===H||i.mode===F?256:0),(0===ct&&0===ut||e===h)&&Ct===p&&(Ct=b),Ct)},e.inflateEnd=function(t){if(!t||!t.state)return v;var e=t.state;return e.window&&(e.window=null),t.state=null,p},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?v:(i.head=e,e.done=!1,p):v},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&i.mode!==D?v:i.mode===D&&r(1,e,n,0)!==i.check?y:dt(t,e,n,n)?(i.mode=Q,_):(i.havedict=1,p):v},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,r,o,s,a,l,c,u,h,f,d,p,g,m,v,y,_,b,w,x,C,T,S,k;i=t.state,n=t.next_in,S=t.input,r=n+(t.avail_in-5),o=t.next_out,k=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),l=i.dmax,c=i.wsize,u=i.whave,h=i.wnext,f=i.window,d=i.hold,p=i.bits,g=i.lencode,m=i.distcode,v=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;t:do{p<15&&(d+=S[n++]<<p,p+=8,d+=S[n++]<<p,p+=8),_=g[d&v];e:for(;;){if(d>>>=b=_>>>24,p-=b,0===(b=_>>>16&255))k[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(d&(1<<b)-1)];continue e}if(32&b){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&_,(b&=15)&&(p<b&&(d+=S[n++]<<p,p+=8),w+=d&(1<<b)-1,d>>>=b,p-=b),p<15&&(d+=S[n++]<<p,p+=8,d+=S[n++]<<p,p+=8),_=m[d&y];i:for(;;){if(d>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(x=65535&_,p<(b&=15)&&(d+=S[n++]<<p,(p+=8)<b&&(d+=S[n++]<<p,p+=8)),(x+=d&(1<<b)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(d>>>=b,p-=b,x>(b=o-s)){if((b=x-b)>u&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(C=0,T=f,0===h){if(C+=c-b,b<w){w-=b;do{k[o++]=f[C++]}while(--b);C=o-x,T=k}}else if(h<b){if(C+=c+h-b,(b-=h)<w){w-=b;do{k[o++]=f[C++]}while(--b);if(C=0,h<w){w-=b=h;do{k[o++]=f[C++]}while(--b);C=o-x,T=k}}}else if(C+=h-b,b<w){w-=b;do{k[o++]=f[C++]}while(--b);C=o-x,T=k}for(;w>2;)k[o++]=T[C++],k[o++]=T[C++],k[o++]=T[C++],w-=3;w&&(k[o++]=T[C++],w>1&&(k[o++]=T[C++]))}else{C=o-x;do{k[o++]=k[C++],k[o++]=k[C++],k[o++]=k[C++],w-=3}while(w>2);w&&(k[o++]=k[C++],w>1&&(k[o++]=k[C++]))}break}}break}}while(n<r&&o<a);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<a?a-o+257:257-(o-a),i.hold=d,i.bits=p}},function(t,e,i){"use strict";var n=i(9),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,c,u,h,f){var d,p,g,m,v,y,_,b,w,x=f.bits,C=0,T=0,S=0,k=0,O=0,j=0,E=0,A=0,P=0,D=0,M=null,I=0,R=new n.Buf16(16),F=new n.Buf16(16),L=null,B=0;for(C=0;C<=15;C++)R[C]=0;for(T=0;T<l;T++)R[e[i+T]]++;for(O=x,k=15;k>=1&&0===R[k];k--);if(O>k&&(O=k),0===k)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(S=1;S<k&&0===R[S];S++);for(O<S&&(O=S),A=1,C=1;C<=15;C++)if(A<<=1,(A-=R[C])<0)return-1;if(A>0&&(0===t||1!==k))return-1;for(F[1]=0,C=1;C<15;C++)F[C+1]=F[C]+R[C];for(T=0;T<l;T++)0!==e[i+T]&&(h[F[e[i+T]]++]=T);if(0===t?(M=L=h,y=19):1===t?(M=r,I-=257,L=o,B-=257,y=256):(M=s,L=a,y=-1),D=0,T=0,C=S,v=u,j=O,E=0,g=-1,m=(P=1<<O)-1,1===t&&P>852||2===t&&P>592)return 1;for(;;){_=C-E,h[T]<y?(b=0,w=h[T]):h[T]>y?(b=L[B+h[T]],w=M[I+h[T]]):(b=96,w=0),d=1<<C-E,S=p=1<<j;do{c[v+(D>>E)+(p-=d)]=_<<24|b<<16|w|0}while(0!==p);for(d=1<<C-1;D&d;)d>>=1;if(0!==d?(D&=d-1,D+=d):D=0,T++,0==--R[C]){if(C===k)break;C=e[i+h[T]]}if(C>O&&(D&m)!==g){for(0===E&&(E=O),v+=S,A=1<<(j=C-E);j+E<k&&!((A-=R[j+E])<=0);)j++,A<<=1;if(P+=1<<j,1===t&&P>852||2===t&&P>592)return 1;c[g=D&m]=O<<24|j<<16|v-u|0}}return 0!==D&&(c[v+D]=C-E<<24|64<<16|0),f.bits=O,0}},function(t,e,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,i){var n;void 0===(n=function(t){var e=i(10),n=i(1),r=i(54),o=i(7),s=i(0),a={player:null,playStatus:"stop",videoPlayType:"",durationTimmer:null,currentTime:0,currentDuration:0,bn:0,ba:0,bx:0,waitLastTime:0,desktopVideoDom:null,config:function(t){t.videoPlayType&&(this.videoPlayType=t.videoPlayType)},getPlayer:function(){var t=document.getElementById("mt-desktop-player");return t||(s.debug("create desktop player."),(t=document.createElement("video")).id="mt-desktop-player",t.setAttribute("autoplay","true"),t.setAttribute("autoplay",""),t.setAttribute("webkit-playsinline","webkit-playsinline"),t.setAttribute("playsinline",""),t.setAttribute("x5-playsinline",""),t.removeAttribute("controls"),s.isCompatible()&&(t.setAttribute("x5-video-player-type","h5"),t.style["object-position"]="0 0"),s.isMobile()?(t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.setAttribute("preload","auto")):(t.style.width="100%",t.style.height="100%"),this.desktopVideoDom=t,e.getContainer(e.constant.MODE_DESKTOP).appendChild(t)),t},startDurationTimmer:function(){var t=this;if(!t.durationTimmer)if(s.isMobileSDK())t.durationTimmer=setInterval((function(){}),500);else{var i=this.getPlayer();t.durationTimmer=setInterval((function(){i.currentTime&&(t.currentTime=i.currentTime(),"live"===e.playType&&schedule.setPlayDuration(t.currentTime),t.currentTime>=t.duration&&t.stopDurationTimmer())}),200)}},stopDurationTimmer:function(){this.durationTimmer&&(clearInterval(this.durationTimmer),this.durationTimmer=null)},volume:function(t){s.debug("volume setting..",t),this.player&&this.player.volume(t)},start:function(t){if(t.c){s.debug("desktop start: ===>",t);var i="",a={},l=this,c=this.getPlayer(),u=e.getContainer(e.constant.MODE_DESKTOP).clientWidth||800;"playback"===e.playType?(this.desktopStreamPath=t.c,i=e.getVideoUrl(t.c),a=e.getVideoSource(i),i!==this.videoUrl&&(this.videoUrl=i,l.player&&(l.playStatus="waiting",l.player.src(a)))):"live"===e.playType&&(this.desktopStreamPath=t.stream,i=e.getVideoUrl(t.stream),a=e.getVideoSource(i),l.player&&l.player.src(i),o.setBaseParam({srcUrl:i})),s.debug("start desktop:"+i);var h=["html5","flash"];if("html5"==l.videoPlayType&&(h=["html5","flash"]),s.isMobile()&&(h=["html5"]),window.location.href.indexOf("vjs=flash")>-1?h=["flash","html5"]:window.location.href.indexOf("vjs=html5")>-1&&(h=["html5","flash"]),!l.player){var f=r(c,{techOrder:h,width:u,bigPlayButton:!1,errorDisplay:!1,loadingSpinner:!1,posterImage:!1,textTrackSettings:!1,textTrackDisplay:!1,controlBar:!1,controls:!1,preload:!0,autoplay:!0},(function(){s.debug("desktop player source 播放 ==> "+i)}));if(f.tech_.el_.removeAttribute("controls"),this.h5Player=f.tech_.el_,i&&(f.src(i),"live"===e.playType&&f.load()),l.player=f,window.__desktop__=l.player,"live"===e.playType){var d=null;f.on("loadeddata",(function(){n.get("live:video:loadeddata")()})),f.on("play",(function(){n.get("live:video:playing")(),d&&clearTimeout(d),d=setTimeout((function(){l.reloadDesktop()}),2500)})),f.on("error",(function(){n.get("live:video:error")()})),f.on("pause",(function(){n.get("live:video:pause")()})),f.on("timeupdate",(function(){var t=f.currentTime();d&&t>0&&clearTimeout(d),n.get("live:desktop:timeupdate")(t),n.get("live:camera:timeupdate")(t),l.currentDuration=t,l.setMeidaPlayStatus("playing")}))}else if("playback"===e.playType){f.on("loadeddata",(function(t){if(!l.isChecked)return l.pause(),l.setMeidaPlayStatus("pause"),!1;s.isMobile()&&s.isAndroid()||l.play(),n.get("live:video:loaded")("media"),s.debug("seeking===>"+l.seekDuration),l.seekDuration&&l.seekDuration>0&&(f.currentTime(l.seekDuration),l.seekDuration=0)})),f.on("loadedmetadata",(function(t){e.mediaValidate(this.duration(),(function(t){l.isChecked=!!t})),n.get("live:video:metadata")()})),f.on("play",(function(){l.play(),n.get("live:video:playing")()})),f.on("pause",(function(){l.seekDuration=null,l.setMeidaPlayStatus("pause"),n.get("live:video:pause")()})),f.on("seeking",(function(){l.setMeidaPlayStatus("seeking"),n.get("live:video:seeking")()})),f.on("seeked",(function(){l.setMeidaPlayStatus("seeked"),n.get("live:video:seeked")()}));var p=0;f.on("timeupdate",(function(){var t=f.currentTime();n.get("live:desktop:timeupdate")(t),n.get("live:camera:timeupdate")(t);var e=Math.round((new Date).getTime()/1e3);t<=l.currentDuration?l.setWaitingTimes(e):l.bx>0&&e-p>1&&(l.bx-=1,p=e),l.currentDuration=t,l.setMeidaPlayStatus("playing")})),f.on("waiting",(function(){l.bn+=1,l.ba+=1,n.get("live:video:waiting")(),l.setMeidaPlayStatus("waiting")})),f.on("ended",(function(){l.setMeidaPlayStatus("ended")})),f.on("error",(function(){l.playStatus="error",l.bn+=1,l.ba+=1,e.playStatus=l.playStatus,0==l.changeSource&&(l.changeSource=1),l.setMeidaPlayStatus("error"),n.get("live:video:error")(this)})),f.on("abort",(function(){l.setMeidaPlayStatus("abort"),n.get("live:video:abort")(this)}))}}s.isWechat()?s.detectiveWxJsBridge((function(){s.isIos()?f.play():(f.load(),f.play(),setTimeout((function(){l.pause()}),300))})):setTimeout((function(){l.play()}),500);n.get("live:desktop:start")(l.playStatus)}},setMeidaPlayStatus:function(t){this.playStatus=t,e.playStatus=t},playRate:function(t){if(this.player&&"Flash"!=this.player.techName_)return this.player.playbackRate(t)},changeSource:0,setWaitingTimes:function(t){t-this.waitLastTime>=1&&(this.bn+=1,this.ba+=1,this.bx<15?this.bx+=1:(this.bx=0,this.changeSource=1,n.get("live:video:timeout")(this.bx)),this.waitLastTime=t)},reloadDesktop:function(){if(this.player){e.getVideoSource(this.videoUrl);this.player.src(this.videoUrl),this.player.load(),this.player.play()}},seek:function(t){s.debug("desktop seek:"+t),this.seekDuration=t,this.player&&(this.player.currentTime(t),this.player.play()),this.changeSource=0},fire:function(){this.play(),e.playStatus="playing"},play:function(){s.debug("desktop playing.",this.player),e.elementPlay(this.h5Player,t=>{"error"===t?this.pause():(this.setMeidaPlayStatus("playing"),n.get("live:desktop:play")(),e.vodPlayer.tick())})},pause:function(t){s.debug("desktop pause."),this.player&&this.player.pause(),this.setMeidaPlayStatus("pause"),"playback"===e.playType&&e.vodPlayer.pauseTick(),n.get("live:desktop:pause")()},stop:function(t){s.debug("desktop call stop!"),this.seekDuration=null,this.player&&this.player.pause(),s.isMobileSDK()||n.get("live:desktop:stop")(),this.setMeidaPlayStatus("ended"),this.stopDurationTimmer()},destroy:function(){s.debug("Desktop player destroy."),this.seekDuration=null,this.player&&("live"===e.playType?(this.player.pause(),this.player.off(),this.player.dispose(),this.player=null,this.desktopVideoDom&&this.desktopVideoDom.parentNode.removeChild(this.desktopVideoDom)):(this.player.dispose(),this.player=null))}};return window.desktop=a,a}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n;
/*!    SWFObject v2.3.20130521 <http://github.com/swfobject/swfobject>
    is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/void 0===(n=function(){var t=function(){var e,i,n,r,o,s,a="undefined",l="object",c="Shockwave Flash",u="application/x-shockwave-flash",h="SWFObjectExprInst",f="onreadystatechange",d=window,p=document,g=navigator,m=!1,v=[],y=[],_=[],b=[],w=!1,x=!1,C=!0,T=!1,S=function(){var t=typeof p.getElementById!=a&&typeof p.getElementsByTagName!=a&&typeof p.createElement!=a,e=g.userAgent.toLowerCase(),i=g.platform.toLowerCase(),n=/win/.test(i||e),r=/mac/.test(i||e),o=!!/webkit/.test(e)&&parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),s="Microsoft Internet Explorer"===g.appName,h=[0,0,0],f=null;if(typeof g.plugins!=a&&typeof g.plugins[c]==l)(f=g.plugins[c].description)&&typeof g.mimeTypes!=a&&g.mimeTypes[u]&&g.mimeTypes[u].enabledPlugin&&(m=!0,s=!1,f=f.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=H(f.replace(/^(.*)\..*$/,"$1")),h[1]=H(f.replace(/^.*\.(.*)\s.*$/,"$1")),h[2]=/[a-zA-Z]/.test(f)?H(f.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof d.ActiveXObject!=a)try{var v=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");v&&(f=v.GetVariable("$version"))&&(s=!0,h=[H((f=f.split(" ")[1].split(","))[0]),H(f[1]),H(f[2])])}catch(t){}return{w3:t,pv:h,wk:o,ie:s,win:n,mac:r}}();S.w3&&((typeof p.readyState!=a&&("complete"===p.readyState||"interactive"===p.readyState)||typeof p.readyState==a&&(p.getElementsByTagName("body")[0]||p.body))&&k(),w||(typeof p.addEventListener!=a&&p.addEventListener("DOMContentLoaded",k,!1),S.ie&&(p.attachEvent(f,(function t(){"complete"==p.readyState&&(p.detachEvent(f,t),k())})),d==top&&function t(){if(!w){try{p.documentElement.doScroll("left")}catch(e){return void setTimeout(t,0)}k()}}()),S.wk&&function t(){w||(/loaded|complete/.test(p.readyState)?k():setTimeout(t,0))}()));function k(){if(!w&&document.getElementsByTagName("body")[0]){try{var t,e=U("span");e.style.display="none",(t=p.getElementsByTagName("body")[0].appendChild(e)).parentNode.removeChild(t),t=null,e=null}catch(t){return}w=!0;for(var i=v.length,n=0;n<i;n++)v[n]()}}function O(t){w?t():v[v.length]=t}function j(){var t=y.length;if(t>0)for(var e=0;e<t;e++){var i=y[e].id,n=y[e].callbackFn,r={success:!1,id:i};if(S.pv[0]>0){var o=N(i);if(o)if(!z(y[e].swfVersion)||S.wk&&S.wk<312)if(y[e].expressInstall&&A()){var s={};s.data=y[e].expressInstall,s.width=o.getAttribute("width")||"0",s.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(s.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(s.align=o.getAttribute("align"));for(var l={},c=o.getElementsByTagName("param"),u=c.length,h=0;h<u;h++)"movie"!=c[h].getAttribute("name").toLowerCase()&&(l[c[h].getAttribute("name")]=c[h].getAttribute("value"));P(s,l,i,n)}else D(o),n&&n(r);else W(i,!0),n&&(r.success=!0,r.ref=E(i),r.id=i,n(r))}else if(W(i,!0),n){var f=E(i);f&&typeof f.SetVariable!=a&&(r.success=!0,r.ref=f,r.id=f.id),n(r)}}}function E(t){var e=null,i=N(t);return i&&"OBJECT"===i.nodeName.toUpperCase()&&(e=typeof i.SetVariable!==a?i:i.getElementsByTagName(l)[0]||i),e}function A(){return!x&&z("6.0.65")&&(S.win||S.mac)&&!(S.wk&&S.wk<312)}function P(t,o,s,l){var c=N(s);if(s=B(s),x=!0,n=l||null,r={success:!1,id:s},c){"OBJECT"==c.nodeName.toUpperCase()?(e=M(c),i=null):(e=c,i=s),t.id=h,(typeof t.width==a||!/%$/.test(t.width)&&H(t.width)<310)&&(t.width="310"),(typeof t.height==a||!/%$/.test(t.height)&&H(t.height)<137)&&(t.height="137");var u=S.ie?"ActiveX":"PlugIn",f="MMredirectURL="+encodeURIComponent(d.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+u+"&MMdoctitle="+encodeURIComponent(p.title.slice(0,47)+" - Flash Player Installation");if(typeof o.flashvars!=a?o.flashvars+="&"+f:o.flashvars=f,S.ie&&4!=c.readyState){var g=U("div");s+="SWFObjectNew",g.setAttribute("id",s),c.parentNode.insertBefore(g,c),c.style.display="none",F(c)}I(t,o,s)}}function D(t){if(S.ie&&4!=t.readyState){t.style.display="none";var e=U("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(M(t),e),F(t)}else t.parentNode.replaceChild(M(t),t)}function M(t){var e=U("div");if(S.win&&S.ie)e.innerHTML=t.innerHTML;else{var i=t.getElementsByTagName(l)[0];if(i){var n=i.childNodes;if(n)for(var r=n.length,o=0;o<r;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||e.appendChild(n[o].cloneNode(!0))}}return e}function I(t,e,i){var n,r=N(i);if(i=B(i),S.wk&&S.wk<312)return n;if(r){var o,s,c,h=S.ie?U("div"):U(l);for(c in typeof t.id==a&&(t.id=i),e)e.hasOwnProperty(c)&&"movie"!==c.toLowerCase()&&R(h,c,e[c]);for(o in S.ie&&(h=function(t,e){var i=U("div");return i.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+t+"'>"+e+"</object>",i.firstChild}(t.data,h.innerHTML)),t)t.hasOwnProperty(o)&&("styleclass"===(s=o.toLowerCase())?h.setAttribute("class",t[o]):"classid"!==s&&"data"!==s&&h.setAttribute(o,t[o]));S.ie?_[_.length]=t.id:(h.setAttribute("type",u),h.setAttribute("data",t.data)),r.parentNode.replaceChild(h,r),n=h}return n}function R(t,e,i){var n=U("param");n.setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}function F(t){var e=N(t);e&&"OBJECT"==e.nodeName.toUpperCase()&&(S.ie?(e.style.display="none",function t(){if(4==e.readyState){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode.removeChild(e)}else setTimeout(t,10)}()):e.parentNode.removeChild(e))}function L(t){return t&&t.nodeType&&1===t.nodeType}function B(t){return L(t)?t.id:t}function N(t){if(L(t))return t;var e=null;try{e=p.getElementById(t)}catch(t){}return e}function U(t){return p.createElement(t)}function H(t){return parseInt(t,10)}function z(t){t+="";var e=S.pv,i=t.split(".");return i[0]=H(i[0]),i[1]=H(i[1])||0,i[2]=H(i[2])||0,e[0]>i[0]||e[0]==i[0]&&e[1]>i[1]||e[0]==i[0]&&e[1]==i[1]&&e[2]>=i[2]}function V(t,e,i,n){var r=p.getElementsByTagName("head")[0];if(r){var l="string"==typeof i?i:"screen";if(n&&(o=null,s=null),!o||s!=l){var c=U("style");c.setAttribute("type","text/css"),c.setAttribute("media",l),o=r.appendChild(c),S.ie&&typeof p.styleSheets!=a&&p.styleSheets.length>0&&(o=p.styleSheets[p.styleSheets.length-1]),s=l}o&&(typeof o.addRule!=a?o.addRule(t,e):typeof p.createTextNode!=a&&o.appendChild(p.createTextNode(t+" {"+e+"}")))}}function W(t,e){if(C){var i=e?"visible":"hidden",n=N(t);w&&n?n.style.visibility=i:"string"==typeof t&&V("#"+t,"visibility:"+i)}}function X(t){return null!=/[\\\"<>\.;]/.exec(t)&&typeof encodeURIComponent!=a?encodeURIComponent(t):t}v[0]=function(){m?function(){var t=p.getElementsByTagName("body")[0],e=U(l);e.setAttribute("style","visibility: hidden;"),e.setAttribute("type",u);var i=t.appendChild(e);if(i){var n=0;!function r(){if(typeof i.GetVariable!=a)try{var o=i.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),S.pv=[H(o[0]),H(o[1]),H(o[2])])}catch(t){S.pv=[8,0,0]}else if(n<10)return n++,void setTimeout(r,10);t.removeChild(e),i=null,j()}()}else j()}():j()};S.ie&&window.attachEvent("onunload",(function(){for(var e=b.length,i=0;i<e;i++)b[i][0].detachEvent(b[i][1],b[i][2]);for(var n=_.length,r=0;r<n;r++)F(_[r]);for(var o in S)S[o]=null;for(var s in S=null,t)t[s]=null;t=null}));return{registerObject:function(t,e,i,n){if(S.w3&&t&&e){var r={};r.id=t,r.swfVersion=e,r.expressInstall=i,r.callbackFn=n,y[y.length]=r,W(t,!1)}else n&&n({success:!1,id:t})},getObjectById:function(t){if(S.w3)return E(t)},embedSWF:function(t,e,i,n,r,o,s,c,u,h){var f=B(e),d={success:!1,id:f};S.w3&&!(S.wk&&S.wk<312)&&t&&e&&i&&n&&r?(W(f,!1),O((function(){i+="",n+="";var p={};if(u&&typeof u===l)for(var g in u)p[g]=u[g];p.data=t,p.width=i,p.height=n;var m={};if(c&&typeof c===l)for(var v in c)m[v]=c[v];if(s&&typeof s===l)for(var y in s)if(s.hasOwnProperty(y)){var _=T?encodeURIComponent(y):y,b=T?encodeURIComponent(s[y]):s[y];typeof m.flashvars!=a?m.flashvars+="&"+_+"="+b:m.flashvars=_+"="+b}if(z(r)){var w=I(p,m,e);p.id==f&&W(f,!0),d.success=!0,d.ref=w,d.id=w.id}else{if(o&&A())return p.data=o,void P(p,m,e,h);W(f,!0)}h&&h(d)}))):h&&h(d)},switchOffAutoHideShow:function(){C=!1},enableUriEncoding:function(t){T=typeof t===a||t},ua:S,getFlashPlayerVersion:function(){return{major:S.pv[0],minor:S.pv[1],release:S.pv[2]}},hasFlashPlayerVersion:z,createSWF:function(t,e,i){return S.w3?I(t,e,i):void 0},showExpressInstall:function(t,e,i,n){S.w3&&A()&&P(t,e,i,n)},removeSWF:function(t){S.w3&&F(t)},createCSS:function(t,e,i,n){S.w3&&V(t,e,i,n)},addDomLoadEvent:O,addLoadEvent:function(t){if(typeof d.addEventListener!=a)d.addEventListener("load",t,!1);else if(typeof p.addEventListener!=a)p.addEventListener("load",t,!1);else if(typeof d.attachEvent!=a)!function(t,e,i){t.attachEvent(e,i),b[b.length]=[t,e,i]}(d,"onload",t);else if("function"==typeof d.onload){var e=d.onload;d.onload=function(){e(),t()}}else d.onload=t},getQueryParamValue:function(t){var e=p.location.search||p.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),null==t)return X(e);for(var i=e.split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==t)return X(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(x){var t=N(h);t&&e&&(t.parentNode.replaceChild(e,t),i&&(W(i,!0),S.ie&&(e.style.display="block")),n&&n(r)),x=!1}},version:"2.3"}}();return t}.apply(e,[]))||(t.exports=n)},function(t,e){},function(t,e){},function(t,e){},function(t,e,i){"use strict";i.r(e);var n=i(1),r=i.n(n),o=i(0),s=i.n(o),a=i(19),l=i.n(a),c=i(10),u=i.n(c),h=i(13),f=i.n(h),d=i(3),p=i.n(d),g=i(6),m=i(56),v=i.n(m),y=i(7),_=i.n(y),b=i(57),w=i.n(b);var x={room:null,callback:null,obj:null,player:null,connectSuc:!1,trigger:function(t,e,i){switch(i.length){case 0:return void t.trigger(e,"");case 1:return void t.trigger(e,i[0]);case 2:return void t.trigger(e,i[0],i[1]);case 3:return void t.trigger(e,i[0],i[1],i[2]);default:t.trigger(e,i)}},destroy:function(){s.a.debug("socket on destroy!"),this.obj.close()},getSocketServer:function(){var t=this.room.websocket.shift();return this.room.websocket.push(t),t},nativeEmitMatch:function(t){var e,i,n;switch(s.a.debug("native match===>",t),2===t.length?(e=t[0],n="function"==typeof t[1]?t[1]:""):3===t.length&&(e=t[0],i=t[1],n="function"==typeof t[2]?t[2]:""),e){case"question:ask":var r={action:"question",type:"question",typeId:"ask",replyId:i.replyId||"",content:i.msg};return question.quesPost("ask",r,n),!0;case"question:reply":r={action:"answer",type:"answer",typeId:"reply",replyId:i.replyId,content:i.msg};return question.quesPost("reply",r,n),!0;case"question:get:list":return question.getList(MT.room.access_token,n),!0;case"question:get:part":return question.getQuestionById(i.qid,n),!0}},dealMemberAvatar:function(t){let e=g.default.getters("getInitData");return e?(t.a&&t.xid&&e.avatarHost?t.avatar=e.avatarHost+"/avatar/"+t.xid%255+"/"+t.xid%600+"/"+t.xid%1024+"/"+t.xid+".jpg":void 0!==t.a&&t.role&&e.avatarHost&&e.defaultAvatar&&(t.avatar=e.defaultAvatar[t.role]||e.defaultAvatar.user),t):""},emit:function(){var t=this,e={cmd:null,args:[]},i=null;e.cmd=arguments[0];for(var n=1;n<arguments.length;n++)"function"==typeof arguments[n]?i=arguments[n]:e.args.push(arguments[n]);this.obj&&(e=w.a.deflate(JSON.stringify(e),{to:"string"}),this.obj.emit("income",e,(function(e){if(void 0!==e.length)for(var n in e)e[n]=t.dealMemberAvatar(e[n]);else e.data&&void 0!==e.data.a?e.data=t.dealMemberAvatar(e.data):void 0!==e.a&&(e=t.dealMemberAvatar(e));void 0!==e.code&&-5===e.code?window.location.reload():i&&i(e)})))},onBroadcast:function(t){if("object"==typeof t){var e=g.default.getters("getInitData"),i={},n=e.user.xid,r=e.user.sid;if(void 0!==n&&!(void 0!==t.nosid&&t.nosid.length>0&&s.a.in_array(r,t.nosid)||void 0!==t.noxid&&t.noxid.length>0&&s.a.in_array(n,t.noxid))){try{t.args=s.a.detectProtocol(JSON.stringify(t.args)),t.args=JSON.parse(t.args)}catch(t){s.a.debug("Broadcast-data parse Error => "+t)}if(s.a.debug("Socket on: ======> "+t.cmd,t.args),i.cmd=t.cmd,"member:total"===t.cmd&&void 0!==t.ext){var o=t.args;i.args=t.ext,i.args.total=o}else i.args=t.args;return i}}},getQuestionList:function(t,e){question.getList(t,e)},listenSystemCmd:function(t){var e=this,i=this.room.user,n=0;try{t.on("connect",(function(){s.a.debug("服务器链接成功..."),e.connectSuc=!0,t.socket_id=t.id,_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=connect&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid);try{r.a.get("connect")()}catch(t){}})),t.on("connect_failed",(function(e){s.a.debug("连接服务器失败,失败信息:"+e),_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=connect_failed&reason="+e+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("connect_failed")(e)})),t.on("connect_error",(function(o){n++;try{t.close();var a=e.getSocketServer();e.connect(a,e.callback)}catch(t){}s.a.debug("连接服务器错误,错误信息:"+o+",times:"+n),_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=connect_error&reason="+o+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("connect_error")(o)})),t.on("disconnect",(function(e){_.a.socket("uri="+t.io.uri+"&socket_id="+t.socket_id+"&status=disconnect&reason="+e+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("disconnect")(e)})),t.on("reconnect",(function(e){_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=reconnect&number="+e+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("reconnect")(e)})),t.on("reconnect_attempt",(function(t){})),t.on("reconnecting",(function(e){s.a.debug("正在重新连接:"+e),_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=reconnecting&number="+e+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("reconnecting")(e)})),t.on("reconnect_error",(function(e){s.a.debug("重新连接失败!"),_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=reconnect_error&reason="+e+"&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("reconnect_error")(e)})),t.on("reconnect_failed",(function(){s.a.debug("重新连接失败..."),_.a.socket("uri="+t.io.uri+"&socket_id="+t.id+"&status=reconnect_failed&xid="+i.xid+"&pid="+i.pid+"&roomid="+i.roomid),r.a.get("reconnect_failed")()})),t.on("_broadcast",(function(t){var i=e.onBroadcast(t);i&&i.cmd&&r.a.get(i.cmd)(i.args||{})})),t.on("member:join:me",(function(t){s.a.debug("初始化数据完成 ====> member:join:me"),s.a.debug(t);i.xid;try{t=s.a.detectProtocol(JSON.stringify(t)),t=JSON.parse(t)}catch(t){s.a.debug("members data parse Error"+t)}r.a.get("member:join:me")(t),s.a.isMobile(),this.roomInited||(this.roomInited=!0)}))}catch(t){throw r.a.get("system:socket:error")("系统事件:"+t.message),new Error("系统事件:"+t.message)}},connect:function(t,e){if(!t)return!1;var i=this.room,n=this.obj=v.a.connect(t,{timeout:2e3,reconnection:!0,multiplex:!1,reconnectionDelay:1e3,reconnectionDelayMax:5e3,query:{access_token:i.access_token,sessionid:i.user.sessionid,xid:i.user.xid}});this.listenSystemCmd(n),this.onBroadcast(n),window.__socket=n,e(n)},init:function(t,e){var i=t;this.room=t,this.callback=e;let n=g.default.getters("getToken");if(this.room.access_token=n,!i.websocket)return s.a.debug("获取聊天服务器地址失败！"),r.a.get("system:socket:error")("获取聊天服务器地址失败！"),!1;"string"==typeof this.room.websocket&&(this.room.websocket=[this.room.websocket]);var o=this.getSocketServer();this.connect(o,e)}},C=i(2),T=i(36);var S={latestParseObj:{},toUBB:function(t){return t=t.replace(/<img.*?src="(.*)?".*?\/>/,"[IMG]$1[/IMG]")},toHTML:function(t){return t=t.replace(/\[IMG\]([^\[]*)\[\/IMG\]/gi,(function(t,e){return'<img class="clip" src="'+e+'" />'}))},showImageFullSize:function(t,e){t&&e&&"function"==typeof e&&e(t.replace(/_s/g,""))},getList:function(){return g.default.dispatch(C.GET_CHAT_LIST).then(t=>{t&&t.data&&(t.data.length>0&&t.data.forEach((function(t){x.dealMemberAvatar(t)})),r.a.get("chat:list")(t.data))})},onpaste:function(t,e){for(var i=window.URL||window.webkitURL,n=(t.clipboardData||t.originalEvent.clipboardData).items,r=0;r<n.length;r++){var o=n[r];if(o.type.indexOf("image")>-1){var s=o.getAsFile(),a=i.createObjectURL(s),l=new FileReader;this.latestParseObj=s,e(a),l.readAsDataURL(s)}}},postClipPhoto:function(t){t&&"function"==typeof t&&this.uploadFile(this.latestParseObj,t)},uploadFile:function(t,e){var i=new FormData;i.append("Filedata",t);var n=new XMLHttpRequest;n.upload.onprogress=function(t){var e=t.loaded/t.total*100;s.a.debug("chat image Uploaded "+e+"%")},n.onload=function(){200==n.status?e&&e(JSON.parse(n.responseText)):e&&e("Error! Upload failed")},n.onerror=function(){e&&e("Error! Upload failed. Can not connect to server.")},n.open("POST",p.a.PROTOCOL+"fp2.talk-fun.com/live/api/uploadImage.php?access_token="+T.getAccessToken(),!0),n.send(i)},danmakuHandle:function(t,e){switch(t.eventName){case"danmaku:open":e.getPlayer((function(t){t.jsCallFlash("danmaku:open","")}));break;case"danmaku:close":e.getPlayer((function(t){t.jsCallFlash("danmaku:close","")}));break;case"danmaku:set:color":e.getPlayer((function(e){e.jsCallFlash("danmaku:set:color",{color:t.data.color})}))}},danmaku:function(t,e){if(s.a.isMobile())return!1;var i=t.args.msg||t.args.data.msg,n=[],r={c:i};n.push(r),n=JSON.stringify(n),e.getPlayer((function(t){t.jsCallFlash("user:chat:data",n)}))}},k=i(5),O=i(0),j=i(1),E=i(19),A=i(3),P=i(55),D=i(53),M=i(15),I=i(10),R={mainContainerId:null,mainPlayerId:null,playType:"live",playerInit:!1,duration:0,currentTime:0,percent:0,page:0,st:0,currentPageData:{width:0,height:0,dom:null},width:0,height:0,pptRatio:.75,pptRatio_1610:.625,pptRatio_169:.5625,pageRatio:4/3,pptWidth:1280,pptHeight:960,drawWidth:1280,drawHeight:960,whiteBoardWidth:800,whiteBoardHeight:600,pptMatrix:[],imgMatrix:[],ratio:.75,rwidth:800,rheight:600,pages:{},canvasObj:{},imageObj:{},drawObj:{},lineObj:{},dottedLineObj:{},circleObj:{},rectangleObj:{},ctx:{},arrowObj:{},commands:{},mainPlayer:function(t,e,i){if(this.mainContainerId=t,this.mainPlayerId=e,"function"==typeof i){i({playerId:t,width:this.width,height:this.height})}var n=this.getRatio();this.setCanvaOffset(n.width,n.height)},config:function(t){"object"==typeof t&&t.playType&&(this.playType=t.playType)},initPlayerObserve:function(t){if(this.mainContainerId){let t=document.querySelector("#doc");var e=null;observeRect(t,t=>{console.warn(t),e&&clearTimeout(e),e=setTimeout(()=>{this.resize(t.width)},500)}).observe()}},destroy:function(){this.ctx["canvas-draw"]&&this.ctx["canvas-draw"].dispose(),this.ctx={}},getRatio:function(t,e,i){O.debug("setting ratio",t,e,i);var n=document.querySelector("#"+this.mainContainerId);if(!n)return!1;i=i||this.pageRatio;var r,o,s=t||n.clientWidth,a=e||n.scrollHeight;return s/a>i?(r=a*i,o=a):(r=s,o=s/i),this.width=r,this.height=o,{width:r,height:o}},canvasId:function(t){return"canvas-"+t},canvas:function(t){var e=this.canvasId(t);if(!this.canvasObj[e]){if(!(i=document.getElementById(e))){var i,n=this.getRatio();(i=document.createElement("canvas")).style.width=n.width+"px",i.style.height=n.height+"px",i.width=n.width,i.height=n.height,i.className="canvas-player",i.id=e;var r=document.getElementById(this.mainContainerId);r.style.width=n.width+"px",r.style.height=n.height+"px",r.style.background="#ffffff",r.style.backgroundColor="#ffffff",r.style.position="relative",r.style.overflow="hidden",r.style.margin="auto";var o=I.getContainer(I.constant.MODE_EDUCATION);i.style.zIndex="draw"===t?"2":"1",i.style.position="absolute",o.appendChild(i)}this.canvasObj[e]=i}return this.canvasObj[e]},context:function(t){var e=this.canvasId(t);if(!this.ctx[e]){O.debug("create context ==>",t,e);var i=this.canvas(t),n=new k.fabric.Canvas(e,{selection:!1});this.setCanvaOffset(this.width,this.height),n.selection=!1,n.setDimensions({width:this.width,height:this.height}),n.calcOffset(),this.ctx[e]=n,i.parentNode.style.position="absolute",i.parentNode.style.left="0"}return this.ctx[e]},getDrawObjectById:function(t,e){if(!e)return null;for(var i=t.getObjects(),n=0,r=i.length;n<r;n++)if(i[n].id===e)return i[n]},getPpt:function(){var t=document.getElementById("ppt-image");return t||((t=document.createElement("img")).id="ppt-image",t.style.zIndex="0",document.getElementById(this.mainContainerId).appendChild(t)),t},whiteBoard:function(t){var e=t.args,i=this;if(e.metadata)try{var n=JSON.parse(e.metadata);if(n.st<this.st)return;if(this.st=n.st,25==n.t&&O.isMobileSDK())return P.addSchedule(n.st,n,(function(t){O.debug("schedule:",t),i.dispatch(t,!0)}));this.dispatch(n,!0)}catch(t){O.warn("whiteBoard command error ==>",t)}},dispatch:function(t,e){if("string"==typeof t&&(t=JSON.parse(t)),31==t.t)for(var i,n=0,r=t.d.length;n<r;n++)i=JSON.parse(t.d[n]),this.execute(i);else this.execute(t)},initStorage:function(){this.st=0,this.pages={},this.commands={},this.imageObj={},this.drawObj={},this.canvasObj={},this.ctx={},I.initialize()},pushCommands:function(t){if(O.in_array(t.t,[11,19,15,16,20,25,1,I.COMMAND.RUBBER]))this.commands[t.p]||(this.commands[t.p]=[]),this.commands[t.p].push(t);else if(51==t.t){var e=t.c.split("|")[0];if(!this.isWhiteBoard(t.p)){var i=this.getPage(t.p);if(i)e!=i.c.split("|")[0]&&this.flushCommands(t.p)}this.pages[t.p]=t}},flushCommands:function(t){this.commands[t]&&delete this.commands[t]},getCommands:function(t,e){var i=t.p;if(this.commands[i]&&0!==this.commands[i].length)e(this.commands[i]);else{var n=this,r=A.APP_HOST+"/live/command.php";(t.hd&&"f"===t.hd||!1===n.playerInit)&&(O.debug("get commands."),O.ajax({type:"GET",url:r,dataType:"jsonp",data:"access_token="+E.getAccessToken()+"&page="+i,success:function(t){t.code===A.CODE.SUCCESS&&(O.debug("get commands from server:",t.data),n.commands[i]=t.data,e(t.data))}}))}},getPage:function(t){return this.pages[t]},execute:function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return O.debug("whiteboard h5 player execute command error:"+t)}O.debug("#### ======>> [执行指令]"+t.t+" <<======= ####"),O.debug("whiteboard h5 player execute:",t);t.t==I.COMMAND.START?this.startLoaded||(this.start(t),this.startLoaded=!0):t.t==I.COMMAND.PAGE?this.setPage(t):t.t==I.COMMAND.DRAW?this.stroke(t):t.t==I.COMMAND.IMAGE?this.image(t):t.t==I.COMMAND.ARROW?this.arrow(t):t.t==I.COMMAND.CIRCLE?this.circle(t):t.t==I.COMMAND.RECTANGLE?this.rectangle(t):t.t==I.COMMAND.LINE?this.line(t):t.t==I.COMMAND.DOTTED_LINE?this.dottedLine(t):t.t==I.COMMAND.TEXT?this.text(t):t.t==I.COMMAND.LIVE_POWER_CHANGE?this.livePowerChange(t):t.t==I.COMMAND.GRAFFITI?this.graffiti(t):t.t==I.COMMAND.RUBBER?this.rubberErase(t):103==t.t||104==t.t?D.videoDo(t):101==t.t||102==t.t?D.cameraDo(t):t.t==I.COMMAND.IMAGE_PRELOAD?this.imagePreload(t):t.t==I.COMMAND.STOP&&this.stop(t),this.pageContent=void 0},start:function(t){E.user;O.debug("h5 live start"),this.action=t.t||"start",D.action=t.t,this.initStorage(),this.isSetup||(O.isMobileSDK()||D.getCameraPlayer().pause(),j.get("live:start")()),"live"===this.playType&&j.get("live:start")(),this.isSetup=!0},stop:function(t){(this.action=t.t,this.clear(),this.initStorage(),O.isMobileSDK())||D.getCameraPlayer().pause();this.action="stop",j.get("live:stop")()},wait:function(){this.action="wait","start"===this.action?j.get("live:stop")():j.get("live:wait")()},livePowerChange:function(t){this.commands={},j.get("live:power:change")(t)},isDraw:function(t,e){for(var i=!1,n=t.getObjects(),r=0;r<n.length;r++)n[r].id===e&&(i=!0);return i},redrawCommands:function(t){var e=this;t.page||this.page;"live"===e.playType?e.getCommands(t,(function(t){if(t.length>0)for(var i=0;i<t.length;i++)e.dispatch(t[i])})):e.playType},resizePage:function(){},setPage:function(t){O.debug("set page ===>",t),this.page=t.p,this.pages[t.p]=t;var e=t.p,i=this,n=t.c.split("|")||"",r=n[3].split(","),o=[1,0,0,1,0,0];if(n[2]==I.COMMAND.PPTCLEAR)return!1;var s="3"==n[2],a=this.canvas("ppt"),l=this.canvas("draw"),c=this.context("ppt"),u=this.context("draw"),h=i.scaleX(c,t.p);i.scaleY(c,t.p);s&&this.clear();r[0];if(r[0]=1,r[3]=1,r[4]=parseFloat(r[4]),r[5]=parseFloat(r[5]),j.get("live:set:page")(e),this.isWhiteBoard(e)){O.debug("load canvas whiteBoard..."),j.get("live:whiteboard:ratio")(i.whiteBoardHeight/i.whiteBoardWidth),this.clear(),c.backgroundColor=this.getColor(n[4]);var f=new k.fabric.Line([0,0,0,0]);c.add(f);var d=i.whiteBoardWidth*h,p=d*i.pptRatio;i.transform(l,r),i.transform(a,r),c.setDimensions({width:d,height:p}),u.setDimensions({width:d,height:p}),i.currentPageData.width=i.whiteBoardWidth,i.currentPageData.height=i.whiteBoardHeight;var g=document.getElementById("ppt-image");g&&(g.style.display="none"),u.renderAll(),c.renderAll(),i.playerInit=!0}else{var m=n[0]+n[1]+"_"+n[5]+".jpg";O.debug("load ppt url ==>",m),c.setBackgroundColor(""),i.clear(),this.loadImage(m,(function(e){if(i.page!=t.p)return!1;j.get("live:whiteboard:ratio")(e.height/e.width),i.currentPageData.width=e.width,i.currentPageData.height=e.height,i.drawWidth=e.width,i.drawHeight=e.width*i.pptRatio;var n=document.getElementById("ppt-image");n?n.style.display="block":((n=document.createElement("img")).id="ppt-image",n.style.zIndex="0",n.style.position="absolute",n.style.left="0",I.getContainer(I.constant.MODE_EDUCATION).appendChild(n)),i.pptWidth=e.width,i.pptHeight=e.height;var s=i.scaleX(c,t.p);O.debug("ppt scale ==>",s);var h=i.canvasWidth,f=i.canvasHeight;if(e.height/e.width==i.pptRatio)O.debug("ppt 比例=>"+i.pptRatio),n.style.paddingLeft="0px",n.style.paddingTop="0px",n.style.paddingBottom="0px",n.width=e.width*s,n.height=e.height*s+.5,h=i.canvasWidth,f=i.canvasHeight,i.imgMatrix=r;else if(e.height/e.width>i.pptRatio){O.debug("ppt 比例> "+i.pptRatio),n.style.paddingLeft="0px",n.style.paddingTop="0px",n.style.paddingBottom="0px",n.width=i.width,n.height=n.width/e.width*e.height;var d=n.width*i.pptRatio/i.whiteBoardHeight;r[5]<0&&(r[5]=r[5]*d),i.drawHeight=e.height,i.imgMatrix=r,h=n.width,f=n.height}else{O.debug("ppt 比例< "+i.pptRatio);i.width,e.height,e.width,d=i.width*i.pptRate/i.whiteBoardHeight;var p=e.height/e.width,g=i.getRatio();n.width=g.width,n.height=g.width*p;var m=(g.height-n.height)/2+"px";n.style.paddingLeft="0px",n.style.paddingTop=m,n.style.paddingBottom=m,r[5]=r[5]*d,i.imgMatrix=o,h=i.canvasWidth,f=i.canvasHeight}i.pptMatrix=r,r=r.join(","),o=i.imgMatrix.join(","),i.transform(n,o),n.src=e.src,i.transform(a,r),c.setDimensions({width:h,height:f}),i.transform(l,r),u.setDimensions({width:h,height:f}),u.renderAll(),i.playerInit=!0}))}},transform:function(t,e){t.style.setProperty("transform","matrix("+e+")"),t.style.setProperty("-ms-transform","matrix("+e+")"),t.style.setProperty("-webkit-transform","matrix("+e+")"),t.style.setProperty("-o-transform","matrix("+e+")"),t.style.setProperty("-moz-transform","matrix("+e+")")},image:function(t){var e=this,i=t.c.split("|"),n=i[0],r=i[1],o=1===parseInt(i[2]),s=(i[3],i[4].split(",")),a=(parseFloat(s[4]),parseFloat(s[5]),this.context("ppt")),l=this.scaleX(a,t.p),c=this.scaleY(a,t.p),u=parseFloat(s[0]),h=parseFloat(s[3]),f=[parseFloat(1),parseFloat(s[1]),parseFloat(s[2]),parseFloat(1),parseFloat(s[4])*l,parseFloat(s[5])*c];if(e.imageObj[n]){var d=0;e.imageObj[n]===n&&(d=1),function t(i){setTimeout((function(){e.imageObj[n]!==n?(e.imageObj[n].width=e.imageObj[n].originWidth*l*u,e.imageObj[n].height=e.imageObj[n].originHeight*c*h,e.imageObj[n].visible=o,e.imageObj[n].transformMatrix=f,e.isDraw(a,n)||a.add(e.imageObj[n]),o?(a.bringToFront(e.imageObj[n]),a.renderAll()):(a.remove(e.imageObj[n]),delete e.imageObj[n])):t(i)}),1e3*i)}(d)}else e.imageObj[n]=n,k.fabric.Image.fromURL(r,(function(t){t.id=n,t.originWidth=t.width,t.originHeight=t.height,t.width=t.width*l*u,t.height=t.height*c*h,t.selectable=!1,t.visible=o,t.transformMatrix=f,t.backgroundColor="red",e.imageObj[n]=t,a.add(t),t.setCoords()}))},loadImage:function(t,e){var i=this;if(i.imageObj[t])return e(i.imageObj[t]);O.webpSupport((function(n){1==n&&(t=t.replace(".jpg",".jpeg")),t=M.getRetryUrl(t);var r=new Image;r.src=t,r.onload=function(){i.imageObj[t]=r,e(r)},r.onerror=function(){M.loadRetry(t,(function(t){i.loadImage(t,e)}))}}))},imagePreload:function(t){var e=t.c.split("|"),i=e[0]+e[1]+"_"+e[5]+".jpg";this.loadImage(i,(function(t){O.debug("image preload success:"+i)}))},circle:function(t){var e,i,n,r,o=this.context("draw"),s=t.c.split("|"),a=s[0],l=1==s[1],c=parseFloat(s[2]),u=parseFloat(s[3]),h=parseFloat(s[4]),f=parseFloat(s[5]);h>c?(e=u,i=c,n=(h-c)/2,r=(f-u)/2):(e=u,i=h,n=(c-h)/2,r=(f-u)/2);var d=this.scaleX(o,t.p),p=this.scaleY(o,t.p);if(this.circleObj[a]&&this.isDraw(o,a))this.circleObj[a].visible=l,o.renderAll();else{var g=new k.fabric.Ellipse({id:a,top:e*d,left:i*p,rx:n,ry:r,fill:"",stroke:this.getColor(s[7]),strokeWidth:parseInt(s[6]),scaleX:d,scaleY:p,selectable:!1,visible:l});o.add(g),this.circleObj[a]=g}},arrow:function(t){var e=t.c.split("|"),i=this.context("draw"),n=e[0],r=e[1];r=1==r;var o,s,a,l,c,u,h,f,d,p,g,m,v=n,y=n+"_arrow_1",_=n+"_arrow_2",b=this.scaleX(i,t.p),w=this.scaleY(i,t.p),x=parseInt(e[2],10),C=parseInt(e[3],10),T=parseInt(e[4],10),S=parseInt(e[5],10),O=parseInt(e[6],10)*b,j=parseInt(e[8],10),E={sp:{x:x,y:C},ep:{x:T,y:S}};if(this.arrowObj[n]&&this.isDraw(i,n))this.arrowObj[n].baseLine.visible=r,this.arrowObj[n].arrow_n1.visible=r,this.arrowObj[n].arrow_n2.visible=r,i.renderAll();else{var A=function(t,e){return{x:t.x*Math.cos(e)+t.y*Math.sin(e),y:t.y*Math.cos(e)-t.x*Math.sin(e)}},P=(s=(o=E).sp,a=o.ep,l=(a.x-s.x)*b,c=(a.y-s.y)*w,u=Math.atan(l/c),h=A(a,-u),f=A(s,-u),d={x:0,y:0},p={x:0,y:0},g=h.y-f.y,m=10+8*O,g=m*=g>0?1:-1,d.x=h.x+g,d.y=h.y-g,p.x=h.x-g,p.y=h.y-g,{g1:A(d,u),g2:A(p,u)}),D=[E.sp.x*b,E.sp.y*w,E.ep.x*b,E.ep.y*w],M=[E.ep.x*b,E.ep.y*w,P.g1.x*b,P.g1.y*w],I=[E.ep.x*b,E.ep.y*w,P.g2.x*b,P.g2.y*w],R=new k.fabric.Line(M,{id:y,stroke:this.getColor(e[7]),strokeWidth:O,cornerStyle:"circle",opacity:j,visible:r}),F=new k.fabric.Line(I,{id:_,stroke:this.getColor(e[7]),strokeWidth:O,cornerStyle:"circle",opacity:j,visible:r}),L=new k.fabric.Line(D,{id:v,childs:[R,F],stroke:this.getColor(e[7]),strokeWidth:O,cornerStyle:"circle",opacity:j,visible:r});L.selectable=!1,R.selectable=!1,F.selectable=!1,i.add(L,R,F),this.arrowObj[n]={baseLine:L,arrow_n1:R,arrow_n2:F}}},rectangle:function(t){var e,i,n,r,o=this.context("draw"),s=t.c.split("|"),a=s[0],l=1==s[1],c=parseFloat(s[2]),u=parseFloat(s[3]),h=parseFloat(s[4]),f=parseFloat(s[5]);h>c?(e=f,i=c,n=h-c,r=u-f):(e=u,i=c,n=h-c,r=f-u);var d=this.scaleX(o,t.p),p=this.scaleY(o,t.p);if(this.rectangleObj[a]&&this.isDraw(o,a))this.rectangleObj[a].visible=l,o.renderAll();else{var g=new k.fabric.Rect({id:a,left:i*d,top:e*p,fill:"",width:n,height:r,stroke:this.getColor(s[7]),strokeWidth:parseInt(s[6])/2,scaleX:d,scaleY:p,selectable:!1,visible:l});o.add(g),this.rectangleObj[a]=g}},line:function(t){var e=this.context("draw"),i=t.c.split("|"),n=i[0],r=1==i[1],o=parseFloat(i[2]),s=parseFloat(i[3]),a=parseFloat(i[4]),l=parseFloat(i[5]);a>o?s:s;var c=this.scaleX(e,t.p),u=this.scaleY(e,t.p);if(this.lineObj[n]&&this.isDraw(e,n))this.lineObj[n].visible=r,e.renderAll();else{var h=[o*c,s*u,a*c,l*u],f=new k.fabric.Line(h,{id:n,fill:"",stroke:this.getColor(i[7]),strokeWidth:parseInt(i[6])/2,selectable:!1,visible:r});e.add(f),this.lineObj[n]=f}},dottedLine:function(t){var e=this.context("draw"),i=t.c.split("|"),n=i[0],r=1==i[1],o=parseFloat(i[2]),s=parseFloat(i[3]),a=parseFloat(i[4]),l=parseFloat(i[5]);a>o?s:s;var c=this.scaleX(e,t.p),u=this.scaleY(e,t.p);if(this.dottedLineObj[n]&&this.isDraw(e,n))this.dottedLineObj[n].visible=r,e.renderAll();else{var h=[o*c,s*u,a*c,l*u],f=5+parseInt(i[6])/2,d=5+parseInt(i[6])/2,p=new k.fabric.Line(h,{id:n,strokeDashArray:[f,d],fill:"",stroke:this.getColor(i[7]),strokeWidth:parseInt(i[6])/2,selectable:!1,visible:r});e.add(p),this.dottedLineObj[n]=p}},text:function(t){var e=this.context("draw"),i=this.scaleX(e,t.p),n=this.scaleY(e,t.p),r=t.c.split("|"),o=r[0],s=r[6].split(","),a=unescape(r[1]=r[1].replace(/%0D/gi,"\n").replace(/%20/gi,"\r")),l=this.getColor(r[2]),c=parseInt(r[3])*i*s[0],u=1===parseInt(r[4]),h=(parseFloat(s[4]),parseFloat(s[5]),[parseFloat(s[0]),parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]),parseFloat(s[4])*i,parseFloat(s[5])*n]);if(this.drawObj[o]&&this.isDraw(e,o))this.drawObj[o].setText?this.drawObj[o].setText(a):this.drawObj[o].set({text:a}),this.drawObj[o].visible=u,this.drawObj[o].transformMatrix=h,e.renderAll();else{var f=new k.fabric.Text(a,{id:o,fill:l,fontSize:c,visible:u,fontFamily:"Microsoft YaHei",fontWeight:"normal",transformMatrix:h,backgroundColor:"",textBackgroundColor:"",selectable:!1});f.transformMatrix=h,f.setText?f.setText(a):f.set({text:a}),this.drawObj[o]=f,e.add(f)}},isWhiteBoard:function(t){return t>1e4},scaleX:function(t,e){return this.isWhiteBoard(e)?t.width/this.whiteBoardWidth:t.width/this.drawWidth},scaleY:function(t,e){return this.isWhiteBoard(e)?t.height/this.whiteBoardHeight:t.height/this.drawHeight},stroke:function(t){var e=this.context("draw"),i=1==t.c.split("|")[3],n=this.drawSerialize(e,t),r=n.objectId,o=n.graph.data,s={},a="";if(o.length>0)if(this.drawObj[r]&&this.isDraw(e,r))this.drawObj[r].visible=i,e.renderAll();else{for(var l=0;l<o.length;l++)"M"===(s=o[l]).name?a+=" M "+s.x+" "+s.y:"L"===s.name?a+=" L "+s.x+" "+s.y:"C"===s.name&&(a+=" Q "+s.x+","+s.y+","+s.archX+","+s.archY);var c=new k.fabric.Path(a,{id:r,fill:"",stroke:n.color,strokeWidth:n.thickness,selectable:!1});this.drawObj[r]=c,e.add(c)}},drawSerialize:function(t,e){var i=this.scaleX(t,e.p),n=i,r=e.c.split("|"),o=r[0],s=this.getColor(r[1]),a=r[2]*i,l=1==r[3],c=r[4].split(","),u={lineStyle:{thickness:a,color:s},moveTo:{},data:[]},h=0;"M"===c[0]&&(u.moveTo={x:c[1]*i,y:c[2]*n},h=3);for(var f={};h<c.length;)switch(c[h]){case"M":case"L":f={name:c[h],x:parseInt(c[h+1])*i,y:parseInt(c[h+2])*n},u.data.push(f),h+=3;break;case"C":f={name:c[h],x:parseInt(c[h+1])*i,y:parseInt(c[h+2])*n,archX:parseInt(c[h+3])*i,archY:parseInt(c[h+4])*n},u.data.push(f),h+=5}return{objectId:o,color:s,thickness:a,visible:l,graph:u}},getColor:function(t){if((t=(t=parseInt(t)).toString(16)).length<6)for(var e=6-t.length,i=0;i<e;i++)t="0"+t;return t="#"+t},graffiti:function(t){this.context("draw").clear(),this.commands[t.p]&&(this.commands[t.p]=[])},rubberErase:function(t){var e=this.context("draw"),i=this.getDrawObjectById(e,t.c);if(i.setVisible(!1),i.childs&&i.childs.length>0)for(var n=0;n<i.childs.length;n++){i.childs[n].setVisible(!1)}e.renderAll()},clear:function(){O.debug("draw do clear..."),O.isMobile()&&(this.context("ppt").clear(),this.context("draw").clear())},draw:function(){var t=this.getPage(this.page);O.debug("drawing ==>",t),t&&this.execute(t)},setCanvaOffset:function(t,e){O.debug("cavans offset setting",t,e),this.canvasWidth=t,this.canvasHeight=e,I.canvasWidth=t,I.canvasHeight=e},resize:function(t,e,i){O.debug("whiteboad on resize ==>",t,e);var n=this.getRatio(t,e);if(t=n.width,e=n.height,this.setCanvaOffset(t,e),O.debug("whiteboard do resize ... ",O.flashChecker()),O.isMobile()){this.clear();var r=document.getElementById("ppt-image");r&&(r.width=t,r.height=e),this.width=t,this.height=e;var o=this.context("ppt"),s=this.context("draw");o.setDimensions({width:t,height:e}),s.setDimensions({width:t,height:e}),o.calcOffset(),s.calcOffset(),s.renderAll(),o.renderAll();var a=document.getElementById(this.mainContainerId);a.style.width=t+"px",a.style.height=e+"px",this.draw(),O.callback(i)}return{width:t,height:e}}};window.__player=R;var F=R,L=i(1),B=i(0),N=i(10),U=i(53),H=i(113),z=i(114),V=i(7),W=i(55),X=i(15),Y=i(3);N.config({playType:"playback"}),F.config({playType:"playback"}),U.config({playType:"playback",pptPlayerType:"flash"});var G={playMode:N.currentMode||"0",isSkip:!0,currentDuration:0,currentMediaPath:null,playDuration:0,tickTimmer:null,playNumber:1,live:null,videos:[],desktops:[],chatSections:[],commands:[],chapters:[],questions:[],messages:[],cmdStartTime:[],seekPageCommands:{},duration:0,version:null,title:null,action:null,emotions:null,resizeTimer:null,timeRange:null,currentVideoUrl:"",currentVideoHost:"",callSdk:function(t,e){return U.callSdk(t,e)},setting:function(t,e){},resizePlayer:function(t,e){var i=this;return i.resizeTimer&&clearTimeout(i.resizeTimer),F.resize(t,e,(function(){i.resizeTimer=setTimeout((function(){i.getCommandsByDuration(i.currentDuration,(function(t){i.execute(t)}))}),50)}))},jsonCache:{},jsonVersion:"",loadJson:function(t,e,i){var n=this;if(t.indexOf(".json")>-1&&(""==n.jsonVersion&&t.indexOf("?v=")>-1?n.jsonVersion=t.split("?v=")[1].split("&")[0]:""!=n.jsonVersion&&-1==t.indexOf("?v=")&&(t+=t.indexOf("?")>-1?"&v="+n.jsonVersion:"?v="+n.jsonVersion)),t=B.detectProtocol(t),t=X.getRetryUrl(t),i&&G.jsonCache[t])return B.debug("load json from cache:"+t),e(G.jsonCache[t]),!0;B.ajax({type:"GET",url:t,dataType:"json",cache:!0,timeout:1e4,success:function(n){i&&(G.jsonCache[t]=n),e(n)},error:function(i,r,o){V.errorReport({type:"loadJson",msg:t+","+r}),B.debug("LoadJson:====> error loading:"+t),B.debug(i),B.debug(r),X.loadRetry(t,(function(t){n.loadJson(t,e)}))}})},config:null,setConfig:function(t){this.config=t},fireConfig:function(){var t=this;if(!t.config)return!1;t.getVodSwfPlayer((function(e){e.showFullBtn&&e.showFullBtn(t.config.fullscreenButton),e.showVolumeBtn(t.config.volumeButton)}))},flashPlayerState:function(){this.fireConfig(),this.vodStart(this.vodLive)},createSwfPlayer:function(t,e,i){var n=B.flashChecker();if(B.debug("Flash plugins ==>",n),!n.flash)return L.get("flash:load:error")(n),F.mainPlayer(t,e,i),this.vodStart(this.vodLive),!1;var r=N.getContainer(N.constant.MODE_EDUCATION),o=document.getElementById(t),s=document.createElement("div");o&&(o.style.width="100%",o.style.height="100%"),s.id="swfrepace",r.appendChild(s);var a=B.getStaticHost(this.swfUrl);if(document.getElementById(e))return B.debug("播放器已存在 ===>",document.getElementById(e)),this.vodSwfPlayerState=!1,!1;if(a&&a.length>0){var l={data:a,width:"100%",height:"100%",id:e},c={debug:B.isShowDebug()};for(var u in i="function"==typeof i?i:function(){},this.vodLive.flashvar)c[u]=this.vodLive.flashvar[u];z.embedSWF(a,"swfrepace","100%","100%","10.2.0","",c,{allowscriptaccess:"always",allowfullscreen:"true",allowNetworking:"true",wmode:"transparent"},l,i),B.debug("vod swf player success ===>"+e)}else B.debug("Vod-Swf 播放器未定义"),this.vodSwfPlayerState=!1},getVodSwfPlayer:function(t){var e=B.getFlash(this.playerId);this.vodSwfPlayerState?"function"==typeof t&&e&&t(e):B.debug("Vod-Swf 播放器未创建")},mainPlayer:function(t,e,i){N.mainContainerId=t,this.containerId=t,this.playerId=e,this.vodCallback=i,B.isMobile()?F.mainPlayer(t,e,i):this.swfUrl&&this.createSwfPlayer(t,e,i)},camera:function(t,e,i){U.camera(t,e,i)},getUrl:function(t){if(t)return t},broadcastList:function(t){this.loadJson(t,(function(t){B.debug("广播数据===>",t),t&&(B.isInNative()||L.get("live:broadcast:list")(t))}))},vodStart:function(t){U.duration=t.duration,N.vodPlayer=this,U.getCamera(),this.live=t,X.addHostGroup(t.hostGroup||{});var e=N.getSetting("emotions");this.emotions=e||t.emotions,t.h5play&&1==t.h5play&&(U.config({videoPlayType:"html5"}),H.config({videoPlayType:"html5"})),"string"==typeof t.videoUrl&&(t.videoUrl=[t.videoUrl]),"string"==typeof t.desktopUrl&&(t.desktopUrl=[t.desktopUrl]),B.debug("vod url:"+t.vod),B.debug("video url:"+t.videoUrl),this.version=t.version,this.duration=t.duration,this.totalTime=t.duration,this.title=t.title;var i=[],n=0;if(t.medias)for(var r=t.medias,o=0,s=r.length;o<s;o++){var a={st:Math.abs(r[o].start),et:Math.abs(r[o].end),duration:r[o].end-r[o].start,name:r[o].name,snapshot:r[o].snapshot,url:r[o].url[0],allUrl:r[o].url,_source:r[o]};n<r[o].url.length&&(n=r[o].url.length),i.push(a)}this.videoSections=i,this.videoSourceNum=n,B.debug("video sections===>",this.videoSections),window.__vodSections=this.videoSections,B.isMobileSDK()||L.get("live:video:sections")(i),this.loadJsonV2(t.commandsV3)},changeMedia:function(t,e){var i=this;if(i.changeMediaLock=e,B.debug("changeMedia ==> "+t),!t)return!1;if(!t.match(/(video|audio)/gi))return!1;if(i.curMediaTag===t)return!1;if(i.pause(),U.destroy(),"video"===t){var n=U.getCamera("video");U.getVideojsPlayer(n,(function(){i.seek(i.currentDuration)})),i.curMediaTag=t}else{if("audio"!==t)return!1;var r=U.getCamera("audio");U.getVideojsPlayer(r,(function(){i.seek(i.currentDuration)})),i.curMediaTag=t}},nowSourceIndex:0,changeSource:function(t){var e=this,i="";if(e.videoSourceNum<=1)return!1;for(var n in void 0!==t&&-1!=t||(t=e.nowSourceIndex+1),e.nowSourceIndex=t,e.videoSections)if(void 0!==e.videoSections[n].allUrl[t])e.videoSections[n].url=e.videoSections[n].allUrl[t],i=e.videoSections[n].allUrl[t];else{var r=e.videoSections[n].allUrl.length-1;e.videoSections[n].url=e.videoSections[n].allUrl[r],i=e.videoSections[n].allUrl[r]}B.debug("正在切换媒体源 ===>"+(t+1)+" =>("+i+")"),B.isMobileSDK(),e.getDuration((function(t){e.seek(t)}),.5)},initSeek:0,getStartPage:function(){var t="-1.1",e=B.urlHashMap();return e.page&&(t=e.page),t.split(".")},pagesNum:0,jsonUrlPath:"",loadJsonV2:function(t){var e,i=this,n=[];i.jsonUrlPath=t.substring(0,t.lastIndexOf("/")+1),i.commandStore=[],i.runningCmds={},i.loadJson(t,(function(t){var r=t.pages,o=0,s=i.getStartPage(),a=[],l=-1,c=0,u=[];L.get("live:pages:length")(r.length);for(var h=0,f=r.length;h<f;h++)if(r[h].page){var d=r[h].page.st;r[h].page.p>0&&r[h].page.p<1e4?(r[h].page.c=B.detectProtocol(r[h].page.c),!i.initSeek&&s[0]>0&&r[h].page.c.indexOf("http")>-1&&(u=r[h].page.c.split("/"))[7]&&(-1==(l=a.indexOf(u[7]))&&(a.push(u[7]),l=a.indexOf(u[7])),l==s[0]-1&&s[1]==r[h].page.p&&(i.initSeek=r[h].page.st))):r[h].page.p>=1e4&&(i.initSeek||0!=s[0]||(c++,s[1]==c&&(i.initSeek=r[h].page.st))),-1!==d&&(r[h].drawfile&&0!==r[h].drawfile.indexOf("http")&&(r[h].drawfile=i.jsonUrlPath+"draw/"+r[h].drawfile),i.cmdStartTime.push({st:d,i:o}),i.commandStore.push(r[h]),o++);var p=r[h].page.c.split("|");e=r[h].page.p>1e4?Y.STATIC_HOST+"/open/cooperation/default/vod-pc/css/img/error.png":p[0]+p[1]+"_"+p[5]+"_s.jpg",n.push({course:r[h].page.name,page:r[h].page.p,title:i.title,starttime:r[h].page.st,thumb:e})}if(i.pagesNum=o,i.runningCmds=i.commandStore,"string"==typeof t.broadcast&&t.broadcast.length>0&&i.broadcastList(t.broadcast),i.chapters=n,B.isInNative()||L.get("live:chapter:list")(n),window.commandStore=i.commandStore,i.commands=t,i.cameraSectionsV2=t.cameras,t.msg&&t.msg.length>0&&(i.chatSections=t.msg),L.get("live:chat:slice")(i.chatSections),void 0!==t.qa&&(i.qaSections=t.qa),i.cameraSectionsV2){var g=[],m={},v=i.cameraSectionsV2,y=null;for(h=0;h<v.length;h++)y==N.COMMAND.CAMERA_START&&v[h].t!=N.COMMAND.CAMERA_STOP&&(m.type="camera",m.et=parseFloat(v[h].st-.01),g.push(m),m={},y=N.COMMAND.CAMERA_STOP),v[h].t==N.COMMAND.CAMERA_START?(m.st=parseFloat(v[h].st),y=N.COMMAND.CAMERA_START):v[h].t==N.COMMAND.CAMERA_STOP&&(m.type="camera",m.et=parseFloat(v[h].st),g.push(m),m={},y=N.COMMAND.CAMERA_STOP);y!=N.COMMAND.CAMERA_STOP&&(m.type="camera",m.et=parseFloat(999999),g.push(m),m={},y=N.COMMAND.CAMERA_STOP),i.cameraSectionsV2=g,window.cameraSection=g}for(var _=[],b=0;b<i.cameraSectionsV2.length;b++){var w;(w={}).type=N.COMMAND.CAMERA_START,w.time=i.cameraSectionsV2[b].st,_.push(w),(w={}).type=N.COMMAND.CAMERA_STOP,w.time=i.cameraSectionsV2[b].et,_.push(w)}i.nativeCameraSections=_,B.debug("native camera sections===>",_),B.isMobileSDK()||L.get("live:camera:sections")(i.cameraSectionsV2),i.tick()}))},init:function(t,e){this.initLoad||(this.initLoad=!0),B.debug("vod on load init ..."),this.vodLive=t,this.duration=t.duration;L.get("live:info")({liveid:t.id,title:t.title,duration:t.duration,views:t.views,album:t.album,user:t.user,authorAvatar:t.avatar,sourceData:t}),this.swfUrl=t.swfUrl||"",B.debug("vod init success ===> ",t),B.isMobile()?this.vodStart(t):this.createSwfPlayer(this.containerId,this.playerId,this.vodCallback),t.vodLive&&1==t.vodLive?this.vodLiveType=!0:(this.vodLiveType=!1,this.statsPlay()),L.get("vod:load:init")()},statsPlay:function(){var t=this,e=t.vodLive,i="start"===t.action?1:0,n="",r=e.user,o=navigator.userAgent.toLowerCase();n=o.indexOf("ios-sdk")>-1?"ios-sdk":o.indexOf("android-sdk")>-1?"android-sdk":"html";var s={cid:e.id,xid:r.xid,rid:e.rid,uid:r.uid,pid:e.pid,pf:n,type:N.playStatus,pl:i,pt:2,bn:U.bn,ba:U.ba,pn:t.playNumber,ctype:e.type,playRate:t.nowPlayRate,curTime:t.currentDuration,host:t.currentVideoHost,srcUrl:window.encodeURIComponent(t.currentVideoUrl)};U.bn=0,V.play(s);setTimeout((function(){"pause"===t.action&&N.setPlayerStatus(t.action),++t.playNumber,t.statsPlay()}),6e4)},vodCommandFilter:function(t){var e=!1;if(t&&t.c){var i=t.c.split("|");t.t==N.COMMAND.PAGE&&3==i[2]&&(e=!0)}else e=!1;return e},dispatch:function(t){var e;if("string"==typeof t&&(t=JSON.parse(t)),t.t==N.COMMAND.DRAW_LIST)if(B.isMobile())for(var i=0,n=t.d.length;i<n;i++)e=t.d[i],G.execute(e);else e=t,G.execute(t);else G.execute(t)},execute:function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return B.debug("vod player execute command error:"+t)}B.debug("vod player execute:",t);try{B.in_array(t.t,[N.COMMAND.PAGE,N.COMMAND.ARROW,N.COMMAND.DRAW,N.COMMAND.GRAFFITI,N.COMMAND.IMAGE,N.COMMAND.CIRCLE,N.COMMAND.RECTANGLE,N.COMMAND.LINE,N.COMMAND.DOTTED_LINE,N.COMMAND.TEXT,N.COMMAND.IMAGE_PRELOAD,N.COMMAND.STOP,N.COMMAND.START,N.COMMAND.DRAW_LIST,N.COMMAND.RUBBER])&&(B.isMobile()?F.dispatch(t,!0):(this.pcCommandExprose(t),this.getVodSwfPlayer((function(e){B.debug("flash execute ===>",t),e.command(JSON.stringify(t))}))))}catch(t){throw new Error("Player 指令错误===>: "+t)}N.vodInitializeLoad=!0},pcCommandExprose:function(t){t.t==N.COMMAND.PAGE&&L.get("live:set:page")(t.p)},loadCommands:function(t){var e=this;this.commands.length>0?t(this.commands):this.loadJson(this.live.commands,(function(i){var n=0,r=0;for(n=0;n<i.length;n++)for(r=0;r<i[n].datas.length;r++)i[n].datas[r]&&(i[n].datas[r].t==N.COMMAND.VIDEO_START?i[n].datas[r].c=e.live.videoUrl.shift():i[n].datas[r].t==N.COMMAND.DESKTOP_START&&(i[n].datas[r].c=e.live.desktopUrl.shift()));e.commands=i,t(i)}))},parseMessage:function(t){if(B.isInNative())return t;if(this.emotions){var e;for(var i in this.emotions.maps)e=new RegExp(i.replace("[","\\[").replace("]","\\]"),"g"),t=t.replace(e,'<img src="'+this.emotions.base+"/"+this.emotions.maps[i]+'" />');for(var i in this.emotions.system)e=new RegExp(i.replace("[","\\[").replace("]","\\]"),"g"),t=t.replace(e,'<img src="'+this.emotions.system[i]+'" />')}return t},initPlayRate:0,play:function(){B.debug("video loaded & ready play()",this.playMode),"stop"===this.action?this.seek(1):(N.currentMode==N.constant.MODE_EDUCATION?U.play():N.currentMode==N.constant.MODE_DESKTOP&&H.play(),this.action="start",this.tick(),L.get("live:video:play")())},pause:function(){B.debug("vod.player ===> pause"),this.pauseTick(),N.currentMode==N.constant.MODE_EDUCATION?U.pause():N.currentMode==N.constant.MODE_DESKTOP&&H.pause(),this.action="pause",N.playStatus="pause",L.get("live:video:pause")()},stop:function(){B.debug("vod call stop!"),this.action="stop",this.stopTick(),U.stop(),H.stop(),this.currentDuration=0},destroy:function(){B.debug("vod call destroy!"),this.stopTick(),U.destroy(),H.destroy(),F.destroy()},volume:function(t){U.volume(t),H.volume(t)},getCommandsByDuration:function(t,e){var i=this,n=[],r={},o=B.closeSet(i.cmdStartTime,t);if(!o)return!1;var s=i.commandStore[o.i];this.currentPageNumber=s.page.p,i.clear(s.page.p),B.debug("closeSetPage===> "+s.page.p+"#"+o.st,s),s&&(i.runPageIndex=i.curPageIndex=o.i,i.dispatch(s.page),i.loadDraw(o.i,(function(o){var s=i.commandStore[o];if(void 0===s.draw||0==s.draw.length)return!1;i.curDrawIndex=0;var a=s.draw;B.debug("过滤前指令数量===>"+a.length+"条"),B.debug("过滤前指令集===>",a),B.debugTimeStart("drawlist");for(var l=0,c=a.length;l<c;l++)if(parseInt(a[l].st)<=t)if(i.curDrawIndex=l+1,i.playMode==N.constant.MODE_DESKTOP);else{if(i.isSkip=!1,i.isSkipTimer=null,a[l].c){var u=a[l].c.split("|"),h=u[0];r[h]=a[l]}i.cmdFilter(u,a[l].t)&&r[h]&&delete r[h]}for(var f in r)n.push(JSON.stringify(r[f]));B.debug("过滤后指令数量===>"+n.length+"条"),B.debug("过滤后指令集===>",n),B.debugTimeEnd("drawlist"),B.callback(e,{st:t,t:N.COMMAND.DRAW_LIST,c:"",p:s.page.p,a:"0",d:n})})))},chatLock:[],getMessages:function(t){var e,i=this;if(0===t)this.chatSections.length>0&&(e=this.chatSections[0]);else for(var n=0;n<this.chatSections.length;n++)if(this.chatSections[n].start<=t&&this.chatSections[n].end>=t){e=this.chatSections[n];break}if(e){var r=e.start+"_"+e.end;if((void 0===i.chatLock[r]||1!=i.chatLock[r])&&!i.messages[r]){i.chatLock[r]=!0;e.loc&&i.loadJson(e.loc,(function(t){!function(t){if(B.debug("get message:",r,t),t.list){var e=[];for(var n in t.list)e.push({xid:t.list[n].xid,nickname:t.list[n].nickname,role:t.list[n].role,avatar:i.getAvatar(t.list[n]),message:i.parseMessage(t.list[n].msg),starttime:t.list[n].time,cmd:t.list[n].cmd,uid:t.list[n].uid,timestamp:t.list[n].timestamp,source:t.list[n]});i.messages[r]=e,L.get("live:message:append")(e)}else i.messages[r]=[]}(t)}))}}},qaLock:[],qa:{},qaSections:[],getQa:function(t){var e,i=this;if(0===t)this.qaSections.length>0&&(e=this.qaSections[0]);else for(var n=0;n<this.qaSections.length;n++)if(this.qaSections[n].start<=t&&this.qaSections[n].end>=t){e=this.qaSections[n];break}if(e){var r=e.start+"_"+e.end;if((void 0===i.qaLock[r]||1!=i.qaLock[r])&&!i.qa[r]){i.qaLock[r]=!0;e.loc&&i.loadJson(i.jsonUrlPath+"qa/"+e.loc,(function(t){!function(t){if(B.debug("get qa:",r,t),t.list){for(var e in t.list)t.list[e].avatar=i.getAvatar(t.list[e]);i.qa[r]=t.list,B.isInNative()||L.get("live:questions:append")(t.list)}else i.qa[r]=[]}(t)}))}}},getAvatar:function(t){var e=t.a&&this.vodLive.avatarHost?this.vodLive.avatarHost+"/avatar/"+t.xid%255+"/"+t.xid%600+"/"+t.xid%1024+"/"+t.xid+".jpg":"";if(!e){switch(t.role||(t.role="user"),t.role){case"spadmin":var i="/img/main/spadmin.png";break;case"admin":i="/img/main/admin.png";break;case"guest":i="/img/main/guest.png";break;case"user":default:i="/img/main/user.png"}e=Y.STATIC_HOST+"/open/cooperation/default/live-pc/css"+i}return e},qaLock:[],getQuestions:function(t){this.getQa(t)},getVideoSection:function(t){var e=this.videoSections;if(e)for(var i=0,n=e.length;i<n;i++)if(e[i].et>t)return this.sectionPath={part:i,detail:e[i]}},clear:function(){var t="",e=this.currentPageNumber||0;if(e)t='{"st":0,"p":'+e+',"c":"","n":0,"x":"0","t":1}';this.execute(t)},getModeType:function(t){var e={currentMode:"0",beforeMode:this.playMode};return"desktop"===t?(e.currentMode=N.constant.MODE_DESKTOP,e.beforeMode=N.constant.MODE_EDUCATION):"video"===t&&(e.currentMode=N.constant.MODE_EDUCATION,e.beforeMode=N.constant.MODE_DESKTOP),this.currentModeName!==t&&(B.debug("current mode change ===> "+t),N.modeChange({c:e.beforeMode+"|"+e.currentMode})),this.currentModeName=t,e},isCanSeek:function(){var t=!0;return"video"===this.videoCurType?"seeking"===U.playStatus&&(t=!1):"desktop"===this.videoCurType?"seeking"===H.playStatus&&(t=!1):t=!0,t},seek:function(t){if(B.debug("Seeking to ==>",t),B.debugTimeStart("seek"),!this.isCanSeek())return!1;t=t||0;var e=this,i=parseInt(t,10),n=parseFloat(e.duration,10),r=N.constant.MODE_EDUCATION,o=N.constant.MODE_EDUCATION;if(i<0||i>=n)return e.stop(),!1;e.playerRange(t),e.setCamera(i),H.seekDuration=null,U.seekDuration=null,e.seekDuration=i,e.isSeek=!0;var s=e.getVideoSection(i);if(!s)return!1;var a=e.getModeType(s.detail.name);r=a.currentMode,o=a.beforeMode;if(r==N.constant.MODE_EDUCATION){var l=s.detail;U.videoDo({t:N.COMMAND.VIDEO_START,c:l.url}),U.seek(i-l.st)}else if(r==N.constant.MODE_DESKTOP){var c=s.detail;H.start({t:N.COMMAND.DESKTOP_START,c:c.url}),H.seek(i-c.st)}L.get("live:seek:begin")(i),B.debug("live seek begin:"+i);e.commands.pages;e.action="start",e.stopTick(),o==N.constant.MODE_EDUCATION?U.cameraPlayer&&(B.debug("摄像头暂停中..."),U.stop(),U.videoUrl=null,U.seekDuration=0):o==N.constant.MODE_DESKTOP&&H.player&&(B.debug("桌面分享销毁"),H.stop(),H.player.dispose(),H.player=null,H.videoUrl=null,H.seekDuration=0),e.playMode=r,e.setCurVideo(i,!0),e.currentVideoUrl=s.detail.url,e.currentVideoHost=e.currentVideoUrl.split("/")[2],e.currentDuration=i,F.clear(),e.getCommandsByDuration(i,(function(t){e.dispatch(t)})),e.tick(),e.isSeek=!1,e.playRate(e.nowPlayRate),B.debug("live seek finish:"+i),L.get("live:seek:finish")(i),B.debugTimeEnd("seek")},getDuration:function(t,e){this.getModeType(this.videoCurType);var i=!1;return B.isMobile()&&("video"===this.videoCurType?"pause"===U.playStatus&&(i=!0):"desktop"===this.videoCurType&&"pause"===H.playStatus&&(i=!0),B.debug("current meida is paused? ===> "+i)),B.debug("current meida type ===> "+this.videoCurType),!this.isFirstPlay&&(B.isWechat()&&0===this.currentMediaPath&&"ended"===U.playStatus||"ended"===H.playStatus)?(this.isFirstPlay=!0,!1):("video"===this.videoCurType?("playing"===U.playStatus?this.currentDuration=this.partStartTime+U.currentDuration:"ended"===U.playStatus||"changing"===U.playStatus?this.currentDuration+=e:"seeking"===U.playStatus||U.playStatus,B.callback(t,this.currentDuration)):"desktop"===this.videoCurType?("playing"===H.playStatus?this.currentDuration=this.partStartTime+H.currentDuration:"ended"===H.playStatus||"changing"===H.playStatus?this.currentDuration+=e:"seeking"===H.playStatus||H.playStatus,B.callback(t,this.currentDuration)):(this.currentDuration+=e,B.callback(t,this.currentDuration)),this.currentDuration)},nowPlayRate:1,playRate:function(t){var e=null;return"video"===this.videoCurType?(U.playRate(t),e=U.playRate()):"desktop"===this.videoCurType?(H.playRate(t),e=H.playRate()):this.nowPlayRate=this.initPlayRate=t,"number"==typeof e&&(this.nowPlayRate=e),this.nowPlayRate},cmdFilter:function(t,e){var i=N.COMMAND,n=!1,r=t,o=e;return B.debug("cmdFilter ===> ",r,o),o==i.DRAW||o==i.TEXT?0==r[3]&&(n=!0):o==i.CIRCLE||o==i.RECTANGLE||o==i.LINE?0==r[1]&&(n=!0):o==i.IMAGE&&0==r[2]&&(n=!0),n},setCurVideo:function(t,e){t=t||0;var i=this.getVideoSection(t);if(!i)return!1;if("video"===i.detail.name?N.currentMode=N.constant.MODE_EDUCATION:"desktop"===i.detail.name&&(N.currentMode=N.constant.MODE_DESKTOP),U.cameraPlayer){var n=U.cameraPlayer.duration()-U.cameraPlayer.currentTime();this.videoSections.length===i.part+1||n<1&&L.get("live:source:change")(i.part)}if(this.videoCurType=i.detail.name,this.partStartTime=i.detail.st,i.part!==this.currentMediaPath&&(this.currentMediaPath=i.part,this.currentMediaSourceIndex=0,N.curMeidaData=i,B.debug("当前播放段落 ===> "+i.part),B.debug("加载媒体资源 ===>"+i.detail.duration+"'s",i)),"video"===i.detail.name){if(U.videoUrl===i.detail.url)return"undefined"!=typeof seek&&U.seek(t-i.detail.st),!1;U.videoDo({t:N.COMMAND.VIDEO_START,c:i.detail.url}),U.seek(t-i.detail.st),U.bx=0}else if("desktop"===i.detail.name){if(H.videoUrl===i.detail.url)return"undefined"!=typeof seek&&H.seek(t-i.detail.st),!1;H.start({t:N.COMMAND.DESKTOP_START,c:i.detail.url}),H.seek(t-i.detail.st),H.bx=0}this.vData=i,N.currentMediaSourceIndex=0,this.currentVideoUrl=i.detail.url,this.currentVideoHost=this.currentVideoUrl.split("/")[2]},cameraState:"wait",setCamera:function(t){var e=this.cameraSectionsV2,i=function(){var i="stop";if(e)for(var n=0;n<e.length;n++){var r=e[n];if(t>r.st&&t<r.et){i="start";break}i="stop"}return i}();if(i===this.cameraState)return!1;"start"===i?(L.get("camera:start")(),this.cameraState="start"):"stop"===i&&(L.get("camera:stop")(),this.cameraState="stop")},runPageIndex:0,curPageIndex:-1,curDrawIndex:0,cmdsRun:function(t){B.debug("cmdruns ==> ",parseInt(t,10),this.runPageIndex,this.pagesNum,this.curPageIndex);for(var e=this.runPageIndex;e<this.pagesNum&&void 0!==this.commandStore[e];e++)if(this.commandStore[e].page.st>t){if(this.commandStore[e].page.st-t>60)break;this.loadDraw(e,(function(){}))}else{this.commandStore[e].drawfile&&this.loadDraw(e,(function(){})),this.runPageIndex=e;if(this.curPageIndex!=e&&(this.dispatch(this.commandStore[e].page),this.curDrawIndex=0,this.curPageIndex=e,!0),this.commandStore[e].draw){var i=this.commandStore[e].draw.length,n=[];B.debug("cmdruns page data ==> ",this.commandStore[this.curPageIndex]);for(var r=this.curDrawIndex;r<i;r++)this.commandStore[e].draw[r].st<=t&&(n.push(this.commandStore[e].draw[r]),this.curDrawIndex=r+1);if(n.length>1){var o=[];for(var s in n)o.push(JSON.stringify(n[s]));this.dispatch({st:t,t:N.COMMAND.DRAW_LIST,c:"",p:this.commandStore[e].page.p,a:"0",d:o})}else 1==n.length&&(B.debug("drawBat ==> ",n[0]),this.dispatch(n[0]))}}},playerRange:function(t){var e=B.urlHashMap();if(this.timeRange=e,!this.timeRange)return B.debug("未设置时间区间."),!1;B.debug("时间区间 ==> ",this.timeRange),this.timeRange.start&&t<this.timeRange.start&&this.seek(this.timeRange.start),this.timeRange.end&&t>this.timeRange.end&&this.pause()},loadDraw:function(t,e){var i=this;if(i.commandStore[t].drawfile){var n=i.commandStore[t].drawfile;delete i.commandStore[t].drawfile,i.loadJson(n,(function(n){i.commandStore[t].draw=n,e(t)}))}else e(t)},tick:function(){this.videoloaded||(L.get("live:video:loaded")("inited"),this.videoloaded=!0),this.action="start";var t=this,e=B.now(),i=0,n=1;if(t.timerInterval=.5,B.debug("js tick ...",t.tickTimmer),B.isMobileSDK())return t.tickTimmer||(t.tickTimmer=setInterval((function(){var e=W.playDuration;t.currentDuration=e,t.getMessages(e),t.getQuestions(e),t.cmdsRun(e)}),1e3)),!1;if(!t.tickTimmer){B.debug("js start Tick ...",t.tickTimmer);var r=B.isMobile();t.tickTimmer=setInterval((function(){if(t.currentDuration>=t.totalTime)t.stop();else{if(B.debug("currentDuration:==>"+t.currentDuration+"\n initDuration:==>"+W.initDuration+"\n video.playStatus:==>"+U.playStatus+"\n desktop.playStatus:==>"+H.playStatus+"\n action:==>"+t.action),t.initSeek)return t.currentDuration=t.initSeek,t.initSeek=0,L.get("live:duration")(t.currentDuration,t.duration,t.currentDuration/t.duration),t.seek(t.currentDuration),void B.debug("initSeek=================>"+t.currentDuration);t.setCurVideo(t.currentDuration),t.initPlayRate&&(t.playRate(t.initPlayRate),t.initPlayRate=0),t.getDuration((function(o){if(t.playerRange(o),0==i&&(i=o),1==n&&r&&B.now()-e>=3){if(i==o)return;o-i>3&&(n=0)}if(N.currentDuration=o,W.initDuration=o,t.seekDuration>0&&o<t.seekDuration)return!1;t.setCamera(o),t.cmdsRun(o),L.get("live:duration")(t.currentDuration,t.duration,t.currentDuration/t.duration)}),.5),t.getMessages(t.currentDuration),t.getQuestions(t.currentDuration)}}),500)}t.isSkipTimer||(t.isSkip=!0)},pauseTick:function(){clearInterval(this.tickTimmer),this.tickTimmer=null},stopTick:function(){"stop"===this.action&&(B.debug("[TF-INFO] => 点播已结束 ==> "+this.currentDuration),L.get("vod:stop")()),clearInterval(this.tickTimmer),this.tickTimmer=null,this.currentDuration=0,N.currentDuration=0}};window.__vodPlayer=G;var q=G;s.a.debug("Vod Version ==>",3.7);var K={version:3.7,tools:s.a},J=!1,Z=!1,Q=null,$=function(t){return s.a.debug("Media register ==>",t),"camera"===t?Z=!0:"player"===t&&(J=!0),t?Z&&J&&Q?(q.init(Q),!0):void 0:Z&&J};K.main=function(){var t=this,e=arguments;if(s.a.debug("TalkFun VOD-JS-SDK Params",e),!this.init)return s.a.error("实例化 MT 对象失败, 请重试!"),r.a.get("system:room:error")({msg:"实例化 MT 对象失败, 请重试!"}),!1;if(e>3)return console.error("参数传递错误"),!1;if(e.length>0&&e.length<=3){for(var i=Array.prototype.slice.call(arguments),n=[null,{},null],o=0;o<i.length;o++)"string"===s.a._typeof(i[o])&&(n[0]=i[o]),"object"===s.a._typeof(i[o])&&(u.a.initConfig=i[o],n[1]=i[o]),"function"===s.a._typeof(i[o])&&(n[2]=i[o]);s.a.debug("sdk init params ==>",n),t.init.apply(this,n)}this.access_token=n[0]},K.main.prototype.setting=function(t,e){s.a.debug("setting ==> "+t,e),u.a.setting(t,e)},K.main.prototype.init=function(t,e,i){var n=this;g.default.commit(C.UPDATE_TOKEN,t),l.a.init(t,e,(function(t){var e;Q=t,e=t,g.default.commit(C.UPDATE_INIT_DATA,e),x.init(e,t=>{s.a.debug("socket on init...")}),S.getList(),$()&&q.init(t),i&&i(t),n.export2window(t)}))},K.main.prototype.getSDKMode=function(){return s.a.getSDKMode()},K.main.prototype.destroy=function(){q.destroy()},K.main.prototype.export2window=function(t){var e=this;window.MT=window.MT||{},window.MT.jsCall={_do:function(t,i){e.callSdk(t,i)},do:function(t,i){e.callSdk(t,i)}},window.MT.live=this.live,window.MT.chat=S,window.MT.me=t.user,window.MT.getLiveState=function(){return"start"}},K.main.prototype.live={playerLoaded:function(t){return q.vodSwfPlayerState=t,q.flashPlayerState(),!0}},K.main.prototype.changeMedia=function(t){q.changeMedia(t)},K.main.prototype.getMtData=function(){return g.default.getters("getInitData")},K.main.prototype.emit=function(){x.emit.apply(x,arguments)},K.main.prototype.mainPlayer=function(t,e,i){q.mainPlayer(t,e,i),$("player")},K.main.prototype.getSource=function(t){s.a.callback(t,q.videoSourceNum)},K.main.prototype.changeSource=function(t){t>-1&&q.changeSource(t)},K.main.prototype.playRate=function(t){return q.playRate(t)},K.main.prototype.camera=function(t,e,i){q.camera(t,e,i),$("camera")},K.main.prototype.getAction=function(){return q.action},K.main.prototype.getQuesByTimes=function(t,e,i){q.getQuestions(t,e,i)},K.main.prototype.play=function(){q.play()},K.main.prototype.pause=function(){q.pause()},K.main.prototype.stop=function(){q.stop()},K.main.prototype.volume=function(t){q.volume(t)},K.main.prototype.seek=function(t){q.seek(t)},K.main.prototype.callSdk=function(t,e){return q.callSdk(t,e)},K.main.prototype.isMobileSdk=function(){return s.a.isMobileSDK()},K.main.prototype.setMediaControl=function(t){s.a.debug("set controls ==> ",t);var e={fullscreenButton:t.fullscreenButton,volumeButton:t.volumeButton};q.setConfig&&q.setConfig(e)},K.main.prototype.playerResize=function(t,e){return q.resizePlayer(t,e)},K.main.prototype.getTools=function(){return s.a},K.main.prototype.on=function(t,e){void 0!==t&&t.length>0&&"string"==typeof t&&void 0!==e&&"function"==typeof e?r.a.put(t,e):alert(STATIC.MT_ADDMAPLIST_ERROR+": "+t)},K.main.prototype.plugins=function(t){switch(t){case"vote":return f.a.vote;case"flower":return f.a.flower;case"lottery":case"score":break;case"iframe":return f.a.iframe}return f.a};var tt=K;e.default={SDK:tt}}]).default;